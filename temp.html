<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SEOTIZE Dashboard</title>
<!-- Fonts & Icons -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/remixicon@4.0.0/fonts/remixicon.css" rel="stylesheet">
<!-- Libraries -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/TextPlugin.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
<style>
:root {
  --primary: #6366f1; --primary-dark: #4f46e5; --primary-light: #818cf8; --secondary: #10b981;
  --secondary-dark: #059669; --accent: #f59e0b; --error: #ef4444; --warning: #f59e0b;
  --success: #10b981; --info: #3b82f6; --danger: #e63946;
  --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
  --gradient-accent: linear-gradient(135deg, #fa709a 0%, #fee140 100%); --radius-sm: 8px;
  --radius: 12px; --radius-lg: 16px; --radius-xl: 24px;
  --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05); --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1); --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
  --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}
[data-theme="light"] {
  --bg: #f8f9fa; --bg-secondary: #ffffff; --bg-tertiary: #e9ecef; --sidebar: #ffffff;
  --card: #ffffff; --card-hover: #f8f9fa; --text: #212529; --text-secondary: #6c757d;
  --text-tertiary: #adb5bd; --border: #dee2e6; --input-bg: #ffffff;
  --overlay: rgba(255, 255, 255, 0.95); --glass: rgba(255, 255, 255, 0.7); --glass-border: rgba(0, 0, 0, 0.1);
}
[data-theme="dark"] {
  --bg: #0a0a0a; --bg-secondary: #1a1a1a; --bg-tertiary: #2a2a2a; --sidebar: #141414;
  --card: #1f1f1f; --card-hover: #2a2a2a; --text: #ffffff; --text-secondary: #a0a0a0;
  --text-tertiary: #6b6b6b; --border: rgba(255, 255, 255, 0.1); --input-bg: #1a1a1a;
  --overlay: rgba(0, 0, 0, 0.95); --glass: rgba(255, 255, 255, 0.05); --glass-border: rgba(255, 255, 255, 0.1);
}
* {
  margin: 0; padding: 0; box-sizing: border-box;
}
body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; background: var(--bg);
  color: var(--text); min-height: 100vh; transition: var(--transition); line-height: 1.6; overflow-x: hidden;
}
.dashboard-layout {
  display: flex; min-height: 100vh;
}
.sidebar {
  width: 280px; background: var(--sidebar); border-right: 1px solid var(--border); display: flex;
  flex-direction: column; transition: var(--transition);
}
.sidebar-header {
  padding: 1.5rem; border-bottom: 1px solid var(--border);
}
.logo {
  display: flex; align-items: center; gap: 0.75rem; font-size: 1.5rem; font-weight: 800;
  color: var(--primary); text-decoration: none;
}
.logox {
  display: flex; align-items: center; gap: 0.75rem; font-size: 1.5rem; font-weight: 800;
  color: var(--primary); text-decoration: none;
}
.logo-icon {
  display: flex; align-items: flex-end; gap: 4px; height: 24px;
}
.logo-bar {
  width: 6px; border-radius: 2px; transform-origin: bottom; transition: all 0.3s ease;
}
.logo-b1 {
  height: 40%; background: linear-gradient(180deg, #f59e0b 0%, #f97316 100%);
  box-shadow: 0 2px 8px rgba(245, 158, 11, 0.4);
}
.logo-b2 {
  height: 70%; background: linear-gradient(180deg, #8b5cf6 0%, #7c3aed 100%);
  box-shadow: 0 2px 8px rgba(139, 92, 246, 0.4);
}
.logo-b3 {
  height: 100%; background: linear-gradient(180deg, #06b6d4 0%, #0891b2 100%);
  box-shadow: 0 2px 8px rgba(6, 182, 212, 0.4);
}
.sidebar-nav {
  flex: 1; padding: 1rem; overflow-y: auto;
}
.nav-section {
  margin-bottom: 1.5rem;
}
.nav-section-title {
  font-size: 0.75rem; font-weight: 600; color: var(--text-tertiary); text-transform: uppercase;
  letter-spacing: 0.05em; margin-bottom: 0.5rem; padding: 0 0.75rem;
}
.nav-item {
  display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; border-radius: var(--radius);
  color: var(--text-secondary); text-decoration: none; transition: var(--transition);
  cursor: pointer; margin-bottom: 0.25rem;
}
.nav-item:hover {
  background: var(--card); color: var(--text);
}
.nav-item.active {
  background: var(--primary); color: white;
}
.nav-item i {
  font-size: 1.25rem; width: 1.5rem; text-align: center;
}
.main-content {
  flex: 1; display: flex; flex-direction: column; overflow: hidden;
}
.header {
  background: var(--bg-secondary); border-bottom: 1px solid var(--border); padding: 1rem 1.5rem;
  display: flex; justify-content: space-between; align-items: center;
}
.header-left {
  display: flex; align-items: center; gap: 1rem;
}
.search-bar {
  position: relative; width: 300px;
}
.search-bar input {
  width: 100%; padding: 0.625rem 1rem 0.625rem 2.5rem; border: 1px solid var(--border);
  border-radius: var(--radius); background: var(--input-bg); color: var(--text);
  font-size: 0.875rem; transition: var(--transition);
}
.search-bar input:focus {
  outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
}
.search-bar i {
  position: absolute; left: 0.875rem; top: 50%; transform: translateY(-50%); color: var(--text-tertiary);
}
.header-right {
  display: flex; align-items: center; gap: 1rem;
}
.theme-toggle {
  padding: 0.5rem; border-radius: var(--radius); background: transparent; border: none;
  color: var(--text); cursor: pointer; font-size: 1.25rem; transition: var(--transition);
}
.theme-toggle:hover {
  background: var(--card);
}
.user-menu {
  display: flex; align-items: center; gap: 0.75rem; padding: 0.5rem 1rem;
  border-radius: var(--radius); background: var(--card); cursor: pointer; transition: var(--transition);
}
.user-menu:hover {
  background: var(--card-hover);
}
.user-avatar {
  width: 32px; height: 32px; border-radius: 50%; background: var(--gradient-primary);
  display: flex; align-items: center; justify-content: center; color: white; font-weight: 600;
}
.content {
  flex: 1; padding: 1.5rem; overflow-y: auto;
}
.card {
  background: var(--card); border-radius: var(--radius-lg); border: 1px solid var(--border);
  transition: var(--transition);
}
.card-header {
  padding: 1.25rem; border-bottom: 1px solid var(--border); display: flex;
  justify-content: space-between; align-items: center;
}
.card-title {
  font-size: 1.125rem; font-weight: 600; color: var(--text);
}
.card-body {
  padding: 1.25rem;
}
.stats-grid {
  display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;
}
.stat-card {
  background: var(--card); border-radius: var(--radius); padding: 1.25rem;
  border: 1px solid var(--border); display: flex; align-items: center; gap: 1rem;
  transition: var(--transition); position: relative; overflow: hidden;
}
.stat-card:hover {
  transform: translateY(-2px); box-shadow: var(--shadow-lg);
}
.stat-card::before {
  content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: var(--gradient-primary);
}
.stat-icon {
  width: 40px; height: 40px; border-radius: var(--radius); display: flex; align-items: center;
  justify-content: center; font-size: 1.25rem; flex-shrink: 0;
}
.stat-icon.primary {
  background: rgba(99, 102, 241, 0.1); color: var(--primary);
}
.stat-icon.success {
  background: rgba(16, 185, 129, 0.1); color: var(--success);
}
.stat-icon.warning {
  background: rgba(245, 158, 11, 0.1); color: var(--warning);
}
.stat-icon.error {
  background: rgba(239, 68, 68, 0.1); color: var(--error);
}
.stat-content {
  flex: 1; min-width: 0;
}
.stat-value {
  font-size: 1.5rem; font-weight: 700; color: var(--text); margin-bottom: 0.25rem;
}
.stat-label {
  font-size: 0.875rem; color: var(--text-secondary);
}
.btn {
  padding: 0.625rem 1.25rem; border-radius: var(--radius); font-weight: 500; font-size: 0.875rem;
  border: none; cursor: pointer; transition: var(--transition); display: inline-flex;
  align-items: center; gap: 0.5rem; text-decoration: none;
}
.btn-primary {
  background: var(--primary); color: white;
}
.btn-primary:hover {
  background: var(--primary-dark); transform: translateY(-1px); box-shadow: var(--shadow);
}
.btn-secondary {
  background: var(--bg-tertiary); color: var(--text);
}
.btn-secondary:hover {
  background: var(--card);
}
.btn-danger {
  background: var(--error); color: white;
}
.btn-danger:hover {
  background: #dc2626;
}
.btn-sm {
  padding: 0.375rem 0.75rem; font-size: 0.8125rem;
}
.form-group {
  margin-bottom: 1.5rem;
}
.form-label {
  display: block; margin-bottom: 0.5rem; font-weight: 500; color: var(--text);
}
.form-input,
.form-select,
.form-textarea {
  width: 100%; padding: 0.625rem 1rem; border: 1px solid var(--border);
  border-radius: var(--radius); background: var(--input-bg); color: var(--text);
  font-size: 0.875rem; transition: var(--transition);
}
.form-input:focus,
.form-select:focus,
.form-textarea:focus {
  outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
}
.form-textarea {
  resize: vertical; min-height: 100px;
}
.table-container {
  overflow-x: auto; border-radius: var(--radius); border: 1px solid var(--border);
}
table {
  width: 100%; border-collapse: collapse;
}
th {
  background: var(--bg-tertiary); padding: 0.75rem 1rem; text-align: left; font-weight: 600;
  color: var(--text); border-bottom: 1px solid var(--border);
}
td {
  padding: 0.75rem 1rem; border-bottom: 1px solid var(--border); color: var(--text-secondary);
}
tr:hover {
  background: var(--card-hover);
}
.pagination {
  display: flex; justify-content: center; align-items: center; gap: 0.5rem; margin-top: 2rem;
  padding: 1rem; background: var(--card); border-radius: var(--radius); border: 1px solid var(--border);
}
.pagination-btn {
  padding: 0.5rem 0.75rem; border: 1px solid var(--border); border-radius: var(--radius-sm);
  background: var(--bg-secondary); color: var(--text); cursor: pointer;
  transition: var(--transition); font-size: 0.875rem;
}
.pagination-btn:hover:not(:disabled) {
  background: var(--primary); color: white; border-color: var(--primary);
}
.pagination-btn:disabled {
  opacity: 0.5; cursor: not-allowed;
}
.pagination-btn.active {
  background: var(--primary); color: white; border-color: var(--primary);
}
.pagination-info {
  margin: 0 1rem; color: var(--text-secondary); font-size: 0.875rem;
}
.modal-overlay {
  display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0, 0, 0, 0.5); backdrop-filter: blur(4px); z-index: 1000; animation: fadeIn 0.3s;
}
.modal-overlay.active {
  display: flex; align-items: center; justify-content: center;
}
.modal {
  background: var(--card); border-radius: var(--radius-xl); max-width: 90vw; width: 900px;
  max-height: 90vh; overflow: hidden; animation: slideUp 0.3s;
}
.modal-header {
  padding: 1.5rem; border-bottom: 1px solid var(--border); display: flex;
  justify-content: space-between; align-items: center;
}
.modal-title {
  font-size: 1.25rem; font-weight: 600; color: var(--text);
}
.modal-close {
  background: transparent; border: none; color: var(--text-secondary); font-size: 1.5rem;
  cursor: pointer; padding: 0.25rem; transition: var(--transition);
}
.modal-close:hover {
  color: var(--text);
}
.modal-body {
  padding: 1.5rem; max-height: calc(90vh - 140px); overflow-y: auto;
}
.toast {
  position: fixed; bottom: 2rem; right: 2rem; padding: 1rem 1.5rem; background: var(--card);
  border-radius: var(--radius); box-shadow: var(--shadow-xl); display: flex; align-items: center;
  gap: 0.75rem; animation: slideInRight 0.3s; z-index: 2000;
}
.toast.success {
  border-left: 4px solid var(--success);
}
.toast.error {
  border-left: 4px solid var(--error);
}
.toast.warning {
  border-left: 4px solid var(--warning);
}
.toast.info {
  border-left: 4px solid var(--info);
}
.chart-container {
  position: relative; height: 280px !important; width: 100%; overflow: hidden;
}
.chart-container canvas {
  width: 100% !important; height: 100% !important; max-width: 100%; max-height: 100%;
}
.map-container {
  height: 280px !important; width: 100%; border-radius: var(--radius);f; overflow: hidden;
  border: 1px solid var(--border);
}
.leaflet-container {
  background: var(--bg-tertiary) !important;
}
.leaflet-tile-pane {
  filter: var(--map-filter, none);
}
[data-theme="dark"] .leaflet-tile-pane {
  --map-filter: hue-rotate(180deg) invert(100%) brightness(70%) contrast(120%);
}
.task-grid {
  display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 1.5rem;
}
.task-card {
  background: var(--card); border-radius: var(--radius-lg); border: 1px solid var(--border);
  padding: 1.25rem; transition: var(--transition); cursor: pointer;
}
.task-card:hover {
  transform: translateY(-2px); box-shadow: var(--shadow-lg);
}
.task-header {
  display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;
}
.task-url-wrapper {
  flex: 1; min-width: 0;
}
.task-url {
  font-weight: 600; color: var(--primary); text-decoration: none; word-break: break-all;
  font-size: 0.95rem; display: inline-flex; align-items: center; gap: 0.35rem;
}
.task-url i {
  font-size: 0.85rem; opacity: 0.8;
}
.task-date {
  font-size: 0.75rem; color: var(--text-tertiary); margin-top: 0.25rem;
}
.task-status {
  padding: 0.25rem 0.75rem; border-radius: var(--radius-sm); font-size: 0.75rem; font-weight: 600;
}
.task-status.active {
  background: rgba(16, 185, 129, 0.1); color: var(--success);
}
.task-status.paused {
  background: rgba(245, 158, 11, 0.1); color: var(--warning);
}
.task-status.completed {
  background: rgba(99, 102, 241, 0.1); color: var(--primary);
}
.task-status.unverified {
  background: rgba(239, 68, 68, 0.1); color: var(--error);
}
.task-card.unverified {
  opacity: 0.7; border: 1px dashed var(--border);
}
.task-card.unverified .task-url {
  color: var(--text-secondary);
}
.task-stats {
  display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin: 1rem 0;
}
.task-stat {
  display: flex; flex-direction: column;
}
.task-stat-label {
  font-size: 0.75rem; color: var(--text-tertiary); margin-bottom: 0.25rem;
}
.task-stat-value {
  font-size: 1.125rem; font-weight: 600; color: var(--text);
}
.task-progress {
  margin: 1rem 0;
}
.progress-bar {
  height: 6px; background: var(--bg-tertiary); border-radius: 3px; overflow: hidden;
}
.progress-fill {
  height: 100%; background: var(--gradient-primary); transition: width 0.3s ease;
}
.task-actions {
  display: flex; gap: 0.5rem; margin-top: 1rem;
}
.btn-recharge-task {
  background: var(--success); color: #fff;
}
.btn-recharge-task:hover {
  filter: brightness(0.95); transform: translateY(-1px); box-shadow: var(--shadow);
}
.btn-delete-task-mobile {
  display: none;
}
.website-preview {
  width: 100%; height: 450px; border: 2px solid var(--border); border-radius: var(--radius);
  background: #fff; position: relative; overflow: hidden; margin-bottom: 1rem;
}
.website-preview iframe {
  width: 100%; height: 100%; border: none; background: #fff;
}
.preview-controls {
  position: absolute; top: 10px; right: 10px; display: flex; gap: 5px;
  background: rgba(0, 0, 0, 0.8); padding: 8px; border-radius: var(--radius); z-index: 10;
}
.preview-btn {
  padding: 4px 8px; background: var(--primary); color: white; border: none; border-radius: 4px;
  font-size: 0.75rem; cursor: pointer; transition: var(--transition);
}
.preview-btn:hover {
  background: var(--primary-dark);
}
.xpath-marker {
  position: absolute; width: 28px; height: 28px; background: var(--primary); color: white;
  border: 3px solid white; border-radius: 50%; display: flex; align-items: center;
  justify-content: center; font-weight: 700; font-size: 0.875rem; cursor: pointer;
  box-shadow: var(--shadow-lg); animation: pulse 2s infinite; transform: translate(-50%, -50%); z-index: 15;
}
.media-grid {
  display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem;
}
.media-card {
  background: var(--card); border: 1px solid var(--border); border-radius: var(--radius);
  overflow: hidden; transition: var(--transition);
}
.media-card:hover {
  transform: translateY(-2px); box-shadow: var(--shadow);
}
.media-preview {
  height: 140px; background: var(--bg-tertiary); display: flex; align-items: center;
  justify-content: center; overflow: hidden;
}
.media-preview img {
  width: 100%; height: 100%; object-fit: cover;
}
.media-info {
  padding: 1rem;
}
.media-filename {
  font-weight: 600; margin-bottom: 0.5rem; word-break: break-all; font-size: 0.875rem;
}
.media-stats {
  display: flex; justify-content: space-between; align-items: center; font-size: 0.75rem;
  color: var(--text-secondary); margin-bottom: 0.75rem;
}
.empty-state {
  text-align: center; padding: 3rem;
}
.empty-state-icon {
  font-size: 4rem; color: var(--text-tertiary); margin-bottom: 1rem;
}
.empty-state-title {
  font-size: 1.5rem; font-weight: 600; color: var(--text); margin-bottom: 0.5rem;
}
.empty-state-description {
  color: var(--text-secondary); margin-bottom: 1.5rem;
}
.badge {
  display: inline-block; padding: 0.25rem 0.5rem; border-radius: var(--radius-sm); font-size: 0.75rem; font-weight: 600;
}
.badge-primary {
  background: rgba(99, 102, 241, 0.1); color: var(--primary);
}
.badge-success {
  background: rgba(16, 185, 129, 0.1); color: var(--success);
}
.badge-warning {
  background: rgba(245, 158, 11, 0.1); color: var(--warning);
}
.badge-danger {
  background: rgba(239, 68, 68, 0.1); color: var(--error);
}
.spinner {
  width: 40px; height: 40px; border: 3px solid var(--border); border-top-color: var(--primary);
  border-radius: 50%; animation: spin 1s linear infinite;
}
.seo-task-creator {
  position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.75);
  backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); z-index: 9998; display: none;
  animation: fadeIn 0.3s ease;
}
.seo-task-creator.active {
  display: flex; align-items: center; justify-content: center;
}
.task-creator-container {
  background: var(--bg-secondary); border-radius: 1.5rem; width: 95vw; max-width: 1200px;
  max-height: 90vh; overflow: hidden; display: flex; box-shadow: 0 30px 60px -15px rgba(0, 0, 0, 0.3);
  animation: slideUpDesktop 0.4s cubic-bezier(0.34, 1.56, 0.64, 1); position: relative;
}
@keyframes slideUpDesktop {
from {
  transform: translateY(30px) scale(0.95); opacity: 0;
}
to {
  transform: translateY(0) scale(1); opacity: 1;
}
}
.task-creator-sidebar {
  width: 280px; background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);
  padding: 2rem; border-right: 1px solid var(--border); display: flex; flex-direction: column; gap: 1.5rem;
}
.task-creator-main {
  flex: 1; display: flex; flex-direction: column; position: relative;
}
.task-creator-header {
  padding: 2rem; border-bottom: 1px solid var(--border); background: var(--bg-secondary); position: relative;
}
.task-creator-title {
  font-size: 1.5rem; font-weight: 700; margin-bottom: 0.5rem; color: var(--text);
}
.task-creator-subtitle {
  color: var(--text-secondary); font-size: 0.875rem;
}
.task-creator-close {
  position: absolute; top: 1.5rem; right: 1.5rem; width: 2.5rem; height: 2.5rem; border-radius: 50%;
  background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(249,250,251,0.95) 100%);
  border: 2px solid rgba(229,231,235,1); color: #6b7280; font-size: 1.25rem; cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); display: flex; align-items: center;
  justify-content: center; z-index: 1010; backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
}
.task-creator-close:hover {
  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); color: white;
  transform: rotate(90deg) scale(1.1); border-color: transparent; box-shadow: 0 8px 20px rgba(239, 68, 68, 0.4);
}
.task-creator-close:active {
  transform: rotate(90deg) scale(1); box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
}
.task-creator-body {
  flex: 1; padding: 2rem; overflow-y: auto;
}
.progress-steps {
  margin-bottom: 2rem;
}
.progress-step {
  display: flex; align-items: center; margin-bottom: 1.5rem; cursor: pointer; transition: var(--transition);
}
.progress-step:last-child {
}
.step-indicator {
  width: 3rem; height: 3rem; border-radius: 50%; background: var(--bg-tertiary);
  border: 2px solid var(--border); display: flex; align-items: center; justify-content: center;
  font-weight: 600; margin-right: 1rem; transition: all 0.3s;
}
.progress-step.completed .step-indicator {
  background: var(--success); border-color: var(--success); color: white;
}
.progress-step.active .step-indicator {
  background: var(--primary); border-color: var(--primary); color: white; box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
}
.step-info {
  flex: 1;
}
.step-title {
  font-weight: 600; margin-bottom: 0.25rem; color: var(--text-secondary);
}
.progress-step.active .step-title,
.progress-step.completed .step-title {
  color: var(--text);
}
.step-description {
  font-size: 0.75rem; color: var(--text-secondary);
}
.step-content {
  display: none; animation: fadeIn 0.3s ease;
}
.step-content.active {
  display: block;
}
.step-navigation {
  display: flex; justify-content: space-between; margin-top: 2rem; padding-top: 1rem;
  border-top: 1px solid var(--border);
}
.pending-task-alert {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 1rem;
  padding: 2rem; margin-bottom: 2rem; color: white; display: none;
}
.pending-task-alert.show {
  display: block; animation: slideDown 0.3s ease;
}
.pending-task-header {
  display: flex; align-items: center; margin-bottom: 1rem;
}
.pending-task-icon {
  width: 3rem; height: 3rem; background: rgba(255, 255, 255, 0.2); border-radius: 50%;
  display: flex; align-items: center; justify-content: center; font-size: 1.5rem; margin-right: 1rem;
}
.pending-task-info {
  flex: 1;
}
.pending-task-title {
  font-size: 1.125rem; font-weight: 600; margin-bottom: 0.25rem;
}
.pending-task-details {
  background: rgba(0, 0, 0, 0.2); border-radius: 0.5rem; padding: 1rem; margin-bottom: 1rem;
}
.pending-task-actions {
  display: flex; gap: 1rem;
}
.pending-task-actions .btn {
  flex: 1;
}
.priority-options {
  display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-bottom: 2rem;
}
.priority-option {
  border: 2px solid var(--border); border-radius: 1rem; padding: 1.25rem 1rem; cursor: pointer;
  transition: all 0.3s; position: relative; overflow: hidden; text-align: center;
  min-height: 180px; display: flex; flex-direction: column; justify-content: space-between;
}
.priority-option::before {
  content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px;
  background: var(--border); transition: all 0.3s;
}
.priority-option:hover {
  transform: translateY(-4px); box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); border-color: var(--primary);
}
.priority-option.selected {
  border-color: var(--primary);
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(99, 102, 241, 0.1) 100%);
}
.priority-option.selected::before {
  background: var(--primary);
}
.priority-badge {
  display: inline-flex; padding: 0.25rem 0.75rem; background: var(--bg-tertiary);
  border-radius: 999px; font-size: 0.7rem; font-weight: 600; text-transform: uppercase;
  letter-spacing: 0.5px; margin-bottom: 0.75rem; align-self: center;
}
.priority-option[data-priority="basic"] .priority-badge {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;
}
.priority-option[data-priority="standard"] .priority-badge {
  background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white;
}
.priority-option[data-priority="premium"] .priority-badge {
  background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); color: white;
}
.priority-title {
  font-weight: 600; margin-bottom: 0.5rem; font-size: 0.95rem;
}
.priority-price {
  font-size: 1.35rem; font-weight: 700; color: var(--primary); margin-bottom: 0.5rem;
}
.priority-price small {
  font-size: 0.875rem; color: var(--text-secondary); font-weight: 400;
}
.priority-locations {
  font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.25rem;
}
.keyword-suggestions {
  display: flex; flex-wrap: wrap; gap: 0.75rem; margin-bottom: 1.5rem;
}
.keyword-suggestion {
  padding: 0.5rem 1rem; background: var(--bg-tertiary); border: 2px solid transparent;
  border-radius: 999px; font-size: 0.875rem; cursor: pointer; transition: all 0.2s;
  display: inline-flex; align-items: center; gap: 0.5rem;
}
.keyword-suggestion:hover {
  background: var(--primary); color: white; transform: scale(1.05);
}
.keyword-suggestion.selected {
  background: var(--primary); color: white; border-color: var(--primary);
}
.selected-keywords {
  background: var(--bg-tertiary); border-radius: 0.75rem; padding: 1rem; margin-bottom: 1.5rem;
}
.keyword-tags {
  display: flex; flex-wrap: wrap; gap: 0.5rem;
}
.keyword-tag {
  display: inline-flex; align-items: center; padding: 0.5rem 0.75rem; background: var(--primary);
  color: white; border-radius: 0.5rem; font-size: 0.875rem; animation: fadeIn 0.2s;
}
.keyword-tag-text {
  margin-right: 0.5rem;
}
.keyword-tag-remove {
  width: 1.25rem; height: 1.25rem; background: rgba(255, 255, 255, 0.2); border-radius: 50%;
  display: flex; align-items: center; justify-content: center; cursor: pointer;
  transition: all 0.2s; color: white; font-size: 0.75rem;
}
.keyword-tag-remove:hover {
  background: var(--error); transform: scale(1.2);
}
.payment-options {
  display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 2rem;
}
.payment-card {
  border: 2px solid var(--border); border-radius: 1rem; padding: 1.5rem; cursor: pointer;
  transition: all 0.3s; position: relative;
}
.payment-card:hover {
  border-color: var(--primary); transform: translateY(-2px);
}
.payment-card.selected {
  border-color: var(--primary); background: rgba(99, 102, 241, 0.05);
}
.payment-card.selected::after {
  content: '✓'; position: absolute; top: 1rem; right: 1rem; width: 1.5rem; height: 1.5rem;
  background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center;
  justify-content: center; font-size: 0.75rem;
}
.payment-icon {
  width: 3rem; height: 3rem; background: var(--bg-tertiary); border-radius: 0.75rem; display: flex;
  align-items: center; justify-content: center; font-size: 1.5rem; margin-bottom: 1rem; color: var(--primary);
}
.payment-title {
  font-weight: 600; margin-bottom: 0.5rem; color: var(--text);
}
.payment-description {
  font-size: 0.875rem; color: var(--text-secondary);
}
.payment-type-toggle {
  background: linear-gradient(135deg, var(--bg-tertiary) 0%, rgba(99, 102, 241, 0.1) 100%);
  border-radius: 1rem; padding: 0.375rem; display: flex; margin-bottom: 2rem;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); border: 1px solid var(--border);
}
.payment-type-option {
  flex: 1; padding: 0.875rem 1rem; border: none; background: transparent; border-radius: 0.75rem;
  font-weight: 600; color: var(--text-secondary); cursor: pointer; transition: all 0.3s;
  display: flex; align-items: center; justify-content: center; gap: 0.5rem;
}
.payment-type-option:hover {
  transform: translateY(-1px);
}
.payment-type-option.active {
  background: linear-gradient(135deg, var(--primary) 0%, #764ba2 100%); color: white;
  box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3); transform: scale(1.02);
}
.payment-type-option i {
  font-size: 1.125rem;
}
.budget-calculator {
  background: var(--bg-tertiary); border-radius: 1rem; padding: 1.5rem; margin-bottom: 2rem;
}
.budget-input-group {
  display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem;
}
.budget-field {
  position: relative;
}
.budget-field label {
  font-size: 0.875rem; font-weight: 600; color: var(--text-secondary); margin-bottom: 0.5rem; display: block;
}
.budget-field input {
  width: 100%; padding: 0.75rem 1rem; padding-left: 2.5rem; border: 2px solid var(--border);
  border-radius: 0.5rem; font-size: 1.25rem; font-weight: 600; background: var(--card); color: var(--text);
}
.budget-field .currency-symbol {
  position: absolute; left: 1rem; bottom: 0.875rem; color: var(--text-secondary); font-size: 1.25rem; font-weight: 600;
}
.budget-summary {
  background: var(--card); border-radius: 0.75rem; padding: 1rem; display: grid;
  grid-template-columns: repeat(3, 1fr); gap: 0.75rem; margin-top: 1rem;
}
.budget-summary-period {
  font-size: 0.65rem; color: var(--text-secondary); margin-top: 0.25rem; opacity: 0.8;
}
.budget-summary-item {
  text-align: center; padding: 0.75rem; background: var(--bg-primary); border-radius: 0.5rem;
  border: 1px solid var(--border);
}
.budget-summary-label {
  font-size: 0.75rem; color: var(--text-secondary); text-transform: uppercase;
  letter-spacing: 0.5px; margin-bottom: 0.25rem;
}
.budget-summary-value {
  font-size: 1.25rem; font-weight: 700; color: var(--text);
}
.billing-cycle-options {
  display: grid; grid-template-columns: repeat(auto-fit, minmax(230px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;
}
.billing-option {
  position: relative; border: 1.5px solid var(--border); border-radius: 1.25rem;
  padding: 1.5rem 1.25rem 1.25rem; cursor: pointer; transition: all 0.3s ease;
  background: var(--card); display: flex; flex-direction: column; gap: 0.75rem; text-align: left;
  min-height: 170px; box-shadow: 0 12px 30px rgba(15, 23, 42, 0.05);
}
.billing-option-top {
  display: flex; align-items: center; gap: 0.85rem; width: 100%;
}
.billing-icon {
  width: 3rem; height: 3rem; border-radius: 0.85rem; background: rgba(99, 102, 241, 0.12);
  color: var(--primary); display: flex; align-items: center; justify-content: center;
  font-size: 1.35rem; flex-shrink: 0; box-shadow: inset 0 0 0 1px rgba(99, 102, 241, 0.15);
}
.billing-option-header {
  display: flex; flex-direction: column; align-items: flex-start; gap: 0.15rem; margin-bottom: 0;
}
.billing-period {
  font-size: 1.15rem; font-weight: 700; color: var(--text);
}
.billing-frequency {
  font-size: 0.85rem; color: var(--text-secondary);
}
.billing-save {
  display: inline-block; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white; padding: 0.25rem 0.75rem; border-radius: 0.5rem; font-size: 0.75rem;
  font-weight: 600; margin-left: auto;
}
.billing-price {
  font-size: 0.95rem; color: var(--text); font-weight: 600;
}
.billing-note {
  font-size: 0.85rem; color: var(--text-secondary);
}
.billing-option:hover {
  border-color: var(--primary); transform: translateY(-4px); box-shadow: 0 20px 35px rgba(99, 102, 241, 0.2);
}
.billing-option.selected {
  border-color: transparent; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
  box-shadow: 0 30px 45px rgba(99, 102, 241, 0.35); color: white;
}
.billing-option.selected .billing-icon {
  background: rgba(255, 255, 255, 0.18); color: white; box-shadow: none;
}
.billing-option.selected .billing-period,
.billing-option.selected .billing-frequency,
.billing-option.selected .billing-price,
.billing-option.selected .billing-note {
  color: rgba(255, 255, 255, 0.95);
}
.billing-option.selected::after {
  content: '✓'; position: absolute; top: 0.85rem; right: 0.85rem; width: 1.65rem; height: 1.65rem;
  background: rgba(255, 255, 255, 0.15); color: white; border-radius: 50%; display: flex;
  align-items: center; justify-content: center; font-size: 0.8rem; font-weight: 700;
  border: 1px solid rgba(255, 255, 255, 0.4);
}
.billing-badge {
  position: absolute; top: 1rem; right: 1.25rem;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;
  padding: 0.25rem 0.75rem; border-radius: 1rem; font-size: 0.75rem; font-weight: 600;
  white-space: nowrap; box-shadow: 0 5px 15px rgba(102, 126, 234, 0.35);
}
.billing-popular {
  position: relative;
}
.billing-option[data-cycle="monthly"] .billing-icon {
  background: rgba(59, 130, 246, 0.15); color: #3b82f6; box-shadow: inset 0 0 0 1px rgba(59, 130, 246, 0.25);
}
.billing-option[data-cycle="quarterly"] .billing-icon {
  background: rgba(249, 115, 22, 0.15); color: #f97316; box-shadow: inset 0 0 0 1px rgba(249, 115, 22, 0.2);
}
.billing-option[data-cycle="yearly"] .billing-icon {
  background: rgba(16, 185, 129, 0.15); color: #059669; box-shadow: inset 0 0 0 1px rgba(16, 185, 129, 0.2);
}
.task-creator-footer {
  padding: 1.5rem 2rem; background: var(--bg-secondary); border-top: 1px solid var(--border);
  display: flex; justify-content: space-between; align-items: center;
}
.footer-info {
  display: flex; align-items: center; gap: 1rem; color: var(--text-secondary); font-size: 0.875rem;
}
.footer-actions {
  display: flex; gap: 1rem;
}
.btn-ghost {
  padding: 0.75rem 1.5rem; background: transparent; border: 2px solid var(--border);
  color: var(--text); border-radius: 0.5rem; font-weight: 600; cursor: pointer; transition: all 0.2s;
}
.btn-ghost:hover {
  background: var(--bg-tertiary);
}
.btn-primary-gradient {
  padding: 0.75rem 2rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white; border: none; border-radius: 0.5rem; font-weight: 600; cursor: pointer;
  transition: all 0.2s; display: flex; align-items: center; gap: 0.5rem;
}
.btn-primary-gradient:hover {
  transform: translateY(-2px); box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
}
.btn-primary-gradient:disabled {
  opacity: 0.5; cursor: not-allowed; transform: none;
}
@keyframes fadeIn {
from {
  opacity: 0;
}
to {
  opacity: 1;
}
}
@keyframes slideUp {
from {
  transform: translateY(20px); opacity: 0;
}
}
@keyframes slideDown {
from {
  transform: translateY(-20px); opacity: 0;
}
to {
  transform: translateY(0); opacity: 1;
}
}
.mobile-nav {
  display: none; position: fixed; bottom: 0; left: 0; right: 0; background: var(--card);
  border-top: 1px solid var(--border); z-index: 50; padding: 0.5rem; box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
}
.mobile-nav-items {
  display: flex; justify-content: space-around; align-items: center;
}
.mobile-nav-item {
  display: flex; flex-direction: column; align-items: center; gap: 0.25rem; padding: 0.5rem;
  color: var(--text-secondary); text-decoration: none; font-size: 0.75rem;
  transition: var(--transition); border-radius: var(--radius); flex: 1;
}
.mobile-nav-item:active {
  transform: scale(0.95);
}
.mobile-nav-item.active {
  color: var(--primary); background: rgba(99, 102, 241, 0.1);
}
.mobile-nav-item i {
  font-size: 1.25rem;
}
.mobile-menu-overlay {
  display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); z-index: 998;
}
.mobile-menu-overlay.active {
  display: block;
}
.mobile-menu {
  position: fixed; top: 0; left: -100%; bottom: 0; width: 85%; max-width: 320px;
  background: var(--card); transition: left 0.3s ease; z-index: 999; overflow-y: auto;
}
.mobile-menu.active {
  left: 0;
}
.mobile-menu-header {
  padding: 1.5rem; background: var(--primary); color: white;
}
.mobile-menu-content {
  padding: 1rem;
}
.user-menu-container {
  position: relative;
}
.user-dropdown {
  position: absolute; top: calc(100% + 0.5rem); right: 0; min-width: 220px;
  background: var(--card); border: 1px solid var(--border); border-radius: var(--radius);
  box-shadow: var(--shadow-xl); display: none; z-index: 1000;
}
.user-dropdown.active {
  display: block;
}
.user-dropdown-item {
  display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; color: var(--text);
  text-decoration: none; transition: var(--transition); cursor: pointer;
}
.user-dropdown-item:hover {
  background: var(--bg-tertiary);
}
.user-dropdown-item i {
  width: 1.25rem;
}
.user-dropdown-item.danger {
  color: var(--error);
}
.sessions-section {
  max-height: 300px; overflow-y: auto;
}
.session-item {
  padding: 0.75rem 1rem; border-bottom: 1px solid var(--border); font-size: 0.875rem;
}
.session-item:last-child {
  border-bottom: none;
}
.session-info {
  display: flex; justify-content: space-between; align-items: start; gap: 0.5rem;
}
.session-location {
  display: flex; align-items: center; gap: 0.25rem; color: var(--text-secondary);
  font-size: 0.8rem; margin-top: 0.25rem;
}
.session-delete {
  padding: 0.25rem 0.5rem; background: transparent; border: 1px solid var(--border);
  border-radius: var(--radius-sm); color: var(--error); cursor: pointer; font-size: 0.75rem;
  transition: var(--transition);
}
.session-delete:hover {
  background: var(--error); color: white; border-color: var(--error);
}
.mobile-search-overlay {
  display: none; position: fixed; top: 0; left: 0; right: 0; background: var(--card);
  padding: 1rem; border-bottom: 1px solid var(--border); z-index: 1001;
}
.mobile-search-overlay.active {
  display: block;
}
.mobile-search-input {
  width: 100%; padding: 0.75rem; border: 1px solid var(--border); border-radius: var(--radius);
  background: var(--input-bg); color: var(--text); font-size: 1rem;
}
.mobile-search-toggle {
  display: none;
}
.domain-item {
  display: flex; flex-direction: column; padding: 1rem; border: 1px solid var(--border);
  border-radius: var(--radius); margin-bottom: 0.75rem; gap: 0.875rem; transition: all 0.2s ease;
  background: var(--card);
}
.domain-item:hover {
  border-color: var(--primary) !important; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08); transform: translateY(-1px);
}
.domain-url-row {
  display: flex; align-items: center; width: 100%; padding-bottom: 0.75rem; border-bottom: 1px solid var(--border);
}
.domain-url-text {
  font-weight: 600; font-size: 0.95rem; word-break: break-all; color: var(--text);
}
.domain-actions-row {
  display: flex; align-items: center; justify-content: space-between; gap: 0.75rem; width: 100%;
}
.domain-status-actions {
  display: flex; align-items: center; gap: 0.5rem; flex: 1; min-width: 0; flex-wrap: wrap;
}
.domain-status-row {
  display: flex; align-items: center; justify-content: space-between; gap: 0.5rem; width: 100%;
}
.domain-buttons-row {
  display: flex; align-items: center; gap: 0.5rem; width: 100%;
}
.domain-verify-delete {
  display: flex; align-items: center; gap: 0.5rem; flex-shrink: 0;
}
.domain-verify-delete-desktop {
  display: none;
}
.domain-status-badge {
  font-size: 0.8rem; padding: 0.4rem 0.75rem; font-weight: 600; white-space: nowrap; flex-shrink: 0;
}
.domain-actions-row .btn {
  white-space: nowrap; font-size: 0.85rem; display: inline-flex; align-items: center; justify-content: center;
}
.btn-verify-instructions i,
.btn-verify-domain i,
.btn-delete-domain i {
  font-size: 1rem; margin-right: 0.25rem;
}
@media (min-width: 581px) and (max-width: 768px) {
.domain-status-row {
  gap: 0.5rem;
}
.domain-buttons-row {
  gap: 0.5rem;
}
.domain-status-row .domain-verify-delete {
  display: none !important;
}
.domain-verify-delete-desktop {
  display: flex !important;
}
.domain-actions-row {
  flex-direction: row; flex-wrap: wrap;
}
.domain-actions-row .btn {
  font-size: 0.85rem; padding: 0.4rem 0.8rem;
}
}
@keyframes fadeIn {
from { opacity: 0; }; to { opacity: 1; };
}
@keyframes slideUp {
from {
  transform: translateY(20px); opacity: 0;
}
to {
  transform: translateY(0); opacity: 1;
}
}
@keyframes slideInRight {
from {
  transform: translateX(100%); opacity: 0;
}
to {
  transform: translateX(0); opacity: 1;
}
}
@keyframes spin {
to { transform: rotate(360deg); };
}
@keyframes pulse {
0%, 100% { transform: translate(-50%, -50%) scale(1); };
50% { transform: translate(-50%, -50%) scale(1.1); };
}
@keyframes slideInMobile {
from {
  transform: translateY(100%); opacity: 0;
}
to {
  transform: translateY(0); opacity: 1;
}
}
@keyframes pulseGlow {
0%, 100% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0.4); };
50% { box-shadow: 0 0 0 10px rgba(99, 102, 241, 0); };
}
.usage-category {
  transition: transform 0.2s ease;
}
.usage-category:hover {
  transform: translateY(-2px);
}
.desktop-only {
  display: block !important;
}
.mobile-only {
  display: none !important;
}
div#modalBody { padding-bottom: 100px; }
.swal2-popup.swal2-toast {
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15), 0 0 40px rgba(99, 102, 241, 0.08) !important;
  background: linear-gradient(135deg, var(--card) 0%, var(--bg-secondary) 100%) !important;
  border: 1px solid var(--border) !important; border-radius: 1rem !important;
}
/* =====================================================
IMAGE DETAILS MODAL - Premium Design
===================================================== */
.image-details-modal-container {
  display: flex; flex-direction: column; gap: 1rem; text-align: left; width: 100%; box-sizing: border-box;
}
.image-hero-section {
  display: flex; flex-direction: column; gap: 1rem; padding-bottom: 1rem; border-bottom: 1px solid var(--border);
}
.image-hero-preview {
  background: linear-gradient(135deg, rgba(15, 23, 42, 0.03), rgba(99, 102, 241, 0.05));
  border: 1px solid var(--border); border-radius: var(--radius-lg); padding: 1.5rem; display: flex;
  align-items: center; justify-content: center; min-height: 220px; position: relative;
}
.image-hero-img {
  max-width: 100%; max-height: 200px; width: auto; height: auto; object-fit: contain;
  border-radius: var(--radius); box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12); cursor: pointer;
  transition: transform 0.25s ease, box-shadow 0.25s ease;
}
.image-hero-img:hover {
  transform: scale(1.03); box-shadow: 0 12px 40px rgba(0, 0, 0, 0.18);
}
.image-info-bar {
  display: flex; align-items: center; justify-content: space-between; gap: 1rem; flex-wrap: wrap;
}
.image-info-left {
  display: flex; flex-direction: column; gap: 0.5rem; flex: 1; min-width: 0;
}
.image-filename {
  font-size: 1rem; font-weight: 700; color: var(--text); display: flex; align-items: center; gap: 0.5rem; margin: 0;
}
.image-filename i {
  color: var(--primary); font-size: 1.1rem;
}
.image-filename span {
  overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
}
.image-meta-row {
  display: flex; flex-wrap: wrap; gap: 0.5rem 1rem; font-size: 0.8rem; color: var(--text-secondary);
}
.image-meta-row span {
  display: inline-flex; align-items: center; gap: 0.3rem;
}
.image-meta-row i {
  font-size: 0.85rem; opacity: 0.7;
}
.image-actions-bar {
  display: flex; gap: 0.5rem; flex-shrink: 0;
}
.image-action-btn {
  display: inline-flex; align-items: center; justify-content: center; gap: 0.4rem;
  padding: 0.55rem 0.85rem; border-radius: var(--radius); font-size: 0.8rem; font-weight: 600;
  cursor: pointer; transition: all 0.2s ease; border: 1px solid var(--border);
  background: var(--bg-tertiary); color: var(--text);
}
.image-action-btn:hover {
  background: var(--card-hover); border-color: var(--primary); color: var(--primary); transform: translateY(-1px);
}
.image-action-btn.btn-copy {
  background: rgba(99, 102, 241, 0.1); border-color: rgba(99, 102, 241, 0.3); color: var(--primary);
}
.image-action-btn.btn-copy:hover {
  background: rgba(99, 102, 241, 0.2);
}
.image-action-btn.btn-open {
  background: rgba(16, 185, 129, 0.1); border-color: rgba(16, 185, 129, 0.3); color: var(--success);
}
.image-action-btn.btn-open:hover {
  background: rgba(16, 185, 129, 0.2);
}
.image-action-btn.btn-delete {
  background: rgba(239, 68, 68, 0.1); border-color: rgba(239, 68, 68, 0.3); color: var(--error);
}
.image-action-btn.btn-delete:hover {
  background: rgba(239, 68, 68, 0.2);
}
.image-action-btn i {
  font-size: 1rem;
}
.image-stats-grid {
  display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.75rem;
}
.image-stat-card {
  background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: var(--radius);
  padding: 0.85rem 0.5rem; text-align: center; transition: all 0.2s ease;
}
.image-stat-card:hover {
  border-color: rgba(99, 102, 241, 0.3); transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
}
.image-stat-card .stat-value {
  font-size: 1.4rem; font-weight: 800; line-height: 1.2; margin-bottom: 0.25rem;
}
.image-stat-card .stat-label {
  font-size: 0.68rem; color: var(--text-secondary); font-weight: 600; text-transform: uppercase; letter-spacing: 0.02em;
}
.image-modal-tabs {
  display: flex; align-items: center; justify-content: center; gap: 0.35rem; padding: 0.3rem;
  border-radius: 999px; background: var(--bg-tertiary); border: 1px solid var(--border);
  width: 100%; max-width: 320px; margin: 0 auto;
}
.image-modal-tab {
  appearance: none; border: 1px solid transparent; background: transparent; color: var(--text);
  border-radius: 999px; padding: 0.5rem 1.25rem; font-weight: 700; font-size: 0.85rem;
  cursor: pointer; display: inline-flex; align-items: center; justify-content: center; gap: 0.4rem;
  transition: all 0.2s ease; flex: 1;
}
.image-modal-tab:hover:not(:disabled) {
  background: rgba(99, 102, 241, 0.08);
}
.image-modal-tab[data-tab="analytics"].active {
  background: rgba(99, 102, 241, 0.14); border-color: rgba(99, 102, 241, 0.5);
  color: var(--primary); box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.15);
}
.image-modal-tab[data-tab="traffic"].active {
  background: rgba(245, 158, 11, 0.14); border-color: rgba(245, 158, 11, 0.5);
  color: var(--warning); box-shadow: 0 0 0 2px rgba(245, 158, 11, 0.15);
}
.image-modal-panels {
  width: 100%;
}
.image-modal-panel {
  width: 100%;
}
.image-modal-panel.panel-in {
  animation: imagePanelIn 180ms ease-out;
}
@keyframes imagePanelIn {
}
.image-modal-panel[hidden] {
  display: none !important;
}
.image-analytics-content {
  display: grid; grid-template-columns: 1fr; gap: 0.75rem;
}
.image-chart-card {
  background: var(--card); border: 1px solid var(--border); border-radius: var(--radius); overflow: hidden;
}
.image-chart-card .chart-header {
  padding: 0.6rem 0.85rem; background: var(--bg-tertiary); border-bottom: 1px solid var(--border);
  font-size: 0.85rem; font-weight: 700; display: flex; align-items: center; gap: 0.4rem;
}
.image-chart-card .chart-header i {
  color: var(--primary); font-size: 1rem;
}
.image-chart-card .chart-body {
  padding: 0.65rem; height: 180px;
}
.image-traffic-content {
  display: grid; grid-template-columns: 1fr; gap: 0.75rem;
}
.image-traffic-card {
  background: var(--card); border: 1px solid var(--border); border-radius: var(--radius); overflow: hidden;
}
.image-traffic-card .card-header {
  padding: 0.6rem 0.85rem; background: var(--bg-tertiary); border-bottom: 1px solid var(--border);
  font-size: 0.85rem; font-weight: 700; display: flex; align-items: center; gap: 0.4rem;
}
.image-traffic-card .card-header i {
  font-size: 1rem;
}
.image-traffic-card .card-header i.ri-window-line { color: var(--primary); }
.image-traffic-card .card-header i.ri-device-line { color: var(--warning); }
.image-traffic-card .card-header i.ri-earth-line { color: var(--success); }
.image-traffic-card .card-body {
  padding: 0.65rem;
}
.image-traffic-list {
  display: flex; flex-direction: column; gap: 0.4rem;
}
.image-traffic-item {
  display: flex; justify-content: space-between; align-items: center; padding: 0.5rem 0.7rem;
  background: var(--bg-tertiary); border-radius: var(--radius-sm); border: 1px solid var(--border);
  transition: all 0.15s ease;
}
.image-traffic-item:hover {
  background: var(--card-hover); border-color: rgba(99, 102, 241, 0.25);
}
.image-traffic-item .item-name {
  font-weight: 600; color: var(--text); font-size: 0.85rem;
}
.image-empty-state {
  padding: 2rem 1rem; text-align: center; background: var(--bg-tertiary);
  border-radius: var(--radius); border: 1px solid var(--border);
}
.image-empty-state i {
  font-size: 2.5rem; color: var(--text-secondary); opacity: 0.5; margin-bottom: 0.75rem;
}
.image-empty-state h4 {
  margin: 0 0 0.35rem; font-size: 1rem; color: var(--text);
}
.image-empty-state p {
  margin: 0; font-size: 0.85rem; color: var(--text-secondary);
}
.swal2-popup.image-details-swal {
  margin: 0 !important; width: min(800px, 92vw) !important; max-width: 92vw !important;
  box-sizing: border-box !important; padding: 1rem !important;
}
.swal2-popup.image-details-swal .swal2-html-container {
  width: 100% !important; max-width: 100% !important; box-sizing: border-box !important;
  margin: 0 !important; padding: 0 !important; overflow-x: hidden !important; overflow-y: auto !important;
}
.swal2-popup.image-details-swal .swal2-title,
.swal2-popup.image-details-swal .swal2-actions {
  display: none !important;
}
/* =====================================================
ARTICLE DETAILS MODAL - Premium Design with Tabs
===================================================== */
.article-details-modal-container {
  display: flex; flex-direction: column; gap: 0; text-align: left; width: 100%; max-width: 100%; box-sizing: border-box;
}
.article-modal-header {
  background: transparent; padding: 0 0 1rem 0; margin: 0 0 1rem 0; border-bottom: 1px solid var(--border);
}
.article-modal-header-row {
  display: flex; align-items: flex-start; justify-content: space-between; gap: 1rem;
}
.article-modal-title {
  flex: 1; min-width: 0;
}
.article-modal-title h3 {
  margin: 0; font-size: 1.1rem; font-weight: 700; line-height: 1.35;
}
.article-modal-url-pill {
  display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.5rem 0.85rem;
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.12), rgba(139, 92, 246, 0.08));
  border: 1px solid rgba(99, 102, 241, 0.35); border-radius: 999px; color: var(--primary);
  text-decoration: none; font-weight: 600; font-size: 0.85rem; max-width: 100%; transition: all 0.2s ease;
}
.article-modal-url-pill:hover {
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.18), rgba(139, 92, 246, 0.12));
  transform: translateY(-1px); box-shadow: 0 4px 12px rgba(99, 102, 241, 0.2);
}
.article-modal-url-pill span {
  overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
}
.article-header-meta-row {
  display: flex; align-items: center; justify-content: space-between; gap: 0.75rem;
  margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px solid var(--border);
}
.article-modal-actions-desktop {
  display: flex; gap: 0.75rem; flex-shrink: 0;
}
.article-modal-actions-desktop .btn {
  padding: 0.5rem 1rem; font-size: 0.8rem; border-radius: var(--radius); display: inline-flex;
  align-items: center; gap: 0.4rem; transition: all 0.2s ease;
}
.article-modal-actions-desktop .btn-edit {
  background: var(--bg-tertiary); border: 1px solid var(--border); color: var(--text);
}
.article-modal-actions-desktop .btn-edit:hover {
  background: var(--primary); border-color: var(--primary); color: white;
}
.article-modal-actions-desktop .btn-delete {
  background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); color: var(--danger);
}
.article-modal-actions-desktop .btn-delete:hover {
  background: var(--danger); border-color: var(--danger); color: white;
}
.article-modal-actions-mobile {
  display: none;
}
.article-header-meta {
  display: flex; flex-wrap: wrap; gap: 0.5rem 1rem; font-size: 0.8rem;
  color: var(--text-secondary); flex: 1; min-width: 0;
}
.article-header-meta span {
  display: inline-flex; align-items: center; gap: 0.35rem;
}
.article-header-meta i {
  font-size: 0.95rem; opacity: 0.7;
}
.article-modal-stat-grid {
  display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.75rem; margin-bottom: 1rem;
}
.article-modal-stat-card {
  background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: var(--radius);
  padding: 0.85rem; text-align: center; transition: all 0.2s ease;
}
.article-modal-stat-card:hover {
  border-color: rgba(99, 102, 241, 0.3); transform: translateY(-1px);
}
.article-modal-stat-card .stat-value {
  font-size: 1.35rem; font-weight: 800; line-height: 1.2; margin-bottom: 0.25rem;
}
.article-modal-stat-card .stat-label {
  font-size: 0.7rem; color: var(--text-secondary); font-weight: 600; text-transform: uppercase; letter-spacing: 0.03em;
}
.article-modal-tabs {
  display: inline-flex; align-items: center; justify-content: space-between; gap: 0.25rem;
  padding: 0.25rem; border-radius: 999px; background: var(--bg-tertiary);
  border: 1px solid var(--border); margin: 0 0 1.25rem; width: 100%; flex-wrap: nowrap;
}
.article-modal-tab {
  appearance: none; border: 1px solid transparent; background: transparent; color: var(--text);
  border-radius: 999px; padding: 0.55rem 0.85rem; font-weight: 700; font-size: 0.9rem;
  cursor: pointer; display: inline-flex; align-items: center; justify-content: center;
  gap: 0.45rem; transition: all 0.2s ease; flex: 1; min-width: 0; white-space: nowrap;
}
.article-modal-tab:hover {
  transform: translateY(-1px); box-shadow: 0 10px 25px rgba(0, 0, 0, 0.10);
}
.article-modal-tab:disabled {
  cursor: not-allowed; opacity: 0.5; transform: none; box-shadow: none;
}
.article-modal-tab[data-tab="analytics"].active {
  background: rgba(99, 102, 241, 0.14); border-color: rgba(99, 102, 241, 0.65); color: var(--primary);
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.20), 0 14px 40px rgba(99, 102, 241, 0.15);
}
.article-modal-tab[data-tab="images"].active {
  background: rgba(245, 158, 11, 0.14); border-color: rgba(245, 158, 11, 0.65); color: var(--warning);
  box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.20), 0 14px 40px rgba(245, 158, 11, 0.15);
}
.article-modal-tab[data-tab="content"].active {
  background: rgba(16, 185, 129, 0.14); border-color: rgba(16, 185, 129, 0.55); color: var(--success);
  box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.16), 0 14px 40px rgba(16, 185, 129, 0.12);
}
.article-modal-tab .label-mobile { display: none; }
.article-modal-tab .label-desktop { display: inline; }
.article-modal-tab.icon-only .label-mobile,
.article-modal-tab.icon-only .label-desktop { display: none !important; }
.article-modal-tab.icon-only { padding-left: 0.55rem; padding-right: 0.55rem; }
.article-modal-tab.icon-only i { margin: 0; }
.article-modal-panels {
  display: grid; grid-template-columns: 1fr; gap: 1rem;
}
.article-modal-panel.panel-in {
  animation: articlePanelIn 180ms ease-out;
}
@keyframes articlePanelIn {
}
.article-modal-panel[hidden] {
  display: none !important;
}
.article-analytics-section {
  display: flex; flex-direction: column; gap: 1rem;
}
.article-chart-wrap {
  background: var(--card); border: 1px solid var(--border); border-radius: var(--radius); padding: 1rem; height: 280px;
}
.article-chart-wrap.small {
  height: 200px;
}
.article-mini-charts-grid {
  display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.75rem;
}
.article-mini-chart-card {
  background: var(--card); border: 1px solid var(--border); border-radius: var(--radius); overflow: hidden;
}
.article-mini-chart-card .chart-title {
  padding: 0.6rem 0.85rem; background: var(--bg-tertiary); border-bottom: 1px solid var(--border);
  font-size: 0.8rem; font-weight: 700; color: var(--text); display: flex; align-items: center; gap: 0.4rem;
}
.article-mini-chart-card .chart-title i {
  font-size: 0.95rem; opacity: 0.7;
}
.article-mini-chart-card .chart-body {
  padding: 0.5rem; height: 160px;
}
.article-images-slider-container {
  display: flex; flex-direction: column; gap: 1rem;
}
.article-image-slider {
  position: relative; background: linear-gradient(135deg, rgba(99, 102, 241, 0.05), rgba(139, 92, 246, 0.05));
  border: 1px solid var(--border); border-radius: var(--radius-lg); padding: 1.5rem;
  min-height: 320px; display: flex; align-items: center; justify-content: center;
}
.article-slider-image {
  max-width: 100%; max-height: 300px; width: auto; height: auto; object-fit: contain;
  border-radius: var(--radius); box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15); cursor: pointer;
  transition: transform 0.3s ease;
}
.article-slider-image:hover {
  transform: scale(1.02);
}
.article-slider-nav {
  position: absolute; top: 50%; transform: translateY(-50%); width: 42px; height: 42px;
  border-radius: 50%; background: var(--card); border: 1px solid var(--border); color: var(--text);
  cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 1.2rem;
  transition: all 0.2s ease; z-index: 10; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}
.article-slider-nav:hover {
  background: var(--primary); color: white; border-color: var(--primary); transform: translateY(-50%) scale(1.05);
}
.article-slider-nav.prev { left: 0.75rem; }
.article-slider-nav.next { right: 0.75rem; }
.article-slider-counter {
  text-align: center; font-size: 0.85rem; color: var(--text-secondary); font-weight: 600;
}
.article-slider-counter span {
  color: var(--primary); font-weight: 700;
}
.article-slider-thumbnails {
  display: flex; gap: 0.5rem; justify-content: center; flex-wrap: wrap; padding: 0.5rem;
}
.article-slider-thumb {
  width: 60px; height: 60px; border-radius: var(--radius-sm); overflow: hidden; cursor: pointer;
  border: 2px solid var(--border); transition: all 0.2s ease; opacity: 0.6;
}
.article-slider-thumb:hover {
  opacity: 1; border-color: var(--text-secondary);
}
.article-slider-thumb.active {
  opacity: 1; border-color: var(--primary); box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.3);
}
.article-slider-thumb img {
  width: 100%; height: 100%; object-fit: cover;
}
.article-no-images {
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  padding: 3rem 1.5rem; text-align: center; background: var(--bg-tertiary);
  border: 1px solid var(--border); border-radius: var(--radius);
}
.article-no-images i {
  font-size: 3rem; color: var(--text-secondary); opacity: 0.4; margin-bottom: 1rem;
}
.article-no-images h4 {
  margin: 0 0 0.5rem; font-size: 1.1rem; color: var(--text);
}
.article-no-images p {
  margin: 0; font-size: 0.85rem; color: var(--text-secondary);
}
.article-content-panel {
  display: flex; flex-direction: column; gap: 1rem;
}
.article-content-info {
  display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.75rem;
}
.article-content-info-card {
  background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: var(--radius);
  padding: 0.85rem; text-align: center;
}
.article-content-info-card .info-value {
  font-size: 1.1rem; font-weight: 700; color: var(--text); margin-bottom: 0.15rem;
}
.article-content-info-card .info-label {
  font-size: 0.7rem; color: var(--text-secondary); font-weight: 600; text-transform: uppercase;
}
.article-content-preview {
  background: var(--card); border: 1px solid var(--border); border-radius: var(--radius); overflow: hidden;
}
.article-content-preview-header {
  display: flex; align-items: center; justify-content: space-between; padding: 0.75rem 1rem;
  background: var(--bg-tertiary); border-bottom: 1px solid var(--border);
}
.article-content-preview-header h4 {
  margin: 0; font-size: 0.9rem; font-weight: 700; display: flex; align-items: center; gap: 0.5rem;
}
.article-content-preview-header h4 i {
  color: var(--success);
}
.article-content-body {
  padding: 1.25rem; font-family: Georgia, 'Times New Roman', serif; font-size: 0.95rem;
  line-height: 1.8; color: var(--text); max-height: 380px; overflow-y: auto;
}
.article-content-body::-webkit-scrollbar {
  width: 6px;
}
.article-content-body::-webkit-scrollbar-track {
  background: var(--bg-tertiary);
}
.article-content-body::-webkit-scrollbar-thumb {
  background: var(--border); border-radius: 3px;
}
.article-content-body::-webkit-scrollbar-thumb:hover {
  background: var(--text-secondary);
}
.swal2-popup.article-details-swal {
  margin: 0 !important; width: min(900px, 92vw) !important; max-width: 92vw !important;
  box-sizing: border-box !important; padding: 1rem !important;
}
.swal2-popup.article-details-swal .swal2-html-container {
  width: 100% !important; max-width: 100% !important; box-sizing: border-box !important;
  margin: 0 !important; padding: 0 !important; overflow-x: hidden !important; overflow-y: auto !important;
}
.swal2-popup.article-details-swal .swal2-title,
.swal2-popup.article-details-swal .swal2-actions {
  display: none !important;
}
.swal2-popup.image-article-details-swal {
  width: min(900px, 95vw) !important; max-width: 95vw !important;
  box-sizing: border-box !important; padding: 1.25rem !important;
}
.swal2-popup.image-article-details-swal .swal2-html-container {
  width: 100% !important; max-width: 100% !important; box-sizing: border-box !important;
  margin: 0.75rem 0 !important; padding: 0 !important;
}
.swal2-popup.image-article-details-swal .swal2-title {
  font-size: 1.25rem !important; padding: 0.5rem 0 !important;
}
.swal2-toast button:where(.swal2-close) {
  grid-column: 3 / 3; grid-row: 1 / 99; align-self: flex-start!important; margin: 0!important; font-size: 3em!important;
}
.task-details-modal-container {
  text-align: left; width: 100%; max-width: 100%; box-sizing: border-box;
}
.task-modal-header {
  background: transparent; padding: 0 0 1rem 0; margin: 0 0 1rem 0; border-bottom: 1px solid var(--border);
}
.task-modal-header-row {
  display: flex; align-items: flex-start; justify-content: space-between; gap: 1rem;
}
.task-modal-title {
  min-width: 0; flex: 1;
}
.task-modal-actions-slot {
  flex: 0 0 auto; display: flex; justify-content: flex-end; align-items: center;
}
.task-modal-actions-slot:empty {
  display: none;
}
.task-modal-actions-slot .swal2-actions {
  margin: 0 !important; gap: 0.5rem !important; padding: 0 !important; width: auto !important;
  justify-content: flex-end !important;
}
.task-modal-actions-slot .swal2-actions button {
  padding: 0.55rem 0.9rem !important; font-size: 0.85rem !important; line-height: 1.1 !important;
}
.task-modal-actions-slot .swal2-actions button .task-action-sub {
  display: block; margin-top: 0.2rem; font-size: 0.72rem; font-weight: 600; opacity: 0.9;
}
.task-modal-url-pill {
  display: inline-flex; align-items: center; gap: 0.55rem; max-width: 100%; padding: 0.5rem 0.75rem; border-radius: 999px; background: rgba(148, 163, 184, 0.10); border: 1px solid rgba(148, 163, 184, 0.22); color: var(--text); text-decoration: none; font-weight: 900; font-size: 0.93rem; line-height: 1.2; overflow: hidden;
  justify-content: flex-start; align-self: flex-start; margin-right: auto;
}
.task-modal-url-pill span {
  min-width: 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; flex: 1 1 auto;
}
.task-modal-url-pill:hover {
  background: rgba(99, 102, 241, 0.10); border-color: rgba(99, 102, 241, 0.55);
  color: var(--primary); box-shadow: 0 12px 30px rgba(99, 102, 241, 0.12);
}
.task-modal-url-pill i {
  font-size: 1.05em; flex: 0 0 auto; opacity: 0.9;
}
.task-modal-tabs {
  display: inline-flex; align-items: center; justify-content: space-between; gap: 0.25rem;
  padding: 0.25rem; border-radius: 999px; background: var(--bg-tertiary);
  border: 1px solid var(--border); margin: 1rem 0 1.25rem; width: 100%; flex-wrap: nowrap;
}
.task-modal-tab {
  appearance: none; border: 1px solid transparent; background: transparent; color: var(--text);
  border-radius: 999px; padding: 0.55rem 0.85rem; font-weight: 700; font-size: 0.9rem;
  cursor: pointer; display: inline-flex; align-items: center; gap: 0.45rem;
  transition: var(--transition); flex: 1 1 0; justify-content: center; white-space: nowrap;
}
.task-modal-tab:hover {
  transform: translateY(-1px); box-shadow: 0 10px 25px rgba(0, 0, 0, 0.10);
}
.task-modal-tab:disabled {
  cursor: not-allowed; opacity: 0.5; transform: none; box-shadow: none;
}
.task-modal-tab[data-tab="analytics"].active {
  background: rgba(99, 102, 241, 0.14); border-color: rgba(99, 102, 241, 0.65); color: var(--primary);
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.20), 0 14px 40px rgba(99, 102, 241, 0.15);
}
.task-modal-tab[data-tab="details"].active {
  background: rgba(16, 185, 129, 0.14); border-color: rgba(16, 185, 129, 0.55); color: var(--success);
  box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.16), 0 14px 40px rgba(16, 185, 129, 0.12);
}
.task-modal-tab[data-tab="config"].active {
  background: rgba(14, 165, 233, 0.14); border-color: rgba(14, 165, 233, 0.65); color: var(--info);
  box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.18), 0 14px 40px rgba(14, 165, 233, 0.12);
}
.task-modal-panels {
  display: grid; grid-template-columns: 1fr; gap: 1rem;
}
.task-modal-panel.panel-in {
  animation: taskPanelIn 180ms ease-out;
}
@keyframes taskPanelIn {
from { opacity: 0; transform: translateY(6px); };
}
.task-modal-panel[hidden] {
  display: none !important;
}
.task-modal-subtitle {
  font-size: 0.9rem; margin: 0.75rem 0 0.5rem; color: var(--text-secondary); font-weight: 600;
}
.task-modal-mini-chart {
  height: 140px; position: relative; margin-bottom: 1rem;
}
.task-modal-header h3 {
  font-size: 1.25rem; margin: 0 0 0.75rem 0; word-break: break-all; color: var(--primary);
  display: flex; justify-content: flex-start; text-align: left;
}
.task-modal-header .header-meta {
  font-size: 0.8rem; color: var(--text-secondary); display: flex; align-items: flex-start;
  justify-content: space-between; gap: 0.75rem; flex-wrap: wrap;
}
.task-modal-header .header-meta .header-meta-left {
  display: flex; flex-wrap: wrap; gap: 0.5rem 1.25rem; min-width: 0; flex: 1 1 auto;
}
.task-modal-header .header-meta .header-meta-right {
  flex: 0 0 auto; margin-left: auto; display: inline-flex; justify-content: flex-end; align-items: center;
}
.task-verify-inline-btn {
  background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%) !important;
  color: white !important; border: none !important; padding: 0.5rem 1rem !important;
  border-radius: 8px !important; font-size: 0.9rem !important; font-weight: 700 !important;
  cursor: pointer !important; display: inline-flex !important; align-items: center !important;
  gap: 0.4rem !important; transition: all 0.2s ease !important; flex-shrink: 0 !important;
  box-shadow: 0 2px 8px rgba(249, 158, 11, 0.25) !important; letter-spacing: 0.01em !important;
}
.task-verify-inline-btn:hover {
  background: linear-gradient(135deg, #d97706 0%, #b45309 100%) !important; transform: translateY(-2px) !important;
  box-shadow: 0 6px 16px rgba(249, 158, 11, 0.4) !important;
}
.task-verify-inline-btn i {
  font-size: 1.1em !important;
}
.task-config-btn {
  appearance: none; border: 1px solid rgba(14, 165, 233, 0.55) !important;
  background: rgba(14, 165, 233, 0.10) !important; color: var(--info) !important;
  border-radius: 999px !important; padding: 0.5rem 0.75rem !important; font-weight: 900 !important;
  font-size: 0.85rem !important; line-height: 1.1 !important; box-shadow: none !important;
  flex: 0 0 auto !important; gap: 0.45rem !important;
}
.task-config-btn:hover {
  transform: translateY(-1px); background: rgba(14, 165, 233, 0.14) !important;
  border-color: rgba(14, 165, 233, 0.75) !important; box-shadow: 0 14px 40px rgba(14, 165, 233, 0.12) !important;
}
.task-config-btn.active {
  background: rgba(14, 165, 233, 0.16) !important;
  box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.18), 0 14px 40px rgba(14, 165, 233, 0.10) !important;
}
.task-modal-stat-grid {
  display: grid; grid-template-columns: repeat(4, minmax(0, 1fr)); gap: 1rem; margin-bottom: 2rem;
}
.task-modal-stat-card {
  background: var(--card); padding: 1rem; border-radius: var(--radius);
  border: 1px solid var(--border); text-align: center;
}
.task-modal-stat-card .stat-value {
  font-size: 1.75rem; font-weight: 700; margin-bottom: 0.25rem;
}
.task-modal-stat-card .stat-label {
  font-size: 0.8rem; color: var(--text-secondary);
}
.task-modal-grid {
  display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem;
}
.task-modal-section {
  background: var(--card); border-radius: var(--radius-lg); border: 1px solid var(--border); padding: 1.25rem;
}
.task-modal-section-title {
  font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; padding-bottom: 0.75rem;
  border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 0.5rem;
}
.xpath-list {
  max-height: 200px; overflow-y: auto; background: var(--bg-tertiary); border-radius: var(--radius); padding: 1rem;
}
.xpath-list code {
  display: block; margin-bottom: 0.75rem; padding-bottom: 0.75rem;
  border-bottom: 1px solid var(--border); font-size: 0.75rem; line-height: 1.4; word-break: break-all;
}
.xpath-list code:last-child {
  border-bottom: none; margin-bottom: 0; padding-bottom: 0;
}
.task-budget-actions {
  background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: var(--radius-lg);
  padding: 1rem; margin: 0 0 1.25rem 0;
}
.task-done-table-wrap {
  border: 1px solid var(--border); border-radius: 14px; overflow: hidden; background: rgba(255, 255, 255, 0.02);
}
.task-done-table {
  width: 100%; border-collapse: collapse; font-size: 0.85rem;
}
.task-done-table thead th {
  text-align: left; padding: 0.75rem 0.85rem; color: var(--text-secondary); font-weight: 900;
  letter-spacing: 0.01em; background: var(--bg-tertiary); border-bottom: 1px solid var(--border);
}
.task-done-table tbody td {
  padding: 0.75rem 0.85rem; border-bottom: 1px solid var(--border); color: var(--text);
  font-weight: 700; vertical-align: top;
}
.task-done-table tbody tr:last-child td {
  border-bottom: none;
}
.task-done-table .muted {
  color: var(--text-secondary); font-weight: 800; font-size: 0.8rem;
}
.task-done-table .country-badge {
  display: inline-flex; align-items: center; gap: 0.4rem; padding: 0.22rem 0.6rem;
  border-radius: 999px; border: 1px solid rgba(148, 163, 184, 0.22);
  background: rgba(148, 163, 184, 0.10); color: var(--text); font-weight: 900; font-size: 0.8rem;
  white-space: nowrap; max-width: 100%; overflow: hidden; min-width: 0;
}
.task-done-table .country-badge .country-flag {
  width: 18px; height: 18px; border-radius: 999px; display: inline-flex; align-items: center;
  justify-content: center; font-size: 0.95rem; line-height: 1;
  background: rgba(255, 255, 255, 0.06); border: 1px solid rgba(148, 163, 184, 0.22);
  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.10); flex: 0 0 auto;
}
.task-done-table .country-badge .country-text {
  letter-spacing: 0.02em; color: var(--text); min-width: 0; overflow: hidden; text-overflow: ellipsis;
}
.task-done-table a.task-email {
  color: var(--info); text-decoration: none; font-weight: 900;
}
.task-done-table a.task-email:hover {
  text-decoration: underline;
}
.task-done-cards {
  display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 0.85rem;
  padding: 1rem; background: rgba(0, 0, 0, 0.02); border-radius: 12px;
}
.task-done-card {
  border: 1px solid var(--border); border-radius: 14px;
  background: linear-gradient(135deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
  padding: 0.9rem 1rem; display: flex; flex-direction: column; gap: 0.55rem; min-width: 0;
  transition: all 0.2s ease; box-shadow: 0 2px 8px rgba(0,0,0,0.04);
}
.task-done-card:hover {
  border-color: rgba(148,163,184,0.35); box-shadow: 0 4px 12px rgba(0,0,0,0.08); transform: translateY(-1px);
}
.task-done-card-top {
  display: flex; align-items: center; justify-content: space-between; gap: 0.6rem; min-width: 0;
}
.task-done-card-top .left {
  display: inline-flex; align-items: center; gap: 0.5rem; min-width: 0; flex: 0 1 auto; overflow: hidden;
}
.task-done-idx {
  display: inline-flex; align-items: center; justify-content: center; padding: 0.22rem 0.5rem;
  border-radius: 8px; border: 1px solid rgba(148,163,184,0.18);
  background: linear-gradient(135deg, rgba(99,102,241,0.12), rgba(139,92,246,0.08));
  color: var(--primary); font-weight: 800; font-size: 0.75rem; white-space: nowrap; min-width: 28px;
}
.task-done-time {
  display: none; color: var(--text-secondary); font-weight: 600; font-size: 0.78rem;
  white-space: nowrap; padding: 0.15rem 0.45rem; background: rgba(148,163,184,0.08);
  border-radius: 6px; max-width: 50%; overflow: hidden; text-overflow: ellipsis;
}
.task-done-kv {
  display: flex; align-items: center; gap: 0.5rem; min-width: 0;
}
.task-done-kv .label {
  color: var(--text-secondary); font-weight: 800; font-size: 0.72rem; letter-spacing: 0.03em;
  text-transform: uppercase; white-space: nowrap;
}
.task-done-kv .value {
  color: var(--text); font-weight: 700; font-size: 0.9rem; line-height: 1.25; min-width: 0;
  flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
}
.task-done-kv .value a.task-email {
  color: var(--info); text-decoration: none; font-weight: 700; display: block; overflow: hidden;
  text-overflow: ellipsis; white-space: nowrap;
}
.task-done-kv .value a.task-email:hover { text-decoration: underline; }
.task-done-rawtime {
  display: flex; align-items: center; gap: 0.4rem; color: var(--text-secondary); font-weight: 600;
  font-size: 0.75rem; padding: 0.35rem 0.5rem; background: rgba(148,163,184,0.08); border-radius: 6px;
}
.task-done-rawtime i { color: var(--primary); font-size: 0.9rem; opacity: 0.8; }
.task-done-card .country-badge {
  display: inline-flex; align-items: center; gap: 0.35rem; padding: 0.2rem 0.55rem;
  border-radius: 999px; border: 1px solid rgba(148,163,184,0.22);
  background: rgba(148,163,184,0.10); color: var(--text); font-weight: 800; font-size: 0.78rem; white-space: nowrap;
}
.task-done-card .country-badge .country-flag {
  width: 16px; height: 16px; border-radius: 999px; display: inline-flex; align-items: center;
  justify-content: center; font-size: 0.85rem; line-height: 1; background: rgba(255,255,255,0.06);
}
.task-done-card .country-badge .country-text { letter-spacing: 0.02em; }
.task-done-pager {
  display: flex; flex-wrap: wrap; align-items: center; justify-content: space-between;
  gap: 0.75rem; padding: 0.75rem 0.85rem; border-top: 1px solid var(--border); background: rgba(255,255,255,0.01);
}
.task-done-pager .btns {
  width: 100%; display: flex; align-items: center; justify-content: space-between; gap: 0.75rem; min-width: 0;
}
.task-done-pager .pages {
  display: flex; align-items: center; justify-content: center; gap: 0.25rem; flex: 1; min-width: 0; padding: 0 0.25rem;
}
.task-done-pager .pages .task-done-page-btn.page {
  flex: 1 1 auto; max-width: 48px;
}
.task-done-pager .task-done-page-btn {
  appearance: none; display: inline-flex; align-items: center; justify-content: center;
  gap: 0.35rem; border: 1px solid var(--border); background: rgba(148,163,184,0.10);
  color: var(--text); border-radius: 999px; padding: 0.45rem 0.7rem; font-weight: 900;
  font-size: 0.82rem; min-width: 36px; height: 34px; cursor: pointer; transition: var(--transition); user-select: none;
}
.task-done-pager .task-done-page-btn:hover { transform: translateY(-1px); background: rgba(148,163,184,0.16); }
.task-done-pager .task-done-page-btn:disabled { opacity: 0.45; cursor: not-allowed; transform: none; }
.task-done-pager .task-done-page-btn.active { border-color: rgba(16,185,129,0.65); background: rgba(16,185,129,0.12); color: var(--success); }
.task-done-pager .task-done-page-btn.nav { min-width: 78px; }
.task-done-pager .task-done-page-btn.nav i { font-size: 1.1em; }
.task-done-pager .ellipsis { color: var(--text-secondary); font-weight: 900; padding: 0 0.25rem; line-height: 1; user-select: none; }
.task-done-pager .meta { color: var(--text-secondary); font-weight: 800; font-size: 0.82rem; width: 100%; text-align: right; }
.task-done-list { list-style: none; padding: 0; margin: 0; display: grid; gap: 0.5rem; }
.task-done-list li {
  display: flex; align-items: flex-start; gap: 0.6rem; padding: 0.75rem 0.8rem;
  border-radius: 12px; border: 1px solid var(--border); background: rgba(255,255,255,0.02);
  color: var(--text); font-weight: 700;
}
.task-done-list li i { color: var(--success); font-size: 1.05rem; margin-top: 0.05rem; }
.task-done-list li strong { font-weight: 900; }
.task-install-instructions {
  background-color: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 12px;
  padding: 1rem; margin-top: 0.75rem; font-size: 0.85rem; line-height: 1.6; color: var(--text);
}
.task-install-instructions p {
  color: var(--text); margin: 0.25rem 0;
}
.task-install-instructions code {
  display: block; background: #282c34; color: #f8f8f2; padding: 0.75rem; border-radius: 10px;
  overflow-x: auto; font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
  margin-top: 0.5rem; font-size: 0.8rem;
}
.task-copy-btn {
  margin-top: 0.65rem; appearance: none; border: 1px solid rgba(14, 165, 233, 0.55);
  background: rgba(14, 165, 233, 0.12); color: var(--info); padding: 0.55rem 0.85rem;
  border-radius: 999px; cursor: pointer; font-size: 0.85rem; font-weight: 900;
  display: inline-flex; align-items: center; gap: 0.5rem; transition: var(--transition);
}
.task-copy-btn:hover {
  transform: translateY(-1px); border-color: rgba(14, 165, 233, 0.75);
  background: rgba(14, 165, 233, 0.16); box-shadow: 0 14px 40px rgba(14, 165, 233, 0.12);
}
.task-copy-btn:active { transform: translateY(0); }
.task-budget-split {
  display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 0.65rem; margin-top: 0.75rem;
}
.task-budget-split .split-item {
  display: flex; align-items: center; justify-content: space-between; gap: 0.75rem;
  padding: 0.65rem 0.75rem; border-radius: 12px; border: 1px solid var(--border); background: rgba(255, 255, 255, 0.02);
}
.task-budget-split .split-item .left {
  display: inline-flex; align-items: center; gap: 0.5rem; color: var(--text-secondary);
  font-weight: 800; font-size: 0.8rem;
}
.task-budget-split .dot {
  width: 10px; height: 10px; border-radius: 999px; flex: 0 0 auto;
}
.task-budget-split .split-item strong {
  color: var(--text); font-weight: 900;
}
.task-budget-split .split-item.used .dot { background: var(--warning); box-shadow: 0 0 0 4px rgba(245, 158, 11, 0.18); }
.task-budget-split .split-item.avail .dot { background: var(--success); box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.16); }
.task-budget-split .split-item.total .dot { background: var(--primary); box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.14); }
.task-budget-bar {
  width: 100%; height: 10px; border-radius: 999px; overflow: hidden;
  background: rgba(148, 163, 184, 0.18); display: flex;
}
.task-budget-bar .seg {
  height: 100%;
}
.task-budget-bar .seg.used {
  background: rgba(99, 102, 241, 0.95);
}
.task-budget-bar .seg.avail {
  background: rgba(16, 185, 129, 0.95);
}
.task-modal-chart-stack {
  display: grid; grid-template-columns: 1fr; gap: 1rem;
}
.task-modal-chart-wrap {
  height: 230px;
}
.task-modal-chart-wrap.small {
  height: 200px;
}
.analytics-mobile-switch {
  display: none; width: 100%; padding: 0.25rem; background: rgba(148, 163, 184, 0.08);
  border-radius: 12px; border: 1px solid var(--border); margin-bottom: 1rem; gap: 0.25rem;
}
.analytics-switch-btn {
  flex: 1; appearance: none; border: 1px solid transparent; background: transparent;
  color: var(--text-secondary); border-radius: 10px; padding: 0.6rem 0.75rem; font-weight: 700;
  font-size: 0.85rem; cursor: pointer; transition: all 0.2s ease; display: inline-flex;
  align-items: center; justify-content: center; gap: 0.4rem; white-space: nowrap;
}
.analytics-switch-btn:hover {
  color: var(--text); background: rgba(148, 163, 184, 0.1);
}
.analytics-switch-btn.active {
  background: var(--bg); color: var(--primary); border-color: rgba(99, 102, 241, 0.4);
  box-shadow: 0 2px 8px rgba(99, 102, 241, 0.15);
}
.analytics-switch-btn.active[data-view="map"] {
  color: var(--info); border-color: rgba(14, 165, 233, 0.4); box-shadow: 0 2px 8px rgba(14, 165, 233, 0.15);
}
.analytics-switch-btn i {
  font-size: 1.1em;
}
.task-modal-map {
  height: 360px; border-radius: var(--radius); overflow: hidden; border: 1px solid var(--border);
  background: var(--bg-tertiary);
}
.task-modal-map-note {
  margin-top: 0.75rem; display: flex; flex-wrap: wrap; gap: 0.5rem;
}
.task-modal-map-note .chip {
  display: inline-flex; align-items: center; justify-content: space-between; gap: 0.5rem;
  padding: 0.35rem 0.6rem; border-radius: 999px; border: 1px solid var(--border);
  background: rgba(14, 165, 233, 0.08); font-size: 0.78rem; font-weight: 800; color: var(--text);
}
.task-modal-map-note .chip span {
  color: var(--text-secondary); font-weight: 900;
}
.task-modal-tab .label-mobile { display: none; }
.task-modal-tab .label-desktop { display: inline; }
.task-modal-tab.icon-only .label-mobile,
.task-modal-tab.icon-only .label-desktop {
  display: none !important;
}
.task-modal-tab.icon-only {
  padding-left: 0.55rem; padding-right: 0.55rem;
}
.task-modal-tab.icon-only i {
  margin: 0;
}
.task-budget-top {
  display: flex; align-items: baseline; justify-content: space-between; gap: 0.75rem; margin-bottom: 0.65rem;
}
.task-budget-label {
  font-size: 0.85rem; font-weight: 800; color: var(--text); letter-spacing: 0.01em;
}
.task-budget-meta {
  display: inline-flex; align-items: baseline; gap: 0.6rem; flex: 0 0 auto;
}
.task-budget-amount {
  font-size: 1.15rem; font-weight: 900; color: var(--success);
}
.task-budget-percent {
  font-size: 0.85rem; font-weight: 800; color: var(--text-secondary);
}
.task-modal-recharge-btn {
  margin-top: 0.85rem; width: 100%; display: inline-flex; align-items: center;
  justify-content: center; gap: 0.5rem; padding: 0.75rem 0.95rem; border-radius: 12px;
  border: 1px solid rgba(16, 185, 129, 0.55);
  background: linear-gradient(180deg, rgba(16, 185, 129, 0.95), rgba(5, 150, 105, 0.95));
  color: #ffffff; font-weight: 900; letter-spacing: 0.01em; cursor: pointer;
  transition: var(--transition); box-shadow: 0 18px 40px rgba(16, 185, 129, 0.18);
}
.task-modal-recharge-btn:hover {
  transform: translateY(-1px); box-shadow: 0 20px 48px rgba(16, 185, 129, 0.24);
}
.task-modal-recharge-btn:active {
  transform: translateY(0);
}
.task-modal-recharge-btn:focus-visible {
  outline: none; box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.22), 0 20px 48px rgba(16, 185, 129, 0.24);
}
.task-modal-breakdown-grid {
  display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 0.75rem; margin-top: 0.75rem;
}
.task-modal-breakdown-item {
  background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: var(--radius);
  padding: 0.85rem 0.9rem;
}
.task-modal-breakdown-item .label {
  font-size: 0.75rem; font-weight: 800; color: var(--text-secondary); margin-bottom: 0.25rem;
  letter-spacing: 0.02em; text-transform: uppercase;
}
.task-modal-breakdown-item .value {
  font-size: 1.05rem; font-weight: 900; color: var(--text);
}
.recharge-modal-container {
  text-align: left; padding-top: 1rem;
}
.recharge-modal-section {
  margin-bottom: 1.5rem;
}
.recharge-modal-label {
  display: block; margin-bottom: 0.75rem; font-weight: 600; color: var(--text); font-size: 1rem;
}
.recharge-preset-amounts {
  display: grid; grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); gap: 0.75rem; margin-bottom: 1rem;
}
.recharge-preset-btn {
  padding: 0.75rem; font-size: 1rem; font-weight: 700; border: 2px solid var(--border);
  background: var(--card); color: var(--primary); border-radius: var(--radius); cursor: pointer;
  transition: var(--transition);
}
.recharge-preset-btn:hover {
  border-color: var(--primary); background: rgba(99, 102, 241, 0.1);
}
.recharge-payment-options {
  display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;
}
.recharge-payment-option {
  padding: 1rem; border: 2px solid var(--border); border-radius: var(--radius); cursor: pointer;
  transition: var(--transition); text-align: center;
}
.recharge-payment-option:hover {
  transform: translateY(-2px); box-shadow: var(--shadow);
}
.recharge-payment-option.selected {
  border-color: var(--primary); background: rgba(99, 102, 241, 0.1);
}
.recharge-payment-option i {
  font-size: 2rem; margin-bottom: 0.5rem; color: var(--primary);
}
.recharge-payment-option .provider-name {
  font-weight: 600; color: var(--text);
}
.recharge-summary {
  background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: var(--radius-lg);
  padding: 1rem; margin-top: 1.5rem;
}
.recharge-summary-item {
  display: flex; justify-content: space-between; padding: 0.5rem 0; font-size: 0.9rem;
}
.swal2-popup.recharge-modal-custom {
  width: 95vw !important; ;
}
.recharge-modal-custom > .swal2-actions > .swal2-cancel {
  background: #df0e0e;
}
.mobile-profile-menu {
  display: none; padding: 0; border-radius: 50%; background: transparent; border: none;
  color: var(--text); cursor: pointer; font-size: 1.25rem; transition: var(--transition); position: relative;
}
.mobile-profile-menu:hover .user-avatar {
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
}
.mobile-profile-menu .user-avatar {
  width: 36px; height: 36px; border-radius: 50%; background: var(--gradient-primary);
  display: flex; align-items: center; justify-content: center; color: white; font-weight: 600;
  font-size: 0.875rem; transition: box-shadow 0.2s ease;
}
.mobile-profile-dropdown {
  display: none; position: fixed; top: 60px; right: 1rem; background: var(--card);
  border-radius: 12px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2); z-index: 10001; overflow: hidden;
  animation: slideDown 0.2s ease; min-width: 280px;
}
.mobile-profile-dropdown.active {
  display: block;
}
@keyframes slideDown {
from {
  opacity: 0; transform: translateY(-10px);
}
to {
  opacity: 1; transform: translateY(0);
}
}
.swal2-popup-custom-task {
  margin: 0 !important; padding: 0 !important;
}
.swal2-popup.task-details-swal {
  margin: 0.5rem !important; width: min(1100px, 96vw) !important; max-width: 96vw !important;
  box-sizing: border-box !important;
}
.task-details-swal .swal2-html-container {
  width: 100% !important; max-width: 100% !important; box-sizing: border-box !important;
}
.swal2-container {
  z-index: 10000 !important;
}
.sessions-modal-custom {
  width: 95vw !important;
}
.sessions-modal-container {
  text-align: left; font-size: 0.9rem;
}
.sessions-section-title {
  font-size: 1.1rem; font-weight: 600; margin: 1.5rem 0 1rem 0; padding-bottom: 0.75rem;
  border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 0.5rem;
}
.sessions-section-title:first-child {
  margin-top: 0;
}
.session-card {
  display: flex; align-items: flex-start; gap: 1rem; background: var(--card);
  border: 1px solid var(--border); border-radius: var(--radius-lg); padding: 1rem; margin-bottom: 1rem;
}
.session-card--current {
  border-left: 4px solid var(--success); background: rgba(16, 185, 129, 0.05);
}
.session-icon {
  font-size: 1.75rem; color: var(--text-secondary); margin-top: 0.25rem;
}
.session-details {
  flex: 1;
}
.session-main-info {
  font-weight: 600; color: var(--text); margin-bottom: 0.5rem;
}
.session-meta-info {
  font-size: 0.8rem; color: var(--text-secondary); display: flex; flex-direction: column; gap: 0.25rem;
}
.session-actions {
  margin-left: auto;
}
.swal2-footer {
  border-top: 1px solid var(--border) !important; margin-top: 1.5rem !important; padding-top: 1.5rem !important;
}
.swal2-popup {
  background: var(--card) !important; color: var(--text) !important; border: none !important;
  border-radius: 1.25rem !important;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2), 0 0 80px rgba(99, 102, 241, 0.1) !important;
}
.swal2-title {
  color: var(--text) !important;
}
.swal2-html-container {
  color: var(--text) !important;
}
.swal2-html-container .card {
  background: var(--bg-tertiary) !important; border-color: var(--border) !important;
}
.swal2-html-container .card-header {
  border-bottom-color: var(--border) !important;
}
.swal2-html-container .card-title {
  color: var(--text) !important;
}
.swal2-html-container .form-label {
  color: var(--text) !important;
}
.swal2-html-container .form-input,
.swal2-html-container .form-select,
.swal2-html-container .form-textarea {
  background: var(--input-bg) !important; color: var(--text) !important; border-color: var(--border) !important;
}
.swal2-html-container code {
  background: var(--bg-tertiary) !important; color: var(--text) !important; border: 1px solid var(--border) !important;
}
.swal2-html-container .empty-state-title {
  color: var(--text) !important;
}
.swal2-html-container .empty-state-description {
  color: var(--text-secondary) !important;
}
.swal2-icon {
  margin: 1rem auto !important; width: 5rem !important; height: 5rem !important; border-width: 3px !important;
}
.swal2-icon.swal2-warning {
  border-color: var(--warning) !important; color: var(--warning) !important;
}
.swal2-icon.swal2-error {
  border-color: var(--error) !important;
}
.swal2-icon.swal2-success {
  border-color: var(--success) !important;
}
.swal2-icon.swal2-info {
  border-color: var(--primary) !important; color: var(--primary) !important;
}
.swal2-title {
  color: var(--text) !important; font-weight: 700 !important; font-size: 1.5rem !important;
  margin-bottom: 0.5rem !important;
}
.swal2-html-container {
  color: var(--text-secondary) !important; font-size: 0.9375rem !important; line-height: 1.6 !important;
}
.swal2-actions {
  gap: 0.75rem !important; margin-top: 1.5rem !important;
}
.swal2-confirm, .swal2-cancel, .swal2-deny {
  padding: 0.75rem 1.5rem !important; border-radius: 0.625rem !important;
  font-weight: 600 !important; font-size: 0.9375rem !important; transition: all 0.3s !important;
  border: none !important;
}
.swal2-confirm {
  background: linear-gradient(135deg, var(--primary) 0%, #764ba2 100%) !important;
  box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3) !important;
}
.swal2-confirm:hover {
  transform: translateY(-2px) !important; box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4) !important;
}
.swal2-cancel {
  background: var(--bg-tertiary) !important; color: var(--text) !important; border: 2px solid var(--border) !important;
}
.swal2-cancel:hover {
  background: var(--bg-secondary) !important; border-color: var(--text-secondary) !important;
}
.swal2-input {
  background: var(--bg-secondary) !important; color: var(--text) !important;
  border: 2px solid var(--border) !important; border-radius: 0.625rem !important;
  padding: 0.75rem !important; font-size: 0.9375rem !important; transition: all 0.3s !important;
}
.swal2-input:focus {
  border-color: var(--primary) !important; box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1) !important;
}
/* Consolidated Media Queries */
@media (min-width: 769px) {
.domain-actions-row {
  flex-direction: row; flex-wrap: nowrap; align-items: center; justify-content: space-between; gap: 0.5rem;
}
.domain-status-row {
  display: flex; flex-direction: row; align-items: center; gap: 0.5rem; flex: 1; min-width: 0; width: auto;
}
.domain-status-row .domain-verify-delete {
  display: none !important;
}
.domain-verify-delete-desktop {
  display: flex !important; align-items: center; gap: 0.5rem; flex-shrink: 0;
}
.domain-buttons-row {
  display: flex; flex-direction: row; align-items: center; gap: 0.5rem; width: auto; flex-shrink: 0;
}
.domain-verify-delete {
  gap: 0.5rem;
}
.collapsible-header {
  cursor: default !important;
}
.swal2-popup.image-details-swal {
  width: min(75vw, 850px) !important; max-width: 75vw !important; padding: 1.25rem !important;
}
.image-hero-preview {
  min-height: 280px; padding: 2rem;
}
.image-hero-img {
  max-height: 250px;
}
.image-stats-grid {
  grid-template-columns: repeat(4, 1fr);
}
.image-analytics-content {
  grid-template-columns: repeat(2, 1fr);
}
.image-chart-card .chart-body {
  height: 200px;
}
.image-traffic-content {
  grid-template-columns: repeat(3, 1fr);
}
.swal2-popup.article-details-swal {
  width: min(75vw, 950px) !important; max-width: 75vw !important; padding: 1.25rem !important;
}
.article-modal-stat-grid {
  grid-template-columns: repeat(4, 1fr);
}
.article-chart-wrap {
  height: 300px;
}
.article-mini-charts-grid {
  grid-template-columns: repeat(3, 1fr);
}
.article-slider-thumb {
  width: 70px; height: 70px;
}
.article-content-body {
  max-height: 420px;
}
}
@media (max-width: 768px) {
.step-content {
  padding: 0.5rem 0;
}
.step-content.active {
  display: flex; flex-direction: column; height: 100%; overflow-y: auto; -webkit-overflow-scrolling: touch;
}
.billing-cycle-options {
  display: flex; gap: 0.75rem; overflow-x: auto; padding: 0.25rem 0 0.5rem;
  scroll-snap-type: x mandatory; -webkit-overflow-scrolling: touch;
}
.billing-cycle-options::-webkit-scrollbar {
  display: none;
}
.billing-cycle-options .billing-option {
  min-width: 80%; max-width: 80%; border-radius: 1rem; padding: 1.25rem; align-items: flex-start;
  justify-content: flex-start; gap: 0.65rem; text-align: left; scroll-snap-align: center;
}
.billing-cycle-options .billing-option-top {
  align-items: flex-start;
}
.billing-cycle-options .billing-price {
  font-size: 0.9rem; margin-top: 0;
}
.billing-cycle-options .billing-note {
  font-size: 0.8rem;
}
.billing-cycle-options .billing-save {
  font-size: 0.7rem; padding: 0.2rem 0.6rem;
}
.billing-cycle-options .billing-badge {
  position: absolute; top: 1rem; right: 1rem; transform: none; font-size: 0.7rem; padding: 0.25rem 0.6rem;
}
.budget-summary {
  grid-template-columns: repeat(3, 1fr); gap: 0.5rem; padding: 0.75rem;
}
.seo-task-creator {
  padding: 0; align-items: stretch;
}
.seo-task-creator::before {
  content: ''; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(4px); z-index: -1;
}
.task-creator-container {
  width: 100vw; max-width: 100vw; height: 100vh; height: 100dvh; max-height: 100vh;
  max-height: 100dvh; border-radius: 0; flex-direction: column; position: fixed; top: 0; left: 0;
  z-index: 1000; transform: translateY(100%);
  transition: transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1); overflow: hidden;
}
.seo-task-creator.active .task-creator-container {
  transform: translateY(0); display: flex;
  animation: slideUpMobileSmooth 0.35s cubic-bezier(0.34, 1.3, 0.64, 1) forwards;
}
@keyframes slideUpMobileSmooth {
0% {
  transform: translateY(100%); opacity: 0;
}
100% {
  transform: translateY(0); opacity: 1;
}
}
.task-creator-sidebar {
  width: 100%; height: auto; min-height: auto; max-height: none; border-right: none;
  border-bottom: 1px solid rgba(148, 163, 184, 0.15); padding: 0.6rem 0.75rem; order: 1; position: relative;
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.08) 0%, rgba(14, 165, 233, 0.04) 100%), var(--bg-secondary);
  z-index: 10; box-shadow: 0 2px 8px rgba(15, 23, 42, 0.05); display: flex; flex-direction: column;
  gap: 0; flex-shrink: 0;
}
.task-creator-main {
  width: 100%; order: 2; flex: 1; display: flex; flex-direction: column; overflow: hidden;
  height: auto; min-height: 0; background: var(--bg-primary); position: relative;
}
.task-creator-header {
  padding: 0.6rem 0.75rem; background: var(--bg-secondary); z-index: 5; flex-shrink: 0;
  display: flex; flex-direction: column; gap: 0.1rem; border-bottom: 1px solid var(--border); position: sticky; top: 0;
}
.task-creator-close {
  position: absolute !important; top: 0.6rem !important; right: 0.65rem !important;
  width: 1.9rem !important; height: 1.9rem !important; font-size: 0.95rem !important;
  flex-shrink: 0; display: flex !important; align-items: center !important;
  justify-content: center !important; z-index: 1010 !important;
  background: var(--bg-primary) !important; border: 1px solid var(--border) !important;
  border-radius: 50% !important; box-shadow: 0 2px 8px rgba(0,0,0,0.1) !important; transition: all 0.2s ease !important;
}
.task-creator-close:active {
  transform: scale(0.95); box-shadow: 0 1px 4px rgba(0,0,0,0.15) !important;
}
.task-creator-title {
  font-size: 0.95rem; font-weight: 700; margin-bottom: 0.1rem; padding-right: 2.5rem;
  color: var(--text); line-height: 1.2;
}
.task-creator-subtitle {
  font-size: 0.65rem; color: var(--text-secondary); display: block; line-height: 1.2;
}
.task-creator-body {
  flex: 1; overflow-y: auto; overflow-x: hidden; padding: 0.6rem;
  -webkit-overflow-scrolling: touch; max-height: calc(100vh - 160px);
}
.progress-steps {
  display: flex; align-items: center; justify-content: space-between; gap: 0.4rem; width: 100%; padding: 0;
}
.progress-step {
  display: flex; flex-direction: column; align-items: center; gap: 0.3rem; flex: 1;
  padding: 0.5rem 0.25rem; border-radius: 0.6rem; transition: all 0.2s ease;
  background: var(--bg-primary); border: 1.5px solid rgba(148, 163, 184, 0.25); position: relative;
  text-align: center; min-width: 0;
}
.progress-step::after {
  content: ''; display: none;
}
.progress-step.completed {
  background: linear-gradient(135deg, rgba(34, 197, 94, 0.08), rgba(16, 185, 129, 0.12));
  border-color: rgba(34, 197, 94, 0.4);
}
.progress-step.active {
  background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); border-color: transparent;
  box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3); color: white;
}
.step-info {
  display: flex; flex-direction: column; align-items: center; gap: 0.2rem; min-width: 0; width: 100%;
}
.step-title {
  font-size: 0.65rem; font-weight: 700; color: var(--text); white-space: nowrap; overflow: hidden;
  text-overflow: ellipsis; width: 100%; line-height: 1;
}
.step-indicator {
  width: 1.5rem; height: 1.5rem; border-radius: 50%; background: rgba(99, 102, 241, 0.1);
  border: 1.5px solid rgba(99, 102, 241, 0.3); display: flex; align-items: center;
  justify-content: center; font-weight: 700; font-size: 0.65rem; color: var(--text);
  transition: all 0.2s ease; flex-shrink: 0;
}
.progress-step.active .step-indicator {
  background: rgba(255, 255, 255, 0.2); border-color: rgba(255, 255, 255, 0.5); color: white;
}
.progress-step.completed .step-indicator {
  background: rgba(34, 197, 94, 0.2); border-color: rgba(34, 197, 94, 0.5); color: #059669;
}
.progress-step.completed .step-indicator::before {
  content: '✓'; position: absolute; font-size: 0.65rem;
}
.progress-step.active .step-title {
  color: rgba(255, 255, 255, 0.95);
}
.progress-step.completed .step-title {
  color: #059669; font-weight: 700;
}
.task-creator-footer {
  padding: 0.6rem 0.75rem; background: var(--bg-secondary); border-top: 1px solid var(--border);
  flex-shrink: 0; display: flex; flex-direction: row; gap: 0.6rem;
  box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.03); position: sticky; bottom: 0; z-index: 10;
}
.footer-actions {
  width: 100%; display: flex; gap: 0.75rem;
}
.task-creator-footer button {
  flex: 1; padding: 0.7rem 0.85rem; font-size: 0.8rem; font-weight: 600; border-radius: 0.6rem;
  display: flex; align-items: center; justify-content: center; gap: 0.4rem; border: none;
  cursor: pointer; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); position: relative;
  overflow: hidden; letter-spacing: 0.01em; min-height: 40px;
}
.task-creator-footer button::before {
  content: ''; position: absolute; top: 50%; left: 50%; width: 0; height: 0; border-radius: 50%;
  background: rgba(255, 255, 255, 0.3); transform: translate(-50%, -50%); transition: width 0.6s ease, height 0.6s ease;
}
.task-creator-footer button:active::before {
  width: 300px; height: 300px;
}
.btn-ghost {
  background: var(--bg-tertiary); border: 2px solid rgba(99, 102, 241, 0.2); color: var(--text);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
}
.btn-ghost:active {
  transform: scale(0.97); box-shadow: 0 1px 4px rgba(0, 0, 0, 0.08); border-color: rgba(99, 102, 241, 0.3);
}
.btn-ghost i {
  transition: transform 0.3s ease;
}
.btn-ghost:active i {
  transform: translateX(-2px);
}
.btn-primary-gradient {
  background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%);
  background-size: 200% 200%; color: white; box-shadow: 0 4px 16px rgba(99, 102, 241, 0.35);
  animation: gradientShift 3s ease infinite;
}
@keyframes gradientShift {
0% { background-position: 0% 50%; }; 50% { background-position: 100% 50%; };
100% { background-position: 0% 50%; };
}
.btn-primary-gradient:active {
  transform: scale(0.97); box-shadow: 0 2px 10px rgba(99, 102, 241, 0.4);
}
.btn-primary-gradient i {
  transition: transform 0.3s ease;
}
.btn-primary-gradient:active i:last-child {
  transform: translateX(3px);
}
.btn-primary-gradient:active i:first-child {
  transform: scale(1.1);
}
.form-group {
  margin-bottom: 0.9rem;
}
.form-label {
  font-size: 0.8rem; font-weight: 600; margin-bottom: 0.4rem;
}
.form-input {
  padding: 0.7rem 0.85rem; font-size: 0.85rem; border-radius: 0.65rem;
}
.priority-options {
  display: grid; grid-template-columns: 1fr; gap: 0.5rem; gap: 0.875rem;
}
.priority-option {
  width: 100%; padding: 1rem; min-height: auto; display: grid; grid-template-columns: 1fr auto;
  align-items: center; gap: 1rem; border-radius: 0.875rem; position: relative; overflow: visible;
}
.priority-option::before {
  display: none;
}
.priority-badge {
  position: absolute; top: -0.5rem; right: 1rem; padding: 0.25rem 0.75rem; font-size: 0.625rem;
  border-radius: 1rem; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); align-self: auto;
}
.priority-option .priority-title {
  font-size: 1rem; margin-bottom: 0.25rem;
}
.priority-option .priority-price {
  font-size: 1.375rem;
}
.priority-option .priority-locations {
  font-size: 0.75rem;
}
.priority-option.selected {
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(99, 102, 241, 0.05) 100%);
  border-color: var(--primary); box-shadow: 0 4px 12px rgba(99, 102, 241, 0.15);
}
.payment-type-toggle {
  margin-bottom: 1.25rem; padding: 0.25rem;
}
.payment-type-option {
  padding: 0.6rem 0.7rem; font-size: 0.8rem;
}
.payment-options {
  grid-template-columns: 1fr 1fr; gap: 0.75rem;
}
.payment-card {
  padding: 0.75rem; display: flex; flex-direction: column; align-items: center;
  justify-content: center; text-align: center; min-height: 90px;
}
.payment-card .payment-icon {
  font-size: 1.75rem; margin-bottom: 0.4rem;
}
.payment-card .payment-title {
  font-size: 0.8rem; font-weight: 600; margin-bottom: 0.2rem; line-height: 1.2;
}
.payment-card .payment-description {
  font-size: 0.65rem; line-height: 1.2;
}
.billing-cycle-options {
  display: flex; flex-direction: column; gap: 0.5rem; margin-bottom: 0.75rem;
}
.billing-cycle-options .billing-option {
  padding: 0.6rem 0.75rem; min-height: auto; max-height: none; height: auto; display: flex;
  flex-direction: row; justify-content: space-between; align-items: center; text-align: left;
  border-radius: 0.7rem; position: relative; gap: 0.6rem; transition: all 0.2s ease;
}
.billing-cycle-options .billing-option-top {
  display: flex; align-items: center; gap: 0.6rem; flex: 1;
}
.billing-cycle-options .billing-icon {
  width: 2rem; height: 2rem; font-size: 0.95rem; border-radius: 0.5rem; flex-shrink: 0;
}
.billing-cycle-options .billing-option-header {
  display: flex; flex-direction: column; align-items: flex-start; gap: 0.1rem; flex: 1;
}
.billing-period {
  font-size: 0.85rem !important; font-weight: 700; color: var(--text); line-height: 1;
}
.billing-frequency {
  font-size: 0.65rem !important; color: var(--text-secondary); display: none;
}
.billing-save {
  font-size: 0.6rem !important; padding: 0.15rem 0.45rem !important; margin: 0;
  display: inline-block; flex-shrink: 0; border-radius: 0.35rem;
}
.billing-price {
  display: none !important;
}
.billing-note {
  display: none !important;
}
.billing-badge {
  display: none;
}
.billing-cycle-options .billing-option.selected {
  background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); border-color: transparent;
  box-shadow: 0 4px 16px rgba(99, 102, 241, 0.35);
}
.billing-cycle-options .billing-option.selected .billing-icon {
  background: rgba(255, 255, 255, 0.2); color: white;
}
.billing-cycle-options .billing-option.selected .billing-period,
.billing-cycle-options .billing-option.selected .billing-frequency {
  color: rgba(255, 255, 255, 0.95);
}
.billing-cycle-options .billing-option.selected .billing-save {
  background: rgba(255, 255, 255, 0.2); color: white;
}
.billing-cycle-options .billing-option.selected::after {
  content: ''; display: none;
}
.budget-calculator {
  padding: 0.75rem; margin-bottom: 0.75rem; border-radius: 0.75rem;
}
.budget-input-group {
  gap: 0.7rem;
}
.budget-field input {
  padding: 0.65rem 0.65rem 0.65rem 2rem; font-size: 1rem; border-radius: 0.65rem;
}
.budget-field .currency-symbol {
  font-size: 1.125rem; left: 0.75rem; bottom: 0.75rem;
}
.budget-summary {
  padding: 0.75rem; gap: 0.5rem; grid-template-columns: repeat(3, 1fr);
}
.budget-summary-label {
  font-size: 0.625rem;
}
.budget-summary-value {
  font-size: 0.875rem;
}
.keyword-suggestions {
  gap: 0.45rem; margin-bottom: 0.7rem;
}
.keyword-suggestion {
  padding: 0.5rem 0.75rem; font-size: 0.75rem; border-radius: 0.6rem;
}
.selected-keywords {
  padding: 0.65rem; margin-bottom: 0.7rem; border-radius: 0.65rem;
}
.keyword-tags {
  gap: 0.35rem;
}
.keyword-tag {
  padding: 0.35rem 0.55rem; font-size: 0.7rem; border-radius: 0.45rem;
}
.pending-task-alert {
  margin-bottom: 0.7rem; padding: 0.7rem; border-radius: 0.65rem;
}
.pending-task-icon {
  width: 2rem; height: 2rem; font-size: 1rem;
}
.pending-task-title {
  font-size: 0.85rem; font-weight: 600;
}
.pending-task-details {
  padding: 0.65rem; margin-bottom: 0.65rem; border-radius: 0.6rem;
}
.pending-task-actions {
  gap: 0.65rem;
}
.pending-task-actions .btn {
  padding: 0.7rem; font-size: 0.8rem; border-radius: 0.6rem;
}
.sidebar {
  display: none;
}
.mobile-nav {
  display: block;
}
.main-content {
  padding-bottom: 60px;
}
.header {
  padding: 0.75rem; position: sticky; top: 0; z-index: 100; background: var(--bg-secondary);
}
.search-bar {
  display: none;
}
.mobile-search-toggle {
  display: block; padding: 0.5rem; background: transparent; border: none; color: var(--text);
  font-size: 1.25rem; cursor: pointer;
}
.user-dropdown {
  position: fixed; top: auto; bottom: 0; left: 0; right: 0; min-width: 100%;
  border-radius: var(--radius-lg) var(--radius-lg) 0 0; max-height: 50vh; overflow-y: auto;
}
.user-dropdown-header {
  display: none;
}
.user-menu {
  padding: 0.5rem; gap: 0.5rem;
}
.user-menu > div {
  display: none;
}
.header-left {
  flex: 1;
}
.header-right {
  gap: 0.5rem;
}
.stats-grid {
  grid-template-columns: repeat(2, 1fr); gap: 0.75rem;
}
.stat-card {
  padding: 0.875rem;
}
.stat-card .stat-value {
  font-size: 1.5rem;
}
.stat-card .stat-label {
  font-size: 0.75rem;
}
.task-grid {
  grid-template-columns: 1fr; gap: 1rem; padding: 0; margin: 0;
}
.task-card {
  position: relative; width: 100%; max-width: 100%; padding: 1rem; margin: 0;
  box-sizing: border-box; overflow: hidden; word-wrap: break-word;
}
.task-header {
  flex-direction: row; align-items: flex-start; gap: 0.5rem; margin-bottom: 0.75rem; padding-right: 3rem; ;
}
.task-url-wrapper {
  flex: 1; min-width: 0; max-width: calc(100% - 5rem); ;
}
.task-url {
  font-size: 0.9rem; line-height: 1.4; word-break: break-word; overflow-wrap: break-word;
  max-width: 100%; display: inline-flex; flex-wrap: wrap;
}
.task-url i {
  font-size: 0.8rem;
}
.task-date {
  font-size: 0.7rem; margin-top: 0.2rem;
}
.task-status {
  align-self: flex-start; flex-shrink: 0; font-size: 0.7rem; padding: 0.2rem 0.6rem;
}
.task-stats {
  grid-template-columns: repeat(2, 1fr); gap: 0.75rem; margin: 0.75rem 0;
}
.task-stat-label {
  font-size: 0.7rem;
}
.task-stat-value {
  font-size: 1rem;
}
.task-progress {
  margin: 0.75rem 0;
}
.task-actions {
  flex-direction: row; flex-wrap: wrap; gap: 0.5rem; margin-top: 0.75rem; width: 100%;
}
.task-actions button {
  flex: 1 1 calc(50% - 0.25rem); width: auto; justify-content: center; padding: 0.625rem 1rem; font-size: 0.875rem;
}
.task-actions .btn-sm {
  width: auto;
}
.task-actions button:only-child {
  flex-basis: 100%;
}
.btn-delete-task-desktop {
  display: none !important;
}
.btn-delete-task-mobile {
  display: inline-flex; position: absolute; top: 0.75rem; right: 0.75rem; z-index: 2;
  width: 2.25rem; height: 2.25rem; padding: 0 !important; border-radius: 999px;
  background: rgba(230, 57, 70, 0.12) !important; color: var(--danger) !important;
  border: 1px solid rgba(230, 57, 70, 0.25); align-items: center; justify-content: center; gap: 0;
}
.btn-delete-task-mobile:hover {
  background: rgba(230, 57, 70, 0.18) !important; transform: none; box-shadow: none;
}
.btn-delete-task-mobile i {
  font-size: 1.05rem;
}
.task-actions.task-actions-delete-only {
  display: none;
}
.media-grid {
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
}
.search-bar {
  width: 200px;
}
.header {
  padding: 1rem;
}
.content {
  padding: 1rem;
}
.modal {
  width: 95%; max-height: 85vh;
}
.priority-options {
  grid-template-columns: 1fr;
}
.chart-container {
  height: 200px !important;
}
.map-container {
  height: 250px !important;
}
.analytics-grid,
div[style*="grid-template-columns: 1fr 1fr"] {
  grid-template-columns: 1fr !important; gap: 1rem !important;
}
.card {
  min-width: 100%;
}
.table-container {
  overflow-x: auto; -webkit-overflow-scrolling: touch;
}
table {
  min-width: 600px;
}
.modal {
  width: 100%; max-width: 100%; margin: 0; height: 100vh; max-height: 100vh; border-radius: 0;
}
.modal-body {
  max-height: calc(100vh - 60px);
}
.domains-usage-container {
  flex-direction: column !important; gap: 1rem !important;
}
.domains-usage-container .card {
  flex: 1 !important; max-width: 100% !important;
}
.seo-task-creator.active .task-creator-container {
  animation: slideUpMobile 0.3s ease forwards !important;
}
@keyframes slideUpMobile {
from {
  transform: translateY(100%); opacity: 0;
}
to {
  transform: translateY(0); opacity: 1;
}
}
.step-content {
  animation: fadeIn 0.2s ease !important;
}
.task-creator-close:active {
  transform: scale(0.95) !important; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2) !important;
}
.progress-step.active .step-indicator {
  animation: pulseGlow 2s infinite;
}
.collapsible-header {
  user-select: none;
}
.collapsible-header #domainsContentIcon,
.collapsible-header #usageContentIcon {
  display: inline-block !important;
}
.collapsible-content {
  max-height: 1000px; overflow: hidden; transition: max-height 0.3s ease, padding 0.3s ease;
}
.collapsible-content.collapsed {
  max-height: 0 !important; padding-top: 0 !important; padding-bottom: 0 !important; border-top: none !important;
}
.usage-category {
  padding: 0.75rem; background: var(--bg-secondary); border-radius: var(--radius-sm);
}
.desktop-only {
  display: none !important;
}
.mobile-only {
  display: block !important;
}
.image-info-bar {
  flex-direction: column; align-items: stretch; gap: 0.75rem;
}
.image-actions-bar {
  justify-content: flex-start;
}
.image-stats-grid {
  grid-template-columns: repeat(4, 1fr); gap: 0.5rem;
}
.image-stat-card {
  padding: 0.7rem 0.35rem;
}
.image-stat-card .stat-value {
  font-size: 1.15rem;
}
.image-stat-card .stat-label {
  font-size: 0.6rem;
}
.image-hero-preview {
  min-height: 180px; padding: 1rem;
}
.image-hero-img {
  max-height: 160px;
}
.image-chart-card .chart-body {
  height: 160px;
}
.image-traffic-content {
  grid-template-columns: repeat(2, 1fr);
}
.article-modal-actions-desktop {
  display: none;
}
.article-modal-actions-mobile {
  display: flex; gap: 0.35rem; flex-shrink: 0;
}
.article-modal-actions-mobile .btn {
  padding: 0.3rem 0.5rem; font-size: 0.75rem;
}
.article-modal-header-row {
  flex-direction: column; align-items: stretch; gap: 0.5rem;
}
.article-modal-stat-grid {
  grid-template-columns: repeat(2, 1fr);
}
.article-modal-tabs { width: 100%; }
.article-modal-tab .label-mobile,
.article-modal-tab .label-desktop { display: none !important; }
.article-modal-tab { padding-left: 0.55rem !important; padding-right: 0.55rem !important; }
.article-modal-tab i { margin: 0 !important; }
.article-mini-charts-grid {
  grid-template-columns: 1fr;
}
.article-chart-wrap {
  height: 220px;
}
.article-mini-chart-card .chart-body {
  height: 140px;
}
.article-image-slider {
  min-height: 180px; padding: 0.75rem; display: flex; flex-direction: row; align-items: center;
  justify-content: center; gap: 0.5rem;
}
.article-slider-image {
  max-height: 160px; flex: 1; min-width: 0; object-fit: contain;
}
.article-slider-nav {
  position: static !important; transform: none !important; width: 34px !important;
  height: 34px !important; min-width: 34px !important; max-width: 34px !important;
  font-size: 0.9rem; opacity: 0.9; background: var(--card); border: 1px solid var(--border);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); flex-shrink: 0;
}
.article-slider-nav:hover {
  transform: none !important;
}
.article-slider-thumb {
  width: 50px; height: 50px;
}
.article-content-info {
  grid-template-columns: repeat(3, 1fr);
}
.article-content-body {
  max-height: 280px; padding: 1rem; font-size: 0.9rem;
}
.analytics-mobile-switch {
  display: flex;
}
.task-modal-grid .analytics-section > .task-modal-section-title,
.task-modal-grid .map-section > .task-modal-section-title {
  display: none;
}
.task-modal-grid .analytics-section,
.task-modal-grid .map-section {
  display: none !important;
}
.task-modal-grid .analytics-section.active,
.task-modal-grid .map-section.active {
  display: block !important;
}
.task-modal-tabs { width: 100%; }
.task-modal-tab .label-mobile,
.task-modal-tab .label-desktop {
  display: none !important;
}
.task-modal-tab {
  padding-left: 0.55rem !important; padding-right: 0.55rem !important;
}
.task-modal-tab i {
  margin: 0 !important;
}
.task-modal-header-row {
  flex-direction: column; align-items: stretch; gap: 0.75rem;
}
.task-modal-actions-slot {
  justify-content: flex-start;
}
.task-modal-actions-slot .swal2-actions {
  width: 100% !important; justify-content: stretch !important;
}
.task-modal-actions-slot .swal2-actions button {
  flex: 1 1 auto !important; width: 100% !important; padding: 0.65rem 0.85rem !important; font-size: 0.9rem !important;
}
.task-modal-header h3 {
  font-size: 1rem !important; word-break: break-all; line-height: 1.3;
}
.task-modal-header .header-meta {
  font-size: 0.7rem !important; flex-direction: column; gap: 0.5rem !important;
}
.task-modal-header .header-meta .header-meta-left {
  flex-direction: column; gap: 0.25rem !important;
}
.task-modal-header .header-meta .header-meta-left .task-verify-inline-btn {
  width: auto !important; max-width: none !important; padding: 0.4rem 0.85rem !important; font-size: 0.8rem !important;
}
.task-modal-header .header-meta .header-meta-right {
  width: 100%; justify-content: stretch;
}
.task-config-btn {
  width: 100% !important; justify-content: center !important; padding: 0.65rem 0.9rem !important;
}
.task-modal-stat-grid {
  grid-template-columns: repeat(2, 1fr) !important; gap: 0.5rem !important; margin-bottom: 1rem !important;
}
.task-modal-stat-card {
  padding: 0.75rem !important;
}
.task-modal-stat-card .stat-value {
  font-size: 1.25rem !important;
}
.task-modal-stat-card .stat-label {
  font-size: 0.7rem !important;
}
.task-modal-grid {
  grid-template-columns: 1fr !important; gap: 1rem !important;
}
.task-modal-section {
  padding: 0.875rem !important;
}
.task-modal-section-title {
  font-size: 0.95rem !important; margin-bottom: 0.75rem !important; padding-bottom: 0.5rem !important;
}
.task-modal-section canvas {
  max-height: 180px !important;
}
.task-modal-mini-chart {
  height: 160px;
}
.install-instructions {
  padding: 0.75rem !important; font-size: 0.8rem !important;
}
.install-instructions code {
  padding: 0.5rem !important; font-size: 0.7rem !important;
}
.copy-btn {
  padding: 0.35rem 0.6rem !important; font-size: 0.75rem !important;
}
.task-modal-chart-wrap { height: 190px; }
.task-modal-map { height: 260px; }
.task-done-table { display: block; }
.task-done-table thead { display: none; }
.task-done-table tbody { display: block; }
.task-done-table tbody tr {
  display: flex; flex-direction: column; gap: 0.5rem; padding: 0.8rem 0.85rem;
  border-bottom: 1px solid var(--border); background: rgba(255, 255, 255, 0.01);
}
.task-done-table tbody tr:last-child { border-bottom: none; }
.task-done-table tbody td {
  padding: 0 !important; border: none !important; min-width: 0;
}
.task-done-table tbody td:nth-child(1) { display: none; }
.task-done-table tbody td:nth-child(3) { order: 1; }
.task-done-table tbody td:nth-child(2) { order: 2; }
.task-done-table tbody td:nth-child(4) { order: 3; }
.task-done-table tbody td:nth-child(3) {
  font-weight: 900; font-size: 0.95rem; line-height: 1.25; word-break: break-word;
}
.task-done-table tbody td:nth-child(2) {
  display: flex; align-items: center; justify-content: space-between; gap: 0.75rem; min-width: 0;
}
.task-done-table tbody td:nth-child(2)::before {
  content: "Country"; color: var(--text-secondary); font-weight: 900; font-size: 0.78rem;
  letter-spacing: 0.02em; text-transform: uppercase; flex: 0 0 auto;
}
.task-done-table tbody td:nth-child(2) .country-badge {
  flex: 1 1 auto; min-width: 0; max-width: 100%; justify-content: flex-start;
}
.task-done-table tbody td:nth-child(4) {
  display: flex; align-items: flex-start; justify-content: space-between; gap: 0.75rem;
  color: var(--text-secondary); font-weight: 800; font-size: 0.82rem; min-width: 0;
}
.task-done-table tbody td:nth-child(4)::before {
  content: "Done"; color: var(--text-secondary); font-weight: 900; font-size: 0.78rem;
  letter-spacing: 0.02em; text-transform: uppercase; flex: 0 0 auto;
}
.task-done-table tbody td:nth-child(4) > div:first-child {
  min-width: 0; text-align: right; word-break: break-word;
}
.task-done-table tbody td:nth-child(4) .muted { display: none; }
.swal2-icon {
  width: 4rem !important; height: 4rem !important;
}
.swal2-title {
  font-size: 1.25rem !important;
}
.swal2-html-container {
  font-size: 0.875rem !important;
}
.swal2-actions {
  flex-direction: column !important; gap: 0.5rem !important;
}
.swal2-confirm, .swal2-cancel {
  width: 100% !important; margin: 0 !important;
}
.swal2-popup {
  max-height: 95vh !important; width: calc(100vw - 1rem) !important; max-width: 100vw !important;
  margin: 0.5rem !important; padding: 1rem !important; border-radius: 1rem !important;
  padding-top: 2.5rem !important; box-sizing: border-box !important; overflow: hidden !important;
}
.swal2-html-container {
  max-height: calc(95vh - 120px) !important; overflow-y: auto !important;
  overflow-x: hidden !important; padding: 0.75rem !important; padding-bottom: 1.5rem !important;
  width: 100% !important; max-width: 100% !important; box-sizing: border-box !important;
  word-wrap: break-word !important; word-break: break-word !important; -webkit-overflow-scrolling: touch !important;
}
.swal2-html-container * {
  max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;
  overflow-wrap: break-word !important;
}
.swal2-html-container img,
.swal2-html-container canvas,
.swal2-html-container video {
  max-width: 100% !important; height: auto !important; object-fit: contain !important;
}
.swal2-html-container table {
  display: block !important; width: 100% !important; overflow-x: auto !important;
  -webkit-overflow-scrolling: touch !important;
}
.swal2-html-container pre,
.swal2-html-container code {
  white-space: pre-wrap !important; word-wrap: break-word !important;
  overflow-wrap: break-word !important; max-width: 100% !important;
}
.swal2-toast button:where(.swal2-close) {
  position: absolute !important; top: 0.5rem !important; right: 0.5rem !important;
  grid-column: unset !important; grid-row: unset !important; font-size: 2em !important; z-index: 2 !important;
}
.swal2-html-container {
  position: relative !important;
}
.swal2-html-container button:where(.swal2-close) {
  position: absolute !important; top: -2.5rem !important; right: -0.5rem !important; z-index: 10 !important;
}
.swal2-html-container .card-body {
  padding: 0.75rem !important; max-height: none !important; width: 100% !important;
  box-sizing: border-box !important; overflow-x: hidden !important;
}
.swal2-html-container .card {
  width: 100% !important; max-width: 100% !important; box-sizing: border-box !important; margin: 0 0 1rem 0 !important;
}
.swal2-html-container .form-group,
.swal2-html-container .form-row,
.swal2-html-container .row {
  width: 100% !important; max-width: 100% !important; box-sizing: border-box !important;
  margin-left: 0 !important; margin-right: 0 !important;
}
.swal2-html-container .form-input,
.swal2-html-container .form-select,
.swal2-html-container .form-textarea,
.swal2-html-container input,
.swal2-html-container select,
.swal2-html-container textarea {
  width: 100% !important; max-width: 100% !important; box-sizing: border-box !important;
}
.swal2-html-container .btn,
.swal2-html-container button {
  max-width: 100% !important; box-sizing: border-box !important; white-space: normal !important;
  word-wrap: break-word !important;
}
.swal2-html-container .task-done-pager .task-done-page-btn,
.swal2-html-container .task-modal-tabs .task-modal-tab {
  width: auto !important; max-width: none !important;
}
.swal2-html-container .task-done-pager .task-done-page-btn {
  display: inline-flex !important; white-space: nowrap !important; flex: 0 0 auto !important;
  padding: 0.3rem 0.5rem !important; font-size: 0.72rem !important; min-width: 28px !important; height: 28px !important; gap: 0.2rem !important;
}
.swal2-html-container .task-done-pager .task-done-page-btn.nav { min-width: auto !important; padding: 0.3rem 0.45rem !important; }
.swal2-html-container .task-done-pager .task-done-page-btn.nav span { display: none !important; }
.swal2-html-container .task-done-pager .pages { flex: 1 !important; min-width: 0 !important; padding: 0 0.25rem !important; justify-content: center !important; gap: 0.2rem !important; }
.swal2-html-container .task-done-pager .pages .task-done-page-btn.page { flex: 1 1 auto !important; max-width: 40px !important; }
.swal2-html-container [class*="grid"], .swal2-html-container [class*="flex"] { max-width: 100% !important; overflow-x: hidden !important; }
.swal2-html-container [style*="grid-template-columns"], .swal2-html-container [style*="display: grid"] { grid-template-columns: 1fr !important; gap: 0.75rem !important; }
.swal2-html-container [style*="display: flex"] { flex-wrap: wrap !important; }
.swal2-html-container > * { max-width: 100% !important; overflow-x: hidden !important; }
#aiKeywordsBtn { white-space: nowrap !important; flex-shrink: 0 !important; padding: 0.5rem 0.75rem !important; font-size: 0.85rem !important; }
#aiKeywordsBtn i { margin-right: 0.25rem !important; }
#taskBudget { font-size: 1.1rem !important; font-weight: 600 !important; padding: 0.75rem 1rem 0.75rem 2.25rem !important; }
.card-body > div[style*="grid-template-columns"], #current-images-container { grid-template-columns: repeat(2, 1fr) !important; gap: 0.75rem !important; }
#cancelPreviousContainer { padding: 1rem !important; margin-bottom: 1rem !important; }
#cancelPreviousContainer label { font-size: 0.85rem !important; line-height: 1.4 !important; }
#previousTasksWarning { font-size: 0.8rem !important; padding: 0.65rem !important; }
.swal2-html-container canvas { max-height: 200px !important; }
.chart-container { height: 250px !important; margin-bottom: 1rem; }
.stat-card .stat-value { font-size: 1.5rem !important; }
.stat-card .stat-label { font-size: 0.75rem !important; }
.card { margin-bottom: 1rem; }
.btn {
  padding: 0.5rem 1rem; font-size: 0.875rem;
}
.btn-sm {
  padding: 0.375rem 0.75rem; font-size: 0.8rem;
}
.table-responsive {
  font-size: 0.8rem;
}
.modal-analytics-grid {
  grid-template-columns: 1fr !important; gap: 1rem !important;
}
.stat-card-grid {
  grid-template-columns: repeat(2, 1fr) !important; gap: 0.5rem !important;
}
.swal2-title {
  font-size: 1.1rem !important; padding: 0.5rem 0 !important;
}
.swal2-actions {
  flex-wrap: wrap !important; gap: 0.5rem !important;
}
.swal2-actions button {
  font-size: 0.85rem !important; padding: 0.5rem 1rem !important; margin: 0 !important;
}
}
@media (max-width: 580px) {
.mobilearticle1 {
  flex-direction: column !important; align-items: flex-start !important; gap: 14px!important;
}
.mobilearticle2{
  align-items: flex-start !important; gap: 14px!important;
}
.domains-usage-container {
  flex-direction: column-reverse !important; gap: 1rem !important;
}
.domain-item {
  padding: 0.875rem !important; gap: 0.75rem !important;
}
.domain-url-row {
  padding-bottom: 0.625rem !important;
}
.domain-url-text {
  font-size: 0.9rem !important;
}
.domain-actions-row {
  display: flex !important; flex-direction: column !important; align-items: stretch !important;
  gap: 0.75rem !important; width: 100% !important;
}
.domain-status-row {
  display: flex !important; flex-direction: row !important; align-items: center !important;
  justify-content: space-between !important; gap: 0.5rem !important; width: 100% !important;
}
.domain-status-badge {
  font-size: 0.75rem !important; padding: 0.35rem 0.65rem !important; flex-shrink: 0 !important;
}
.domain-verify-delete-desktop {
  display: none !important;
}
.domain-status-row .domain-verify-delete {
  display: flex !important; align-items: center !important; gap: 0.4rem !important;
  flex-shrink: 0 !important; margin-left: auto !important;
}
.domain-buttons-row {
  display: flex !important; flex-direction: row !important; align-items: center !important;
  gap: 0.5rem !important; width: 100% !important;
}
.btn-verify-instructions {
  padding: 0.4rem 0.6rem !important; font-size: 0.75rem !important; min-height: 32px !important;
  flex-shrink: 0 !important; flex: 1 !important;
}
.btn-verify-domain {
  padding: 0.4rem 0.6rem !important; font-size: 0.75rem !important; min-height: 32px !important;
  flex-shrink: 0 !important; flex: 1 !important;
}
.btn-delete-domain {
  padding: 0.4rem 0.6rem !important; font-size: 0.75rem !important; min-height: 32px !important;
  flex-shrink: 0 !important;
}
.btn-delete-text {
  display: inline !important;
}
.domain-actions-row .btn i {
  font-size: 0.95rem !important; margin-right: 0.3rem !important;
}
.logo {
  color: white !important;
}
.user-menu-container {
  display: none!important;
}
.usage-category {
  padding: 0.5rem !important; background: var(--bg-secondary) !important;
}
.usage-category i {
  font-size: 1rem !important;
}
}
@media (max-width: 480px) {
.task-creator-sidebar {
  padding: 0.5rem 0.65rem; min-height: auto; max-height: none;
}
.progress-steps {
  padding: 0; gap: 0.35rem;
}
.progress-step {
  padding: 0.45rem 0.2rem; border-radius: 0.55rem; border-width: 1.5px;
}
.step-indicator {
  width: 1.35rem; height: 1.35rem; font-size: 0.6rem; border-width: 1.5px;
}
.step-title {
  font-size: 0.6rem; font-weight: 700;
}
.step-description {
  display: none !important;
}
.task-creator-header {
  padding: 0.65rem 0.75rem; gap: 0.1rem;
}
.task-creator-close {
  position: absolute !important; top: 0.65rem !important; right: 0.65rem !important;
  width: 1.9rem !important; height: 1.9rem !important; font-size: 0.95rem !important;
  z-index: 1010; flex-shrink: 0; display: flex !important; align-items: center !important;
  justify-content: center !important; background: white !important;
  border: 1px solid var(--border) !important; border-radius: 50% !important; box-shadow: 0 2px 4px rgba(0,0,0,0.08);
}
.task-creator-title {
  font-size: 0.9rem; font-weight: 700;
}
.task-creator-subtitle {
  font-size: 0.65rem; line-height: 1.3;
}
.task-creator-body {
  padding: 0.65rem; max-height: calc(100vh - 260px);
}
.form-group {
  margin-bottom: 0.65rem;
}
.form-label {
  margin-bottom: 0.35rem !important; font-size: 0.8rem !important; font-weight: 600; line-height: 1.2;
}
.form-input {
  padding: 0.6rem 0.75rem; font-size: 0.8rem; border-radius: 0.6rem;
}
.payment-type-toggle {
  margin-bottom: 0.55rem; display: flex; gap: 0.4rem; padding: 0.25rem;
  background: var(--bg-tertiary); border-radius: 0.6rem;
}
.payment-type-option {
  flex: 1; padding: 0.55rem 0.65rem; font-size: 0.75rem; border-radius: 0.45rem; display: flex;
  align-items: center; justify-content: center; gap: 0.35rem;
}
.payment-type-option i {
  font-size: 0.85rem;
}
.task-creator-footer {
  padding: 0.55rem 0.65rem; gap: 0.55rem;
}
.task-creator-main {
  height: auto; min-height: 0;
}
.footer-info {
  display: none !important;
}
.task-creator-footer button {
  padding: 0.6rem 0.7rem; font-size: 0.75rem; border-radius: 0.55rem; min-height: 38px;
}
.footer-actions {
  gap: 0.65rem; width: 100%;
}
.form-group {
  margin-bottom: 0.6rem;
}
.priority-options {
  gap: 0.6rem; display: flex; flex-direction: column;
}
.priority-option {
  padding: 0.6rem 0.7rem; border-radius: 0.6rem; display: flex; flex-direction: row;
  align-items: center; justify-content: space-between; gap: 0.6rem; transition: all 0.2s ease; min-height: 52px;
}
.priority-option:active {
  transform: scale(0.98);
}
.priority-option .priority-title {
  font-size: 0.8rem; font-weight: 600; line-height: 1.2; margin-bottom: 0.15rem;
}
.priority-option .priority-price {
  font-size: 0.85rem; font-weight: 700; line-height: 1;
}
.priority-option .priority-locations {
  font-size: 0.65rem; line-height: 1.2;
}
.priority-badge {
  font-size: 0.55rem; padding: 0.18rem 0.45rem; position: absolute; top: 0.4rem; right: 0.4rem; line-height: 1;
}
.payment-type-toggle {
  margin-bottom: 1rem;
}
.payment-options {
  gap: 0.6rem; grid-template-columns: 1fr 1fr; margin-bottom: 0.85rem;
}
.payment-card {
  padding: 0.6rem; min-height: 75px; border-radius: 0.65rem; display: flex; flex-direction: column;
  align-items: center; justify-content: center; transition: all 0.2s ease;
}
.payment-card:active {
  transform: scale(0.98);
}
.payment-card .payment-icon {
  font-size: 1.5rem; margin-bottom: 0.3rem;
}
.payment-card .payment-title {
  font-size: 0.75rem; font-weight: 600; line-height: 1.2;
}
.payment-card .payment-description {
  font-size: 0.6rem; margin-top: 0.15rem; opacity: 0.85; line-height: 1.2;
}
.billing-cycle-options {
  gap: 0.45rem; margin-bottom: 0.6rem;
}
.billing-cycle-options .billing-option {
  padding: 0.55rem 0.65rem; border-radius: 0.6rem; gap: 0.5rem; min-height: 48px;
}
.billing-cycle-options .billing-option:active {
  transform: scale(0.98);
}
.billing-cycle-options .billing-option-top {
  gap: 0.5rem;
}
.billing-cycle-options .billing-icon {
  width: 1.85rem; height: 1.85rem; font-size: 0.9rem; border-radius: 0.5rem;
}
.billing-cycle-options .billing-period {
  font-size: 0.8rem !important;
}
.billing-cycle-options .billing-frequency {
  display: none !important;
}
.billing-cycle-options .billing-save {
  font-size: 0.55rem !important; padding: 0.15rem 0.4rem !important; border-radius: 0.3rem;
}
.billing-cycle-options .billing-badge {
  display: none !important;
}
.budget-calculator {
  padding: 0.6rem; border-radius: 0.65rem; margin-bottom: 0.65rem;
}
.budget-field input {
  font-size: 0.9rem; padding: 0.55rem 0.55rem 0.55rem 1.85rem; border-radius: 0.6rem;
}
.budget-field .currency-symbol {
  font-size: 0.9rem; left: 0.6rem; bottom: 0.55rem;
}
.budget-summary {
  padding: 0.55rem; grid-template-columns: repeat(3, 1fr); gap: 0.4rem;
}
.budget-summary-value {
  font-size: 0.7rem;
}
.budget-summary-item {
  padding: 0.5rem;
}
.keyword-suggestion {
  padding: 0.3rem 0.6rem; font-size: 0.7rem; border-radius: 0.5rem;
}
.selected-keywords {
  padding: 0.6rem; margin-bottom: 0.6rem;
}
.keyword-tag {
  padding: 0.275rem 0.45rem; font-size: 0.65rem; border-radius: 0.4rem;
}
.pending-task-alert {
  padding: 0.7rem; margin-bottom: 0.6rem;
}
.pending-task-icon {
  width: 1.75rem; height: 1.75rem; font-size: 0.9rem;
}
.pending-task-title {
  font-size: 0.8rem; line-height: 1.2;
}
.pending-task-actions .btn {
  padding: 0.55rem; font-size: 0.7rem;
}
body, html {
  overflow-x: hidden !important; max-width: 100vw !important;
}
.content, .main-content, .container {
  max-width: 100% !important; overflow-x: hidden !important; box-sizing: border-box !important;
}
.task-card {
  padding: 0.875rem !important; margin: 0 !important;
}
.task-header {
  gap: 0.4rem !important; margin-bottom: 0.625rem !important;
}
.task-url-wrapper {
  max-width: calc(100% - 4.5rem) !important;
}
.task-url {
  font-size: 0.85rem !important;
}
.task-url i {
  font-size: 0.75rem !important;
}
.task-date {
  font-size: 0.65rem !important;
}
.task-status {
  font-size: 0.65rem !important; padding: 0.15rem 0.5rem !important;
}
.task-stats {
  gap: 0.5rem !important; margin: 0.625rem 0 !important;
}
.task-stat-label {
  font-size: 0.65rem !important;
}
.task-stat-value {
  font-size: 0.9rem !important;
}
.task-actions {
  gap: 0.4rem !important; margin-top: 0.625rem !important;
}
.task-actions button {
  padding: 0.5rem 0.875rem !important; font-size: 0.8rem !important;
}
.stats-grid {
  grid-template-columns: repeat(2, 1fr); gap: 0.5rem;
}
.stat-card {
  padding: 0.75rem;
}
.stat-card .stat-value {
  font-size: 1.25rem;
}
.stat-card .stat-label {
  font-size: 0.7rem;
}
.card-header {
  padding: 1rem;
}
.card-body {
  padding: 1rem;
}
.btn {
  padding: 0.5rem 1rem; font-size: 0.8125rem;
}
.table-container {
  font-size: 0.8125rem;
}
th, td {
  padding: 0.5rem;
}
.media-grid {
  grid-template-columns: 1fr;
}
.header {
  position: sticky; top: 0; background: var(--bg-secondary); z-index: 100; border-bottom: 1px solid var(--border);
}
.mobile-nav-item span {
  font-size: 0.625rem;
}
.mobile-nav-item i {
  font-size: 1.125rem;
}
.pagination-info {
  display: none;
}
.user-menu {
  background: transparent; padding: 0.375rem;
}
.user-avatar {
  width: 28px; height: 28px; font-size: 0.875rem;
}
.image-details-modal-container {
  gap: 0.85rem;
}
.image-hero-section {
  gap: 0.75rem; padding-bottom: 0.85rem;
}
.image-hero-preview {
  min-height: 150px; padding: 0.85rem;
}
.image-hero-img {
  max-height: 130px;
}
.image-filename {
  font-size: 0.9rem;
}
.image-meta-row {
  font-size: 0.75rem; gap: 0.35rem 0.65rem;
}
.image-action-btn {
  padding: 0.45rem 0.65rem; font-size: 0.75rem;
}
.image-action-btn span {
  display: none;
}
.image-stats-grid {
  display: flex; flex-wrap: nowrap; overflow-x: auto; -webkit-overflow-scrolling: touch;
  gap: 0.5rem; padding-bottom: 0.5rem; scroll-snap-type: x mandatory;
}
.image-stats-grid::-webkit-scrollbar {
  height: 4px;
}
.image-stats-grid::-webkit-scrollbar-track {
  background: var(--bg-tertiary); border-radius: 2px;
}
.image-stats-grid::-webkit-scrollbar-thumb {
  background: var(--border); border-radius: 2px;
}
.image-stat-card {
  flex: 0 0 auto; padding: 0.65rem 0.5rem; scroll-snap-align: start;
}
.image-stat-card .stat-value {
  font-size: 1.1rem;
}
.image-modal-tabs {
  max-width: 100%;
}
.image-modal-tab {
  font-size: 0.8rem; padding: 0.45rem 0.85rem;
}
.image-chart-card .chart-body {
  height: 140px; padding: 0.5rem;
}
.image-traffic-content {
  grid-template-columns: 1fr;
}
.image-traffic-item {
  padding: 0.45rem 0.6rem;
}
.image-traffic-item .item-name {
  font-size: 0.8rem;
}
.article-modal-stat-grid {
  display: flex; flex-wrap: nowrap; overflow-x: auto; -webkit-overflow-scrolling: touch;
  gap: 0.5rem; padding-bottom: 0.5rem; scroll-snap-type: x mandatory;
}
.article-modal-stat-grid::-webkit-scrollbar {
  height: 4px;
}
.article-modal-stat-grid::-webkit-scrollbar-track {
  background: var(--bg-tertiary); border-radius: 2px;
}
.article-modal-stat-grid::-webkit-scrollbar-thumb {
  background: var(--border); border-radius: 2px;
}
.article-modal-stat-card {
  flex: 0 0 auto; padding: 0.65rem 0.5rem; scroll-snap-align: start;
}
.article-modal-stat-card .stat-value {
  font-size: 1.1rem;
}
.article-modal-stat-card .stat-label {
  font-size: 0.65rem;
}
.article-header-meta {
  gap: 0.5rem; font-size: 0.75rem;
}
.article-image-slider {
  min-height: 140px; padding: 0.5rem; gap: 0.35rem;
}
.article-slider-image {
  max-height: 130px;
}
.article-slider-nav {
  width: 30px !important; height: 30px !important; min-width: 30px !important;
  max-width: 30px !important; font-size: 0.8rem;
}
.article-content-info-card {
  padding: 0.65rem;
}
.article-content-info-card .info-value {
  font-size: 0.95rem;
}
.article-content-body {
  max-height: 240px; font-size: 0.85rem; line-height: 1.7;
}
.swal2-popup.image-article-details-swal {
  padding: 1rem !important;
}
.swal2-popup.image-article-details-swal .swal2-title {
  font-size: 1.1rem !important;
}
.task-done-pager { flex-direction: column; align-items: stretch; }
.task-done-pager .pages { overflow-x: auto; padding-bottom: 0.15rem; -webkit-overflow-scrolling: touch; gap: 0.2rem; }
.task-done-pager .pages .task-done-page-btn.page { flex: 0 0 auto; max-width: none; min-width: 32px; }
.task-done-pager .meta { text-align: center; }
.swal2-popup {
  width: calc(100vw - 0.5rem) !important; max-width: 100vw !important; margin: 0.25rem !important;
  padding: 0.875rem !important; border-radius: 0.875rem !important;
  padding-top: 2.25rem !important; box-sizing: border-box !important;
}
.swal2-icon {
  width: 3rem !important; height: 3rem !important; border-width: 2px !important; margin: 0.5rem auto !important;
}
.swal2-title {
  font-size: 1rem !important; padding: 0 0.5rem !important; line-height: 1.3 !important;
  word-wrap: break-word !important;
}
.swal2-html-container {
  font-size: 0.8125rem !important; padding: 0.5rem !important;
  max-height: calc(95vh - 100px) !important; line-height: 1.5 !important;
}
.swal2-confirm, .swal2-cancel {
  padding: 0.625rem 1rem !important; font-size: 0.875rem !important; width: 100% !important;
  margin: 0.25rem 0 !important;
}
.swal2-actions {
  flex-direction: column !important; width: 100% !important; gap: 0.5rem !important; padding: 0 !important;
}
}
@media (max-width: 400px) {
.task-done-cards { padding: 0.45rem; gap: 0.5rem; border-radius: 8px; };
.task-done-card { padding: 0.6rem 0.55rem; gap: 0.4rem; border-radius: 8px; };
.task-done-card-top, .task-done-card-top .left { gap: 0.28rem; };
.task-done-idx { padding: 0.15rem 0.32rem; font-size: 0.65rem; min-width: 22px; border-radius: 6px; };
.task-done-card .country-badge { padding: 0.12rem 0.32rem; gap: 0.18rem; font-size: 0.65rem; };
.task-done-card .country-badge .country-flag { width: 11px; height: 11px; font-size: 0.65rem; };
.task-done-time { font-size: 0.62rem; }; .task-done-kv { gap: 0.3rem; };
.task-done-kv .label { font-size: 0.62rem; }; .task-done-kv .value { font-size: 0.75rem; };
}
@media (max-width: 550px) {
.task-done-time { display: inline-block; }; .task-done-rawtime { display: none !important; };
.mobile-profile-menu {
  display: flex;
}
.user-menu-container {
  display: none !important;
}
}
@media (max-width: 600px) {
.task-done-cards { padding: 0.6rem; grid-template-columns: 1fr; gap: 0.6rem; border-radius: 10px; }; .task-done-card { padding: 0.7rem 0.65rem; gap: 0.45rem; border-radius: 10px; }; .task-done-card:hover { transform: none; box-shadow: 0 2px 8px rgba(0,0,0,0.04); }; .task-done-card-top, .task-done-card-top .left { gap: 0.35rem; }; .task-done-card-top .left { min-width: 0; }; .task-done-idx { padding: 0.18rem 0.4rem; font-size: 0.7rem; min-width: 24px; }; .task-done-card .country-badge { padding: 0.15rem 0.4rem; gap: 0.22rem; font-size: 0.7rem; }; .task-done-card .country-badge .country-flag { width: 13px; height: 13px; font-size: 0.72rem; }; .task-done-time { font-size: 0.68rem; }; .task-done-kv { gap: 0.35rem; }; .task-done-kv .label { font-size: 0.66rem; }; .task-done-kv .value { font-size: 0.8rem; };
.stat-card > .stat-icon {
  display: none!important;
}
}
@media (max-width: 980px) {
.task-modal-stat-grid {
  grid-template-columns: repeat(2, minmax(0, 1fr));
}
}
@media (min-width: 550px) {
.swal2-popup.recharge-modal-custom {
  width: 500px !important; ;
}
.hidedesktop{
  display:none!important;
}
.mobile-profile-menu {
  display: none !important;
}
}
@media (min-width: 900px) {
.sessions-modal-custom {
  width: 800px !important; ;
}
}
</style>
</head>
<body data-theme="light">
<div class="dashboard-layout">
<!-- Sidebar -->
<aside class="sidebar" id="sidebar">
<div class="sidebar-header">
<a href="#" class="logo" onmouseenter="animLogo()" onclick="animLogo()">
    <div class="logo-icon">
        <div class="logo-bar logo-b1"></div>
        <div class="logo-bar logo-b2"></div>
        <div class="logo-bar logo-b3"></div>
    </div>
    SEOTIZE
</a>
</div>
<nav class="sidebar-nav">
<div class="nav-section">
<div class="nav-section-title">Main</div>
<a href="#" class="nav-item active" data-page="dashboard">
<i class="ri-dashboard-line"></i>
<span>Dashboard</span>
</a>
<a href="#" class="nav-item" data-page="tasks">
<i class="ri-task-line"></i>
<span>SEO Tasks</span>
</a>
</div>
<div class="nav-section">
<div class="nav-section-title">Hosting</div>
<a href="#" class="nav-item" data-page="images">
<i class="ri-image-line"></i>
<span>Images</span>
</a>
<a href="#" class="nav-item" data-page="articles">
<i class="ri-article-line"></i>
<span>Articles</span>
</a>
</div>
<div class="nav-section">
<div class="nav-section-title">Account</div>
<a href="#" class="nav-item" data-page="billing">
<i class="ri-bank-card-line"></i>
<span>Billing</span>
</a>
<!-- Logout moved to user dropdown menu -->
</div>
</nav>
</aside>
<!-- Mobile Menu Overlay -->
<div class="mobile-menu-overlay" id="mobileMenuOverlay"></div>
<div class="mobile-menu" id="mobileMenu">
<div class="mobile-menu-header">
<div style="display: flex; justify-content: space-between; align-items: center; padding: 0 1rem;">
    <div class="logo">
        <i class="ri-seo-line"></i>
        <span>SEOTIZE</span>
    </div>
    <button onclick="closeMobileMenu()" style="background: none; border: none; color: var(--text); font-size: 1.5rem; cursor: pointer; padding: 0.5rem;">
        <i class="ri-close-line"></i>
    </button>
</div>
</div>
<div class="mobile-menu-content">
    <!-- Profile Section -->
    <div style="padding: 1.5rem 1rem; background: var(--bg-tertiary); border-radius: var(--radius); margin: 0 1rem 1rem 1rem;">
        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.75rem;">
            <div class="user-avatar" style="width: 50px; height: 50px; font-size: 1.5rem;">
                <span id="mobileMenuUserInitial">U</span>
            </div>
            <div style="flex: 1;">
                <div style="font-weight: 600; font-size: 1.125rem; color: var(--text); margin-bottom: 0.25rem;" id="mobileMenuUserName">User</div>
                <div style="font-size: 0.85rem; color: var(--text-secondary);" id="mobileMenuUserEmail">user@example.com</div>
            </div>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; padding-top: 0.75rem; border-top: 1px solid var(--border);">
            <div style="text-align: center;">
                <div style="font-size: 1.25rem; font-weight: 700; color: var(--primary);" id="mobileMenuTaskCount">0</div>
                <div style="font-size: 0.75rem; color: var(--text-secondary);">Tasks</div>
            </div>
            <div style="text-align: center;">
                <div style="font-size: 1.25rem; font-weight: 700; color: var(--secondary);" id="mobileMenuArticleCount">0</div>
                <div style="font-size: 0.75rem; color: var(--text-secondary);">Articles</div>
            </div>
        </div>
    </div>
    <!-- Account Section -->
    <div class="nav-section">
        <div class="nav-section-title">Account</div>
        <a href="#" class="nav-item" onclick="showSessionsModal(); closeMobileMenu();">
            <i class="ri-device-line"></i>
            <span>Active Sessions</span>
            <span class="badge badge-primary" id="sessionCountMobile"></span>
        </a>
        <a href="#" class="nav-item" data-page="profile" onclick="closeMobileMenu()">
            <i class="ri-user-line"></i>
            <span>Profile Settings</span>
        </a>
        <a href="#" class="nav-item" data-page="billing" onclick="closeMobileMenu()">
            <i class="ri-bank-card-line"></i>
            <span>Billing & Plans</span>
        </a>
    </div>
    <div style="border-top: 1px solid var(--border); margin: 0.5rem 0;"></div>
    <!-- Logout Section -->
    <div class="nav-section">
        <a href="#" class="nav-item danger" style="color: var(--error);" onclick="logout()">
            <i class="ri-logout-box-line"></i>
            <span>Logout</span>
        </a>
    </div>
</div>
</div>
<!-- Mobile Bottom Navigation -->
<nav class="mobile-nav" id="mobileNav">
<div class="mobile-nav-items">
<a href="#" class="mobile-nav-item active" data-page="dashboard">
<i class="ri-dashboard-line"></i>
<span>Dashboard</span>
</a>
<a href="#" class="mobile-nav-item" data-page="tasks">
<i class="ri-task-line"></i>
<span>Tasks</span>
</a>
<a href="#" class="mobile-nav-item" data-page="images">
<i class="ri-image-line"></i>
<span>Images</span>
</a>
<a href="#" class="mobile-nav-item" data-page="articles">
<i class="ri-article-line"></i>
<span>Articles</span>
</a>
<a href="#" class="mobile-nav-item" data-page="billing">
<i class="ri-bill-line"></i>
<span>Billing</span>
</a>
</div>
</nav>
<!-- Main Content -->
<main class="main-content">
<!-- Header -->
<header class="header">
<div class="header-left">
<a class="logox hidedesktop" onmouseenter="animLogo()" onclick="animLogo()">
    <div class="logo-icon">
        <div class="logo-bar logo-b1"></div>
        <div class="logo-bar logo-b2"></div>
        <div class="logo-bar logo-b3"></div>
    </div>
    SEOTIZE
</a>
</div>
<div class="header-right">
<button class="theme-toggle" onclick="toggleTheme()">
<i class="ri-moon-line" id="themeIcon"></i>
</button>
<!-- Mobile Profile Menu Icon - Google Style -->
<button class="mobile-profile-menu" onclick="toggleMobileProfileDropdown(event)">
<div class="user-avatar" id="mobileUserAvatar">U</div>
</button>
<!-- Mobile Profile Dropdown (Google Style) -->
<div id="mobileProfileDropdown" class="mobile-profile-dropdown">
    <div style="padding: 1rem; background: var(--bg-tertiary); border-bottom: 1px solid var(--border);">
        <div style="display: flex; align-items: center; gap: 1rem;">
            <div class="user-avatar" style="width: 48px; height: 48px; font-size: 1.25rem;">
                <span id="mobileDropdownUserInitial">U</span>
            </div>
            <div style="flex: 1;">
                <div style="font-weight: 600; color: var(--text);" id="mobileDropdownUserName">User</div>
                <div style="font-size: 0.875rem; color: var(--text-secondary);" id="mobileDropdownUserEmail">user@example.com</div>
            </div>
        </div>
    </div>
    <div style="padding: 0.5rem 0;">
        <a href="#" class="nav-item" onclick="showSessionsModal(); closeMobileProfileDropdown()" style="padding: 0.75rem 1rem; display: flex; align-items: center; gap: 0.75rem;">
            <i class="ri-device-line"></i>
            <span>Active Sessions</span>
            <span class="badge badge-primary" id="mobileDropdownSessionCount" style="margin-left: auto;"></span>
        </a>
        <div style="border-top: 1px solid var(--border); margin: 0.5rem 0;"></div>
        <a href="#" class="nav-item" onclick="logout(); closeMobileProfileDropdown()" style="padding: 0.75rem 1rem; display: flex; align-items: center; gap: 0.75rem; color: var(--error);">
            <i class="ri-logout-box-line"></i>
            <span>Sign Out</span>
        </a>
    </div>
</div>
<div class="user-menu-container">
<div class="user-menu" onclick="toggleUserDropdown()">
<div class="user-avatar">
<span id="userInitial">U</span>
</div>
<div>
<div style="font-weight: 500;" id="userName">User</div>
<div style="font-size: 0.75rem; color: var(--text-secondary);" id="userEmail">user@example.com</div>
</div>
</div>
<div class="user-dropdown" id="userDropdown">
<a href="#" class="user-dropdown-item" onclick="showSessionsModal()">
<i class="ri-device-line"></i>
<span>Active Sessions</span>
<span class="badge badge-primary" id="sessionCount"></span>
</a>
<div style="border-top: 1px solid var(--border); margin: 0.5rem 0;"></div>
<a href="#" class="user-dropdown-item danger" onclick="logout()">
<i class="ri-logout-box-line"></i>
<span>Logout</span>
</a>
</div>
</div>
</div>
</header>
<!-- Mobile Search Overlay -->
<div class="mobile-search-overlay" id="mobileSearchOverlay">
<div style="display: flex; gap: 0.5rem; align-items: center;">
<button onclick="toggleMobileSearch()" style="background: transparent; border: none; color: var(--text); font-size: 1.5rem; padding: 0.5rem;">
<i class="ri-arrow-left-line"></i>
</button>
<input type="text" class="mobile-search-input" placeholder="Search..." autofocus>
</div>
</div>
<!-- Content Area -->
<div class="content" id="content">
<!-- Dynamic content will be loaded here -->
</div>
</main>
</div>
<!-- Modal Container -->
<div class="modal-overlay" id="modalOverlay">
<div class="modal">
<div class="modal-header">
<h3 class="modal-title" id="modalTitle">Modal Title</h3>
<button class="modal-close" onclick="closeModal()">
<i class="ri-close-line"></i>
</button>
</div>
<div class="modal-body" id="modalBody">
<!-- Modal content -->
</div>
</div>
</div>
<!-- SEO Task Creator - New Design -->
<div class="seo-task-creator" id="seoTaskCreator">
    <div class="task-creator-container">
        <!-- Sidebar Progress -->
        <div class="task-creator-sidebar">
            <div class="progress-steps">
                <div class="progress-step active" data-step="1">
                    <div class="step-indicator">1</div>
                        <div class="step-info">
                            <div class="step-title">Website</div>
                            <div class="step-description">Set up your website URL and task priority</div>
                        </div>
                </div>
                <div class="progress-step" data-step="2">
                    <div class="step-indicator">2</div>
                    <div class="step-info">
                        <div class="step-title">Keywords</div>
                        <div class="step-description">Choose target keywords for SEO</div>
                    </div>
                </div>
                <div class="progress-step" data-step="3">
                    <div class="step-indicator">3</div>
                    <div class="step-info">
                        <div class="step-title">Payment</div>
                        <div class="step-description">Select payment method and complete</div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Main Content Area -->
        <div class="task-creator-main">
            <!-- Header -->
            <div class="task-creator-header">
                <button class="task-creator-close" onclick="closeSeoTaskCreator()">
                    <i class="ri-close-line"></i>
                </button>
                <div class="task-creator-title">Create New SEO Task</div>
                <div class="task-creator-subtitle">Configure your SEO campaign in three simple steps</div>
            </div>
            <!-- Body -->
            <div class="task-creator-body">
                <!-- Pending Task Alert -->
                <div class="pending-task-alert" id="pendingTaskAlert">
                    <div class="pending-task-header">
                        <div class="pending-task-icon">
                            <i class="ri-error-warning-line"></i>
                        </div>
                        <div class="pending-task-info">
                            <div class="pending-task-title">You have a pending payment</div>
                            <div>Complete or cancel your previous task before creating a new one</div>
                        </div>
                    </div>
                    <div class="pending-task-details" id="pendingTaskDetails">
                        <!-- Pending task details will be populated here -->
                    </div>
                    <div class="pending-task-actions">
                        <button class="btn btn-secondary" onclick="cancelPendingTask()">
                            <i class="ri-close-circle-line"></i> Cancel Task
                        </button>
                        <button class="btn btn-primary" onclick="completePendingPayment()">
                            <i class="ri-bank-card-line"></i> Complete Payment
                        </button>
                    </div>
                </div>
                <!-- Step 1: Website & Priority -->
                <div class="step-content active" id="step1">
                    <div class="form-group">
                        <label class="form-label">Website URL</label>
                        <input type="url" class="form-input" id="taskUrl" placeholder="https://example.com" required>
                        <small style="color: var(--text-secondary); display: block; margin-top: 0.5rem;">
                            Enter the full URL of your website that you want to optimize
                        </small>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Select Task Priority</label>
                        <div class="priority-options">
                            <div class="priority-option" data-priority="basic">
                                <span class="priority-badge">Basic</span>
                                <div class="priority-title">Basic Plan</div>
                                <div class="priority-price">$0.10<small>/click</small></div>
                                <div class="priority-locations">
                                    <i class="ri-map-pin-line"></i> 1 HTML location
                                </div>
                            </div>
                            <div class="priority-option selected" data-priority="standard">
                                <span class="priority-badge">Standard</span>
                                <div class="priority-title">Standard Plan</div>
                                <div class="priority-price">$0.12<small>/click</small></div>
                                <div class="priority-locations">
                                    <i class="ri-map-pin-line"></i> 3 HTML locations
                                </div>
                            </div>
                            <div class="priority-option" data-priority="premium">
                                <span class="priority-badge">Premium</span>
                                <div class="priority-title">Premium Plan</div>
                                <div class="priority-price">$0.15<small>/click</small></div>
                                <div class="priority-locations">
                                    <i class="ri-map-pin-line"></i> 5 HTML locations
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Step 2: Keywords -->
                <div class="step-content" id="step2">
                    <div class="form-group">
                        <label class="form-label">Target Keywords</label>
                        <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                            <div style="flex: 1; position: relative;">
                                <i class="ri-search-line" style="position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); color: var(--text-secondary);"></i>
                                <input type="text" class="form-input" id="keywordsInput"
                                       placeholder="Enter keywords separated by commas"
                                       style="padding-left: 2.5rem;"
                                       oninput="handleKeywordInput(this.value)">
                            </div>
                            <button class="btn btn-secondary" id="aiKeywordsBtn" onclick="generateAIKeywords()">
                                <i class="ri-magic-line"></i> AI Suggest
                            </button>
                        </div>
                        <div id="keywordSuggestions" class="keyword-suggestions">
                            <!-- AI suggested keywords will appear here -->
                        </div>
                        <div class="selected-keywords" id="selectedKeywordsSection" style="display: none;">
                            <div class="selected-keywords-header">Selected Keywords</div>
                            <div class="keyword-tags" id="selectedKeywordsDisplay">
                                <!-- Selected keywords will appear here -->
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Step 3: Payment -->
                <div class="step-content" id="step3">
                    <!-- Payment Type Toggle - Now positioned at top with better design -->
                    <div class="payment-type-toggle">
                        <button class="payment-type-option active" data-type="subscription" onclick="selectPaymentType('subscription')">
                            <i class="ri-refresh-line"></i>
                            <span>Subscription</span>
                        </button>
                        <button class="payment-type-option" data-type="one-time" onclick="selectPaymentType('one-time')">
                            <i class="ri-bank-card-line"></i>
                            <span>One-time</span>
                        </button>
                    </div>
                    <!-- Payment Method Selection -->
                    <div class="payment-options">
                        <div class="payment-card selected" data-method="stripe" onclick="selectPaymentMethod('stripe')" style="display: block;">
                            <div class="payment-icon">
                                <i class="ri-bank-card-2-line"></i>
                            </div>
                            <div class="payment-title">Stripe</div>
                            <div class="payment-description">Pay with credit/debit cards</div>
                        </div>
                        <div class="payment-card" data-method="oxapay" onclick="selectPaymentMethod('oxapay')" style="display: none;">
                            <div class="payment-icon">
                                <i class="ri-bit-coin-line"></i>
                            </div>
                            <div class="payment-title">OxaPay</div>
                            <div class="payment-description">Pay with cryptocurrency</div>
                        </div>
                    </div>
                    <!-- Subscription Options (Shown by default since subscription is default) -->
                    <div id="subscriptionOptions" style="display: block;">
                        <div class="form-group">
                            <label class="form-label" style="margin-bottom: 0.5rem; font-weight: 600; font-size: 0.9rem;">Billing Cycle</label>
                            <div class="billing-cycle-options">
                                <div class="billing-option" data-cycle="monthly" onclick="selectBillingCycle('monthly', this)">
                                    <div class="billing-option-top">
                                        <div class="billing-icon">
                                            <i class="ri-calendar-line"></i>
                                        </div>
                                        <div class="billing-option-header">
                                            <span class="billing-period">Monthly</span>
                                            <span class="billing-frequency">Billed every 30 days</span>
                                        </div>
                                    </div>
                                    <div class="billing-price">Pay monthly</div>
                                    <div class="billing-note">Cancel anytime for full flexibility</div>
                                </div>
                                <div class="billing-option billing-popular selected" data-cycle="quarterly" onclick="selectBillingCycle('quarterly', this)">
                                    <div class="billing-badge">Popular</div>
                                    <div class="billing-option-top">
                                        <div class="billing-icon">
                                            <i class="ri-calendar-check-line"></i>
                                        </div>
                                        <div class="billing-option-header">
                                            <span class="billing-period">Quarterly</span>
                                            <span class="billing-frequency">Billed every 3 months</span>
                                        </div>
                                        <span class="billing-save">Save 10%</span>
                                    </div>
                                    <div class="billing-price">3 months billing</div>
                                    <div class="billing-note">Ideal balance of savings and agility</div>
                                </div>
                                <div class="billing-option" data-cycle="yearly" onclick="selectBillingCycle('yearly', this)">
                                    <div class="billing-badge" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">Best Value</div>
                                    <div class="billing-option-top">
                                        <div class="billing-icon">
                                            <i class="ri-calendar-todo-line"></i>
                                        </div>
                                        <div class="billing-option-header">
                                            <span class="billing-period">Yearly</span>
                                            <span class="billing-frequency">Billed every 12 months</span>
                                        </div>
                                        <span class="billing-save">Save 20%</span>
                                    </div>
                                    <div class="billing-price">12 months billing</div>
                                    <div class="billing-note">Maximize savings for long-term growth</div>
                                </div>
                            </div>
                            <select class="form-select" id="billingCycle" style="display: none;">
                                <option value="monthly">Monthly</option>
                                <option value="quarterly" selected>Quarterly (Save 10%)</option>
                                <option value="yearly">Yearly (Save 20%)</option>
                            </select>
                        </div>
                    </div>
                    <!-- Budget Calculator -->
                    <div class="budget-calculator">
                        <div class="budget-input-group">
                            <div class="budget-field">
                                <label>Total Budget</label>
                                <input type="number" id="taskBudget" value="150" min="10" onchange="updateBudgetSummary()">
                                <span class="currency-symbol">$</span>
                            </div>
                            <div class="budget-field">
                                <label>Estimated Clicks</label>
                                <input type="text" id="estimatedClicks" readonly value="1,250">
                                <span class="currency-symbol">
                                    <i class="ri-mouse-line"></i>
                                </span>
                            </div>
                        </div>
                        <div class="budget-summary">
                            <div class="budget-summary-item">
                                <div class="budget-summary-label">Provider Fee</div>
                                <div class="budget-summary-value" id="providerFee">$0.00</div>
                            </div>
                            <div class="budget-summary-item">
                                <div class="budget-summary-label">Platform Fee</div>
                                <div class="budget-summary-value" id="platformFee">$0.00</div>
                            </div>
                            <div class="budget-summary-item">
                                <div class="budget-summary-label">Total Amount</div>
                                <div class="budget-summary-value" id="finalAmount" style="color: var(--success); font-size: 1.25rem;">$0.00</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Footer -->
            <div class="task-creator-footer">
                <div class="footer-info">
                    <i class="ri-lock-password-line"></i>
                    <span>Encrypted & Secure Payment</span>
                </div>
                <div class="footer-actions">
                    <button class="btn-ghost" id="prevStepBtn" onclick="previousStep()" style="display: none;">
                        <i class="ri-arrow-left-line"></i> Previous
                    </button>
                    <button class="btn-primary-gradient" id="nextStepBtn" onclick="nextStep()">
                        Next Step <i class="ri-arrow-right-line"></i>
                    </button>
                    <button class="btn-primary-gradient" id="createTaskBtn" onclick="createSeoTask()" style="display: none;">
                        <i class="ri-check-line"></i> Create Task
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- JavaScript -->
<script>
// API Configuration
const API_BASE = 'https://api.seotize.net';
let sessionToken = getCookie('session_token') || localStorage.getItem('authToken');
// Add this right after your paginationState object
let paginationHandlers = {};
function callPaginationHandler(handlerId, page) {
    if (paginationHandlers[handlerId]) {
        paginationHandlers[handlerId](page);
    }
}
// Global State
let currentData = {
    user: null,
    tasks: [],
    images: [],
    articles: [],
    domains: [],
    billing: [],
    selectedLocations: [],
    currentStep: 1,
    taskPriority: 'standard',
    selectedKeywords: [],
    usage: null,
    plan: null
};
let charts = {};
let globalMap = null;
let paginationState = {
    tasks: { page: 1, pageSize: 10, total: 0, hasNext: false },
    images: { page: 1, pageSize: 20, total: 0, hasNext: false },
    articles: { page: 1, pageSize: 10, total: 0, hasNext: false },
    billing: { page: 1, pageSize: 10, total: 0, hasNext: false }
};
// Initialize
/**
 * [NEW FUNCTION]
 * Handles the redirect back from a payment provider (Stripe, OxaPay).
 * It checks the URL for 'transaction_status' and 'payment_id'.
 */
function handlePaymentRedirect() {
    const urlParams = new URLSearchParams(window.location.search);
    const status = urlParams.get('transaction_status');
    const paymentId = urlParams.get('payment_id');
    if (status === 'success' && paymentId) {
        // Payment was successful, show the details modal
        // We use a small timeout to let the dashboard load first
        setTimeout(() => {
            viewPaymentDetails(paymentId);
        }, 1000);
        // Clean the URL so the popup doesn't show on every refresh
        window.history.replaceState({}, document.title, window.location.pathname);
    } else if (status === 'cancel') {
        // Payment was cancelled
        setTimeout(() => {
            showToast('Your payment was cancelled.', 'warning');
        }, 1000);
        // Clean the URL
        window.history.replaceState({}, document.title, window.location.pathname);
    }
}
gsap.registerPlugin(TextPlugin);
// --- LOGO ANIMATION FUNCTION ---
function animLogo() {
    gsap.fromTo(".logo-bar",
        { scaleY: 0.3, opacity: 0 },
        {
            scaleY: 1,
            opacity: 1,
            duration: 0.6,
            stagger: 0.15,
            ease: "elastic.out(1, 0.5)",
            overwrite: true
        }
    );
}
// Initialize
document.addEventListener('DOMContentLoaded', () => {
    if (!sessionToken) {
        window.location.href = '/login.html';
        return;
    }
    initializeEventListeners();
    handlePaymentRedirect(); // <-- THIS IS THE NEW LINE YOU ARE ADDING
    loadDashboard();
    initializeTheme();
    // Initialize user info after dashboard loads
    setTimeout(() => {
        updateUserInfo();
        animLogo();
    }, 100);
});
// Event Listeners
function initializeEventListeners() {
    // Desktop navigation
    document.querySelectorAll('.sidebar .nav-item[data-page]').forEach(item => {
        item.addEventListener('click', (e) => {
            e.preventDefault();
            navigateTo(item.dataset.page);
        });
    });
    // Mobile navigation
    document.querySelectorAll('.mobile-nav-item[data-page]').forEach(item => {
        item.addEventListener('click', (e) => {
            e.preventDefault();
            navigateTo(item.dataset.page);
        });
    });
    // Mobile menu navigation
    document.querySelectorAll('.mobile-menu .nav-item[data-page]').forEach(item => {
        item.addEventListener('click', (e) => {
            e.preventDefault();
            closeMobileMenu();
            navigateTo(item.dataset.page);
        });
    });
    // Modal click outside to close
    document.getElementById('modalOverlay').addEventListener('click', (e) => {
        if (e.target === e.currentTarget) {
            closeModal();
        }
    });
    // Close user dropdown when clicking outside
    document.addEventListener('click', (e) => {
        const userMenuContainer = document.querySelector('.user-menu-container');
        const userDropdown = document.getElementById('userDropdown');
        if (!userMenuContainer.contains(e.target)) {
            userDropdown.classList.remove('active');
        }
    });
    // Mobile menu overlay close
    document.getElementById('mobileMenuOverlay')?.addEventListener('click', closeMobileMenu);
}
// Mobile Menu Functions
function openMobileMenu() {
    document.getElementById('mobileMenu').classList.add('active');
    document.getElementById('mobileMenuOverlay').classList.add('active');
}
function closeMobileMenu() {
    document.getElementById('mobileMenu').classList.remove('active');
    document.getElementById('mobileMenuOverlay').classList.remove('active');
}
// New Google-style mobile profile dropdown functions
function toggleMobileProfileDropdown(event) {
    event.stopPropagation();
    const dropdown = document.getElementById('mobileProfileDropdown');
    if (dropdown) {
        dropdown.classList.toggle('active');
        if (dropdown.classList.contains('active')) {
            // Update user info when opening
            const user = currentData.user;
            if (user) {
                const initial = (user.email || 'U').charAt(0).toUpperCase();
                document.getElementById('mobileDropdownUserInitial').textContent = initial;
                // Hide the name element and show only email
                const nameEl = document.getElementById('mobileDropdownUserName');
                if (nameEl) nameEl.style.display = 'none';
                document.getElementById('mobileDropdownUserEmail').textContent = user.email || '';
                // Update session count (include current session)
                const otherSessions = getOtherSessions();
                const sessionCount = otherSessions.length + 1;
                document.getElementById('mobileDropdownSessionCount').textContent = sessionCount;
            }
        }
    }
}
function closeMobileProfileDropdown() {
    const dropdown = document.getElementById('mobileProfileDropdown');
    if (dropdown) {
        dropdown.classList.remove('active');
    }
}
// Mobile Search Functions
function toggleMobileSearch() {
    const overlay = document.getElementById('mobileSearchOverlay');
    overlay.classList.toggle('active');
    if (overlay.classList.contains('active')) {
        overlay.querySelector('input').focus();
    }
}
// User Dropdown Toggle
function toggleUserDropdown() {
    const dropdown = document.getElementById('userDropdown');
    dropdown.classList.toggle('active');
}
// Get Other Sessions (excluding current)
function getOtherSessions() {
    const sessions = currentData.user?.sessions || [];
    // Filter out current session token
    return sessions.filter(session => session.token !== sessionToken);
}
// Get Current Session
function getCurrentSession() {
    const sessions = currentData.user?.sessions || [];
    // Find current session token
    return sessions.find(session => session.token === sessionToken);
}
// [NEW] Rebuilt Active Sessions Modal using SweetAlert2
function showSessionsModal() {
    // Close any other open modals first
    document.getElementById('userDropdown').classList.remove('active');
    const otherSessions = getOtherSessions();
    const currentSession = getCurrentSession();
    // Helper to create a single session card
    const createSessionCard = (session, isCurrent = false) => {
        const createdDate = new Date(session.timestamp);
        const expiresDate = new Date(session.expires_at);
        const isExpired = expiresDate < new Date();
        return `
        <div class="session-card ${isCurrent ? 'session-card--current' : ''}">
            <div class="session-icon">
                <i class="ri-computer-line"></i>
            </div>
            <div class="session-details">
                <div class="session-main-info">
                    ${session.country_code} - ${session.ip_address}
                    ${isCurrent ? '<span class="badge badge-success" style="margin-left: 0.5rem;">This Device</span>' : ''}
                    ${isExpired ? '<span class="badge badge-danger" style="margin-left: 0.5rem;">Expired</span>' : ''}
                </div>
                <div class="session-meta-info">
                    <span><strong>Created:</strong> ${createdDate.toLocaleString()}</span>
                    <span><strong>Expires:</strong> ${isExpired ? 'Already Expired' : expiresDate.toLocaleString()}</span>
                </div>
            </div>
            ${!isCurrent ? `
                <div class="session-actions">
                    <button class="btn btn-sm btn-danger" onclick="revokeSession('${session.token}')">Revoke</button>
                </div>
            ` : ''}
        </div>
        `;
    };
    let modalHtml = `
    <div class="sessions-modal-container">
        <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">Manage your active login sessions. For security, revoke any sessions you don't recognize.</p>
        ${currentSession ? `
            <h3 class="sessions-section-title"><i class="ri-shield-check-line"></i>Current Session</h3>
            ${createSessionCard(currentSession, true)}
        ` : ''}
        ${otherSessions.length > 0 ? `
            <h3 class="sessions-section-title"><i class="ri-device-line"></i>Other Active Sessions</h3>
            <div>
                ${otherSessions.map(session => createSessionCard(session)).join('')}
            </div>
            <button class="btn btn-danger" onclick="revokeAllSessions()"><i class="ri-logout-box-r-line"></i> Revoke All Other Sessions (${otherSessions.length})</button>
        ` : `
            <div class="empty-state" style="padding: 1rem 0;">
                <div class="empty-state-icon"><i class="ri-shield-star-line"></i></div>
                <div class="empty-state-title" style="font-size: 1.2rem;">You're only logged in here.</div>
                <p class="empty-state-description">No other active sessions were found.</p>
            </div>
        `}
    </div>`;
    Swal.fire({
        title: 'Active Sessions',
        html: modalHtml,
        showConfirmButton: false,
        showCloseButton: true,
        width: '95vw',
        customClass: {
            popup: 'sessions-modal-custom',
            footer: 'swal2-footer',
            closeButton: 'swal2-close'
        }
    });
}
// [NEW] Updated to work with SweetAlert2
async function revokeSession(token) {
    Swal.fire({
        title: 'Revoke this session?',
        text: "The user logged in on that device will be signed out.",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: 'var(--error)',
        confirmButtonText: 'Yes, revoke it!',
        customClass: { popup: 'swal2-toast' }
    }).then(async (result) => {
        if (result.isConfirmed) {
            Swal.fire({
                title: 'Revoking...',
                didOpen: () => Swal.showLoading(),
                customClass: { popup: 'swal2-toast' }
            });
            try {
                // The API endpoint for revoking a single session is the logout endpoint with that session's token.
                await fetch(`${API_BASE}/logout`, {
                    method: 'GET',
                    headers: { 'Session-Token': token, 'Content-Type': 'application/json' }
                });
                // Update local data
                if (currentData.user && currentData.user.sessions) {
                    currentData.user.sessions = currentData.user.sessions.filter(s => s.token !== token);
                }
                Swal.close(); // Close the "Revoking..." popup
                showToast('Session revoked successfully', 'success');
                showSessionsModal(); // Refresh the main sessions modal
                updateUserInfo(); // Update session count badges
            } catch (error) {
                Swal.fire('Error!', 'Failed to revoke session: ' + error.message, 'error');
            }
        }
    });
}
// [NEW] Updated to work with SweetAlert2
// [NEW] Updated function to revoke sessions one-by-one in a loop
async function revokeAllSessions() {
    // 1. Get all sessions *except* the current one
    const sessionsToRevoke = getOtherSessions();
    const total = sessionsToRevoke.length;
    // 2. If there are no other sessions, just inform the user.
    if (total === 0) {
        Swal.fire({
            title: 'No Other Sessions',
            text: 'You are only logged in on this device.',
            icon: 'info',
            customClass: { popup: 'swal2-toast' }
        });
        return;
    }
    // 3. Ask for confirmation first
    Swal.fire({
        title: `Revoke all ${total} other sessions?`,
        text: "You will be logged out from all other devices immediately.",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: 'var(--error)',
        confirmButtonText: 'Yes, revoke all!',
        customClass: { popup: 'swal2-toast' }
    }).then(async (result) => {
        // 4. If user confirms, start the loop
        if (result.isConfirmed) {
            // Open the progress modal. We will update this modal's title.
            Swal.fire({
                title: `Revoking 1 of ${total}...`,
                didOpen: () => Swal.showLoading(),
                allowOutsideClick: false,
                allowEscapeKey: false,
                customClass: { popup: 'swal2-toast' }
            });
            let successCount = 0;
            let failCount = 0;
            const tokensToRevoke = sessionsToRevoke.map(s => s.token);
            const successfulTokens = [];
            // 5. Loop through each token
            for (let i = 0; i < total; i++) {
                const token = tokensToRevoke[i];
                // Update progress title
                Swal.update({
                    title: `Revoking ${i + 1} of ${total}...`
                });
                try {
                    // Call the single-revoke endpoint (which is /logout with that session's token)
                    // We use fetch directly here since api() helper might not be set up for this
                    await fetch(`${API_BASE}/logout`, {
                        method: 'GET',
                        headers: { 'Session-Token': token, 'Content-Type': 'application/json' }
                    });
                    // If successful:
                    successCount++;
                    successfulTokens.push(token);
                } catch (error) {
                    // If one fails, log it and continue
                    console.error('Failed to revoke session:', token, error);
                    failCount++;
                }
            }
            // 6. Update local data: keep only the current session AND any sessions that failed to revoke
            if (currentData.user && currentData.user.sessions) {
                currentData.user.sessions = currentData.user.sessions.filter(s => {
                    // Keep if it's the current session
                    if (s.token === sessionToken) return true;
                    // Keep if it was *not* in the successfully revoked list
                    if (!successfulTokens.includes(s.token)) return true;
                    // Otherwise, remove it
                    return false;
                });
            }
            // 7. Close the progress modal
            Swal.close();
            // 8. Show final status
            if (failCount === 0) {
                // All succeeded
                showToast(`All ${total} other sessions revoked!`, 'success');
            } else {
                // Some failed
                Swal.fire({
                    title: 'Partial Success',
                    text: `Successfully revoked ${successCount} of ${total} sessions. ${failCount} failed.`,
                    icon: 'warning',
                    customClass: { popup: 'swal2-toast' }
                });
            }
            // 9. Refresh the UI
            showSessionsModal(); // Refresh the main sessions modal
            updateUserInfo(); // Update session count badges
        }
    });
}
// Theme Management
function initializeTheme() {
    const savedTheme = localStorage.getItem('theme') || 'light';
    document.body.setAttribute('data-theme', savedTheme);
    updateThemeIcon(savedTheme);
}
function toggleTheme() {
    const currentTheme = document.body.getAttribute('data-theme');
    const newTheme = currentTheme === 'light' ? 'dark' : 'light';
    document.body.setAttribute('data-theme', newTheme);
    localStorage.setItem('theme', newTheme);
    updateThemeIcon(newTheme);
    // Refresh charts and map with new theme
    if (charts.traffic) {
        setTimeout(updateCharts, 100);
    }
}
function updateThemeIcon(theme) {
    document.getElementById('themeIcon').className = theme === 'light' ? 'ri-moon-line' : 'ri-sun-line';
}
// Navigation
function navigateTo(page) {
    // Update desktop nav
    document.querySelectorAll('.sidebar .nav-item').forEach(item => item.classList.remove('active'));
    document.querySelector(`.sidebar .nav-item[data-page="${page}"]`)?.classList.add('active');
    // Update mobile nav
    document.querySelectorAll('.mobile-nav-item').forEach(item => item.classList.remove('active'));
    document.querySelector(`.mobile-nav-item[data-page="${page}"]`)?.classList.add('active');
    switch(page) {
        case 'dashboard': loadDashboard(); break;
        case 'tasks': loadTasks(); break;
        case 'images': loadImages(); break;
        case 'articles': loadArticles(); break;
        case 'billing': loadBilling(); break;
        case 'profile': loadProfile(); break;
    }
}
// Update User Info
function updateUserInfo() {
    const user = currentData.user;
    if (!user) return;
    const email = user.email;
    const name = email.split('@')[0];
    const initial = email[0].toUpperCase();
    // Update all user display elements
    document.getElementById('userInitial').textContent = initial;
    document.getElementById('userName').textContent = name;
    document.getElementById('userEmail').textContent = email;
    // Update mobile profile avatar
    const mobileAvatar = document.getElementById('mobileUserAvatar');
    if (mobileAvatar) mobileAvatar.textContent = initial;
    // Update mobile menu profile section
    const mobileMenuInitial = document.getElementById('mobileMenuUserInitial');
    if (mobileMenuInitial) mobileMenuInitial.textContent = initial;
    const mobileMenuName = document.getElementById('mobileMenuUserName');
    if (mobileMenuName) mobileMenuName.textContent = name;
    const mobileMenuEmail = document.getElementById('mobileMenuUserEmail');
    if (mobileMenuEmail) mobileMenuEmail.textContent = email;
    // Update mobile menu task and article counts
    const mobileMenuTaskCount = document.getElementById('mobileMenuTaskCount');
    if (mobileMenuTaskCount && currentData.tasks) {
        mobileMenuTaskCount.textContent = currentData.tasks.length;
    }
    const mobileMenuArticleCount = document.getElementById('mobileMenuArticleCount');
    if (mobileMenuArticleCount && currentData.articles) {
        mobileMenuArticleCount.textContent = currentData.articles.length;
    }
    // Update session count (excluding current session)
    const otherSessions = getOtherSessions();
    const totalSessions = otherSessions.length + 1;
    // Update both desktop and mobile session counts
    const desktopCountEl = document.getElementById('sessionCount');
    if (desktopCountEl) desktopCountEl.textContent = totalSessions;
    const mobileCountEl = document.getElementById('sessionCountMobile');
    if (mobileCountEl) mobileCountEl.textContent = totalSessions;
}
// API Helper
async function api(endpoint, options = {}) {
    try {
        const response = await fetch(`${API_BASE}${endpoint}`, {
            ...options,
            headers: {
                'Session-Token': sessionToken,
                'Content-Type': 'application/json',
                ...(options.headers || {})
            }
        });
        // Check for 401/403 BEFORE parsing JSON
        if (response.status === 401 || response.status === 403) {
            // Clear cookies and redirect to login
            document.cookie = 'session_token=; path=/; Domain=.seotize.net; Secure; SameSite=Lax; expires=Thu, 01 Jan 1970 00:00:00 GMT';
            localStorage.removeItem('authToken');
            window.location.href = '/login.html';
            return; // Stop execution
        }
        const data = await response.json();
        if (!response.ok) {
            const apiError = new Error(data.error?.message || data.message || 'API Error');
            apiError.code = data.error?.code || response.status;
            apiError.data = data;
            throw apiError;
        }
        return data;
    } catch (error) {
        console.error('API Error:', error);
        // Only show toast if it's not a 409 error (pending task)
        if (error.code !== 409) {
            showToast(error.message, 'error');
        }
        throw error;
    }
}
// Helper function to format numbers with K/M abbreviations
function formatNumber(num) {
    if (num < 1000) {
        return num.toString();
    } else if (num < 1000000) {
        return (num / 1000).toFixed(1).replace('.0', '') + 'k';
    } else if (num < 1000000000) {
        return (num / 1000000).toFixed(1).replace('.0', '') + 'M';
    } else {
        return (num / 1000000000).toFixed(1).replace('.0', '') + 'B';
    }
}
// Toggle collapsible sections (for mobile)
function toggleSection(sectionId) {
    const content = document.getElementById(sectionId);
    const icon = document.getElementById(sectionId + 'Icon');
    if (!content) return;
    // Only apply collapse on mobile screens
    if (window.innerWidth <= 768) {
        content.classList.toggle('collapsed');
        if (icon) {
            if (content.classList.contains('collapsed')) {
                icon.style.transform = 'rotate(-90deg)';
            } else {
                icon.style.transform = 'rotate(0deg)';
            }
        }
    }
}
// Dashboard
async function loadDashboard(page = 1) {
    try {
        showSpinner();
        const response = await api(`/users/dashboard?page=${page}&page_size=10`);
        const { data, pagination } = response;
        const user = data.user;
        currentData.user = user;
        // Update pagination state for dashboard tasks
        paginationState.tasks = {
            page: pagination.current,
            pageSize: pagination.size,
            total: pagination.total,
            hasNext: pagination.has_next
        };
        // Sort tasks by date (newest first)
        const sortedTasks = (user.tasks || []).sort((a, b) =>
            new Date(b.date_created) - new Date(a.date_created)
        );
        // Update user info
        document.getElementById('userEmail').textContent = user.email;
        document.getElementById('userName').textContent = user.email.split('@')[0];
        document.getElementById('userInitial').textContent = user.email[0].toUpperCase();
        updateUserInfo();
        const content = document.getElementById('content');
        content.innerHTML = `
        <div class="stats-grid">
        <div class="stat-card">
        <div class="stat-icon primary">
        <i class="ri-task-line"></i>
        </div>
        <div class="stat-content">
        <div class="stat-value">${user.usage_summary?.total_tasks || 0}</div>
        <div class="stat-label">Total Tasks</div>
        </div>
        </div>
        <div class="stat-card">
        <div class="stat-icon success">
        <i class="ri-eye-line"></i>
        </div>
        <div class="stat-content">
        <div class="stat-value">${formatNumber(user.usage_summary?.total_views || 0)}</div>
        <div class="stat-label">Total Views</div>
        </div>
        </div>
        <div class="stat-card">
        <div class="stat-icon warning">
        <i class="ri-key-line"></i>
        </div>
        <div class="stat-content">
        <div class="stat-value">${user.usage_summary?.total_keywords || 0}</div>
        <div class="stat-label">Keywords</div>
        </div>
        </div>
        <div class="stat-card">
        <div class="stat-icon error">
        <i class="ri-wallet-line"></i>
        </div>
        <div class="stat-content">
        <div class="stat-value">$${(user.task_statistics?.available_charge || 0).toFixed(2)}</div>
        <div class="stat-label">Available Budget</div>
        </div>
        </div>
        </div>
        <div class="analytics-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem;">
        <div class="card">
        <div class="card-header">
        <h3 class="card-title">Task Performance</h3>
        </div>
        <div class="card-body">
        <div class="chart-container" style="height: 280px; position: relative;">
        <canvas id="taskChart"></canvas>
        </div>
        </div>
        </div>
        <div class="card">
        <div class="card-header">
        <h3 class="card-title">Views by Country</h3>
        </div>
        <div class="card-body">
        <div class="map-container" id="countryMap" style="height: 280px;"></div>
        </div>
        </div>
        </div>
        <div class="card">
        <div class="card-header">
        <h3 class="card-title">Recent Tasks</h3>
        <button class="btn btn-primary btn-sm" onclick="navigateTo('tasks')">View All</button>
        </div>
        <div class="card-body">
        <!-- Desktop Table Version -->
        <div class="table-container desktop-only">
        <table>
        <thead>
        <tr>
        <th>URL</th>
        <th>Created</th>
        <th>Keywords</th>
        <th>Views</th>
        <th>Budget Status</th>
        <th>Available</th>
        <th>Status</th>
        <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        ${sortedTasks.map(task => {
            const createdDate = new Date(task.date_created).toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            // Budget calculation with used and remaining display
            const totalCharge = task.total_charge;
            const availableCharge = task.available_charge;
            const remainingPercent = Math.max(0, task.remaining_percentage || 0);
            // Calculate used amount and display values
            let usedAmount = 0;
            let usedPercent = 0;
            let progressBarWidth = remainingPercent;
            let progressColor = '#8b5cf6'; // Purple for 100%
            if (remainingPercent <= 100) {
                // Normal case: calculate used from remaining percentage
                usedPercent = Math.max(0, 100 - remainingPercent);
                usedAmount = (totalCharge * usedPercent) / 100;
                // Color coding based on remaining percentage
                if (remainingPercent >= 100) {
                    progressColor = '#8b5cf6'; // Purple for 100%
                } else if (remainingPercent >= 10) {
                    progressColor = '#10b981'; // Green for 10% to 99%
                } else {
                    progressColor = '#ef4444'; // Red for below 10%
                }
                progressBarWidth = remainingPercent;
            } else {
                // Recharged case: remaining > 100%
                const rechargeAmount = availableCharge - totalCharge;
                usedAmount = 0;
                usedPercent = 0;
                progressColor = '#8b5cf6'; // Purple for recharged
                progressBarWidth = 100;
            }
            const isVerified = task.verified !== false;
            const statusClass = isVerified ? 'success' : 'warning';
            const statusText = isVerified ? 'Active' : 'Unverified';
            const displayUrl = task.url.replace(/^https?:\/\//, '');
            return `
            <tr>
            <td>
            <a href="${task.url}" target="_blank" style="color: var(--primary); text-decoration: none;">
            ${displayUrl.length > 30 ? displayUrl.substring(0, 30) + '...' : displayUrl}
            </a>
            </td>
            <td style="font-size: 0.875rem; color: var(--text-secondary);">${createdDate}</td>
            <td>
            <span class="badge badge-primary">${task.keywords_count}</span>
            </td>
            <td>
            <span class="badge badge-success">${formatNumber(task.views_count)}</span>
            </td>
            <td>
            <div style="display: flex; flex-direction: column; gap: 0.25rem; min-width: 120px;">
            <div style="font-size: 0.75rem; text-align: center;">
            Used: $${usedAmount.toFixed(2)} ${remainingPercent.toFixed(0)}%
            </div>
            <div class="progress-bar" style="height: 6px; background: var(--bg-tertiary); border-radius: 3px; overflow: hidden;">
            <div class="progress-fill" style="width: ${progressBarWidth}%; height: 100%; background: ${progressColor}; transition: width 0.3s ease, background-color 0.3s ease;"></div>
            </div>
            </div>
            </td>
            <td style="font-weight: 600;">$${availableCharge.toFixed(2)}</td>
            <td>
            <span class="badge badge-${statusClass}">
            ${statusText}
            </span>
            </td>
            <td>
            <button class="btn btn-sm" onclick="viewTaskDetails('${task._id}')" title="View Details">
            <i class="ri-eye-line"></i>
            </button>
            </td>
            </tr>
            `;
        }).join('')}
        </tbody>
        </table>
        </div>
        <!-- Mobile Card Version -->
        <div class="mobile-only">
        ${sortedTasks.length > 0 ? sortedTasks.map(task => {
            const createdDate = new Date(task.date_created).toLocaleDateString('en-US', {
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            // Same calculation logic as desktop version
            const totalCharge = task.total_charge;
            const availableCharge = task.available_charge;
            const remainingPercent = Math.max(0, task.remaining_percentage || 0);
            // Calculate used amount and display values - SAME AS DESKTOP
            let usedAmount = 0;
            let usedPercent = 0;
            let progressBarWidth = remainingPercent;
            let progressColor = '#8b5cf6'; // Purple for 100%
            if (remainingPercent <= 100) {
                // Normal case: calculate used from remaining percentage
                usedPercent = Math.max(0, 100 - remainingPercent);
                usedAmount = (totalCharge * usedPercent) / 100;
                // Color coding based on remaining percentage
                if (remainingPercent >= 100) {
                    progressColor = '#8b5cf6'; // Purple for 100%
                } else if (remainingPercent >= 10) {
                    progressColor = '#10b981'; // Green for 10% to 99%
                } else {
                    progressColor = '#ef4444'; // Red for below 10%
                }
                progressBarWidth = remainingPercent;
            } else {
                // Recharged case: remaining > 100%
                const rechargeAmount = availableCharge - totalCharge;
                usedAmount = 0;
                usedPercent = 0;
                progressColor = '#8b5cf6'; // Purple for recharged
                progressBarWidth = 100;
            }
            const isVerified = task.verified !== false;
            const statusClass = isVerified ? 'success' : 'warning';
            const statusText = isVerified ? 'Active' : 'Unverified';
            const displayUrl = task.url.replace(/^https?:\/\//, '');
            return `
            <div style="background: var(--bg-secondary); border: 1px solid var(--border); border-radius: var(--radius); padding: 1rem; margin-bottom: 1rem; cursor: pointer; transition: var(--transition);" onclick="viewTaskDetails('${task._id}')" ontouchstart="this.style.background='var(--card-hover)'" ontouchend="this.style.background='var(--bg-secondary)'">
                <!-- Header: URL and Status -->
                <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 0.75rem; gap: 0.5rem;">
                    <div style="flex: 1; min-width: 0;">
                        <a href="${task.url}" target="_blank" style="color: var(--primary); text-decoration: none; font-weight: 500; font-size: 0.95rem; display: inline-flex; align-items: center; gap: 0.35rem; word-break: break-all; line-height: 1.3;" onclick="event.stopPropagation()">
                            ${displayUrl.length > 40 ? displayUrl.substring(0, 40) + '...' : displayUrl} <i class="ri-external-link-line" style="font-size: 0.85rem; opacity: 0.8;"></i>
                        </a>
                        <div style="font-size: 0.75rem; color: var(--text-tertiary); margin-top: 0.25rem;">
                            ${createdDate}
                        </div>
                    </div>
                    <span class="badge badge-${statusClass}" style="flex-shrink: 0; font-size: 0.7rem;">
                        ${statusText}
                    </span>
                </div>
                <!-- Stats Row -->
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem; padding: 0.75rem; background: var(--bg-tertiary); border-radius: var(--radius-sm);flex-direction: column;    align-items: flex-start;gap: 10px;">
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <span style="font-size: 0.75rem; color: var(--text-secondary);">Keywords:</span>
                        <span class="badge badge-primary" style="font-size: 0.7rem; padding: 0.2rem 0.4rem;">${task.keywords_count}</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <span style="font-size: 0.75rem; color: var(--text-secondary);">Views:</span>
                        <span class="badge badge-success" style="font-size: 0.7rem; padding: 0.2rem 0.4rem;">${formatNumber(task.views_count)}</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <span style="font-size: 0.75rem; color: var(--text-secondary);">Available:</span>
                        <span style="font-weight: 600; font-size: 0.8rem; color: var(--text);">$${availableCharge.toFixed(2)}</span>
                    </div>
                </div>
                <!-- Budget Progress -->
                <div style="margin-bottom: 0.75rem;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                        <span style="font-size: 0.75rem; color: var(--text-secondary);">Budget Remaining</span>
                        <span style="font-size: 0.75rem; color: var(--text-secondary);">${remainingPercent.toFixed(0)}% (Used: $${usedAmount.toFixed(2)})</span>
                    </div>
                    <div class="progress-bar" style="height: 6px; background: var(--bg-tertiary); border-radius: 3px; overflow: hidden;">
                        <div class="progress-fill" style="width: ${progressBarWidth}%; height: 100%; background: ${progressColor}; transition: width 0.3s ease, background-color 0.3s ease;"></div>
                    </div>
                </div>
                <!-- Actions -->
                <div style="display: flex; gap: 0.5rem;">
                    <button class="btn btn-sm" onclick="event.stopPropagation(); viewTaskDetails('${task._id}')" style="flex: 1; font-size: 0.75rem; padding: 0.4rem 0.8rem;">
                        <i class="ri-eye-line"></i> Details
                    </button>
                    <button class="btn btn-sm btn-recharge-task" onclick="event.stopPropagation(); rechargeTask('${task._id}')" style="flex: 1; font-size: 0.75rem; padding: 0.4rem 0.8rem;">
                        <i class="ri-wallet-line"></i> Recharge
                    </button>
                </div>
            </div>
            `;
        }).join('') : `
            <div style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                <i class="ri-task-line" style="font-size: 2.5rem; margin-bottom: 0.5rem; opacity: 0.5;"></i>
                <p style="margin: 0; font-weight: 500;">No tasks yet</p>
                <p style="margin: 0.25rem 0 0 0; font-size: 0.8rem;">Create your first SEO task</p>
            </div>
        `}
        </div>
        <!-- Fixed pagination with proper structure -->
        <div class="pagination">
        <button class="pagination-btn" ${pagination.current <= 1 ? 'disabled' : ''} onclick="loadDashboard(${pagination.current - 1})">
        <i class="ri-arrow-left-s-line"></i> Previous
        </button>
        ${(() => {
            let paginationButtons = '';
            const totalPages = Math.max(1, pagination.pages);
            const currentPage = pagination.current;
            if (totalPages <= 5) {
                // Show all pages if 5 or fewer
                for (let i = 1; i <= totalPages; i++) {
                    paginationButtons += `<button class="pagination-btn ${i === currentPage ? 'active' : ''}" onclick="loadDashboard(${i})">${i}</button>`;
                }
            } else {
                // Show condensed pagination for more than 5 pages
                if (currentPage > 2) {
                    paginationButtons += `<button class="pagination-btn" onclick="loadDashboard(1)">1</button>`;
                    if (currentPage > 3) {
                        paginationButtons += '<span class="pagination-info">...</span>';
                    }
                }
                const startPage = Math.max(1, currentPage - 1);
                const endPage = Math.min(totalPages, currentPage + 1);
                for (let i = startPage; i <= endPage; i++) {
                    paginationButtons += `<button class="pagination-btn ${i === currentPage ? 'active' : ''}" onclick="loadDashboard(${i})">${i}</button>`;
                }
                if (currentPage < totalPages - 1) {
                    if (currentPage < totalPages - 2) {
                        paginationButtons += '<span class="pagination-info">...</span>';
                    }
                    paginationButtons += `<button class="pagination-btn" onclick="loadDashboard(${totalPages})">${totalPages}</button>`;
                }
            }
            return paginationButtons;
        })()}
        <button class="pagination-btn" ${!pagination.has_next ? 'disabled' : ''} onclick="loadDashboard(${pagination.current + 1})">
        Next <i class="ri-arrow-right-s-line"></i>
        </button>
        <div class="pagination-info">
        Page ${pagination.current} of ${Math.max(1, pagination.pages)} | Showing ${sortedTasks.length} of ${pagination.total} tasks
        </div>
        </div>
        </div>
        </div>
        `;
        // Initialize charts and map
        setTimeout(() => {
            initializeCharts(user);
            initializeCountryMap(user);
        }, 100);
    } catch (error) {
        console.error('Dashboard error:', error);
        showErrorState('Failed to load dashboard');
        if (error.message === 'Invalid session. Please log in again.') logout();
    }
}
// Tasks
async function loadTasks(page = 1) {
    try {
        showSpinner();
        const response = await api(`/users/dashboard?page=${page}&page_size=10`);
        const { data, pagination } = response;
        const user = data.user;
        currentData.tasks = user.tasks || [];
        // Ensure pagination state is properly set
        paginationState.tasks = {
            page: pagination.current || 1,
            pageSize: pagination.size || 10,
            total: pagination.total || 0,
            hasNext: pagination.has_next || false
        };
        const content = document.getElementById('content');
        content.innerHTML = `
        <div class="mobilearticle2" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
        <h2 style="font-size: 1.5rem; font-weight: 700;">SEO Tasks</h2>
        <button class="btn btn-primary" onclick="showTaskModal()">
        <i class="ri-add-line"></i> Create New Task
        </button>
        </div>
        <div class="task-grid">
        ${currentData.tasks.map(task => {
            const isVerified = task.verified !== false;
            const statusClass = isVerified ? 'active' : 'unverified';
            const statusText = isVerified ? 'Active' : 'Unverified';
            const cardClass = isVerified ? '' : ' unverified';
            const displayUrl = task.url.replace(/^https?:\/\//, '');
            const createdDate = task.date_created ? new Date(task.date_created).toLocaleDateString('en-US', {
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            }) : '';
            return `
            <div class="task-card${cardClass}" onclick="viewTaskDetails('${task._id}')">
            <button class="btn btn-sm btn-danger btn-delete-task-mobile" onclick="event.stopPropagation(); deleteTask('${task._id}')" title="Delete task" aria-label="Delete task">
            <i class="ri-delete-bin-line"></i>
            </button>
            <div class="task-header">
            <div class="task-url-wrapper">
            <a href="${task.url}" target="_blank" class="task-url" onclick="event.stopPropagation()">${displayUrl} <i class="ri-external-link-line"></i></a>
            ${createdDate ? `<div class="task-date">${createdDate}</div>` : ''}
            </div>
            <span class="task-status ${statusClass}">${statusText}</span>
            </div>
            <div class="task-stats">
            <div class="task-stat">
            <div class="task-stat-label">Keywords</div>
            <div class="task-stat-value">${task.keywords_count}</div>
            </div>
            <div class="task-stat">
            <div class="task-stat-label">Views</div>
            <div class="task-stat-value">${task.views_count}</div>
            </div>
            <div class="task-stat">
            <div class="task-stat-label">Budget Used</div>
            <div class="task-stat-value">$${(task.total_charge - task.available_charge).toFixed(2)}</div>
            </div>
            <div class="task-stat">
            <div class="task-stat-label">Available</div>
            <div class="task-stat-value">$${task.available_charge.toFixed(2)}</div>
            </div>
            </div>
            <div class="task-progress">
            <div class="progress-bar">
            <div class="progress-fill" style="width: ${task.remaining_percentage}%; background: ${task.remaining_percentage >= 100 ? '#8b5cf6' : task.remaining_percentage >= 10 ? '#10b981' : '#ef4444'}; transition: width 0.3s ease, background-color 0.3s ease;"></div>
            </div>
            </div>
            <div class="task-actions">
            <button class="btn btn-sm" onclick="event.stopPropagation(); viewTaskDetails('${task._id}')">
            <i class="ri-eye-line"></i> Details
            </button>
            <button class="btn btn-sm btn-recharge-task" onclick="event.stopPropagation(); rechargeTask('${task._id}')">
            <i class="ri-wallet-line"></i> Recharge
            </button>
            </div>
            <div class="task-actions task-actions-secondary ${isVerified ? 'task-actions-delete-only' : ''}" style="margin-top: 8px;">
            <button class="btn btn-sm btn-danger btn-delete-task-desktop" onclick="event.stopPropagation(); deleteTask('${task._id}')" style="background: var(--danger); color: white;">
            <i class="ri-delete-bin-line"></i> Delete
            </button>
            ${!isVerified ? `
            <button class="btn btn-sm btn-warning" onclick="event.stopPropagation(); verifyTask('${task._id}')" style="background: var(--warning); color: white;">
            <i class="ri-shield-check-line"></i> Verify Task
            </button>
            ` : ''}
            </div>
            </div>
            `;
        }).join('')}
            </div>
            ${currentData.tasks.length === 0 ? `
                <div class="empty-state">
                <div class="empty-state-icon">
                <i class="ri-task-line"></i>
                </div>
                <div class="empty-state-title">No Tasks Yet</div>
                <div class="empty-state-description">Create your first SEO task to start optimizing your website</div>
                <button class="btn btn-primary" onclick="showTaskModal()">Create First Task</button>
                </div>
                ` : generatePagination('tasks', loadTasks)}
                `;
    } catch (error) {
        console.error('Tasks error:', error);
        showErrorState('Failed to load tasks');
    }
}
// Images
async function loadImages(page = 1) {
    try {
        showSpinner();
        const response = await api(`/images/dashboard?page=${page}&page_size=20`);
        const { data, pagination } = response;
        currentData.images = data.images || [];
        paginationState.images = {
            page: pagination.current,
            pageSize: pagination.size,
            total: pagination.total,
            hasNext: pagination.has_next
        };
        const content = document.getElementById('content');
        content.innerHTML = `
        <div class="mobilearticle2" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
        <h2 style="font-size: 1.5rem; font-weight: 700;">Image Hosting</h2>
        <div style="display: flex; gap: 1rem; align-items: center;">
        <div style="font-size: 0.875rem; color: var(--text-secondary);">
        ${data.user?.uploaded || 0}/${(data.user?.uploaded || 0) + (data.user?.remaining || 0)} images used
        </div>
        <button class="btn btn-primary" onclick="showImageUploadModal()">
        <i class="ri-upload-line"></i> Upload Images
        </button>
        </div>
        </div>
        <div class="media-grid">
        ${currentData.images.map(image => `
    <div class="media-card">
        <div class="media-preview" onclick="window.open('${image.cdn_url}', '_blank')" style="cursor: pointer;" title="Click to open full image">
            <img src="${image.cdn_url}" alt="${image.original_filename}" loading="lazy">
        </div>
        <div class="media-info">
            <div class="media-filename">${image.original_filename}</div>
            <div class="media-stats">
                <span>${image.total_views} views</span>
                <span>${new Date(image.upload_date).toLocaleDateString()}</span>
            </div>
            <div style="display: flex; gap: 0.5rem; margin-top: 0.75rem;">
                <button class="btn btn-sm" onclick="showImageDetails('${image.image_id}')">
                    <i class="ri-eye-line"></i> Details
                </button>
                <button class="btn btn-sm btn-danger" onclick="deleteImage('${image.image_id}')">
                    <i class="ri-delete-bin-line"></i> Delete
                </button>
            </div>
        </div>
    </div>
        `).join('')}
        </div>
            ${currentData.images.length === 0 ? `
                <div class="empty-state">
                <div class="empty-state-icon">
                <i class="ri-image-line"></i>
                </div>
                <div class="empty-state-title">No Images Uploaded</div>
                <div class="empty-state-description">Upload images to host them on our CDN with analytics</div>
                <button class="btn btn-primary" onclick="showImageUploadModal()">Upload First Image</button>
                </div>
                ` : ''}
                ${paginationState.images.total > paginationState.images.pageSize ? generatePagination('images', loadImages) : ''}
                `;
    } catch (error) {
        console.error('Images error:', error);
        showErrorState('Failed to load images');
    }
}
// Articles with Domains
// Articles with Domains
async function loadArticles(page = 1) {
    try {
        showSpinner();
        // Single API call gets both articles and domains
        const response = await api(`/dashboard/articles?page=${page}&page_size=10`);
        const { data, pagination } = response;
        // Extract articles and domains from the response
        currentData.articles = data.articles || [];
        currentData.domains = data.user?.domains || [];
        // Extract usage and plan data
        currentData.usage = data.user?.usage || null;
        currentData.plan = data.user?.plan || 'N/A';
        // Update pagination state
        paginationState.articles = {
            page: pagination.current || page,
            pageSize: pagination.size || 10,
            total: pagination.total || 0,
            hasNext: pagination.has_next || false
        };
        const content = document.getElementById('content');
        content.innerHTML = `
        <div class="mobilearticle2" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
            <h2 style="font-size: 1.5rem; font-weight: 700;">Articles & Domains</h2>
            <div style="display: flex; gap: 1rem;">
                <button class="btn btn-secondary" id="addDomainBtn">
                    <i class="ri-global-line"></i> Add Domain
                </button>
                <button class="btn btn-primary" id="createArticleBtn">
                    <i class="ri-add-line"></i> Create Article
                </button>
            </div>
        </div>
                <div class="domains-usage-container" style="display: flex; gap: 1.5rem; margin-bottom: 1.5rem;">
                        <div class="card" style="flex: 1; min-width: 0;">
                <div class="card-header collapsible-header" onclick="toggleSection('domainsContent')" style="cursor: pointer;">
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <i class="ri-arrow-down-s-line" id="domainsContentIcon" style="transition: transform 0.3s ease; display: none;"></i>
                        <h3 class="card-title">Domain Verification</h3>
                    </div>
                    <span class="badge badge-primary">${currentData.domains.length} domains</span>
                </div>
                <div class="card-body collapsible-content" id="domainsContent">
                    ${currentData.domains.length > 0 ? currentData.domains.map(domain => `
                        <div class="mobilearticle1 domain-item">
                            <div class="domain-url-row">
                                <span class="domain-url-text">${domain.domain}</span>
                            </div>
                            <div class="domain-actions-row">
                                <div class="domain-status-row">
                                    <span class="badge badge-${domain.verified ? 'success' : 'warning'} domain-status-badge">
                                        ${domain.verified ? '&#10003; Verified' : '&#9203; Pending'}
                                    </span>
                                    <div class="domain-verify-delete">
                                        <button class="btn btn-sm btn-danger btn-delete-domain" data-domain="${domain.domain}">
                                            <i class="ri-delete-bin-line"></i> <span class="btn-delete-text">Delete</span>
                                        </button>
                                    </div>
                                </div>
                                ${!domain.verified ? `
                                <div class="domain-buttons-row">
                                    <button class="btn btn-sm btn-secondary btn-verify-instructions" data-domain="${domain.domain}" data-txt="${domain.txt_record || ''}">
                                        <i class="ri-information-line"></i> DNS Setup
                                    </button>
                                    <button class="btn btn-sm btn-primary btn-verify-domain" data-domain="${domain.domain}">
                                        <i class="ri-checkbox-circle-line"></i> Verify Now
                                    </button>
                                </div>
                                ` : `
                                <div class="domain-buttons-row">
                                    <button class="btn btn-sm btn-secondary btn-install-instructions" data-domain="${domain.domain}">
                                        <i class="ri-code-s-slash-line"></i> Install Instructions
                                    </button>
                                </div>
                                `}
                                <div class="domain-verify-delete domain-verify-delete-desktop">
                                    <button class="btn btn-sm btn-danger btn-delete-domain" data-domain="${domain.domain}">
                                        <i class="ri-delete-bin-line"></i> <span class="btn-delete-text">Delete</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    `).join('') : `
                        <div style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                            No domains added yet. Add a domain to start publishing articles.
                        </div>
                    `}
                </div>
            </div>
                        <div class="card" style="flex: 0 0 380px; min-width: 0;">
                <div class="card-header collapsible-header" onclick="toggleSection('usageContent')" style="cursor: pointer;">
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <i class="ri-arrow-down-s-line" id="usageContentIcon" style="transition: transform 0.3s ease; display: none;"></i>
                        <h3 class="card-title">Usage Plan</h3>
                    </div>
                    <span class="badge badge-info" style="text-transform: uppercase;">${currentData.plan || 'N/A'}</span>
                </div>
                <div class="card-body collapsible-content" id="usageContent">
                    <div style="display: flex; flex-direction: column; gap: 1.25rem;">
                        ${currentData.usage && (currentData.usage.ai || currentData.usage.articles || currentData.usage.images) ? `
                                                ${currentData.usage.ai ? `
                            <div class="usage-category">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <i class="ri-robot-line" style="color: var(--primary); font-size: 1.1rem;"></i>
                                        <span style="font-weight: 600; color: var(--text);">AI Generations</span>
                                    </div>
                                    <span style="font-size: 0.875rem; font-weight: 600;">${currentData.usage.ai.percentage}%</span>
                                </div>
                                <div style="width: 100%; height: 6px; background: var(--border); border-radius: 3px; overflow: hidden; margin-bottom: 0.5rem;">
                                    <div style="height: 100%; width: ${currentData.usage.ai.percentage}%; transition: width 0.3s ease, background-color 0.3s ease; background: ${currentData.usage.ai.percentage >= 100 ? '#8b5cf6' : currentData.usage.ai.percentage >= 10 ? '#10b981' : '#ef4444'};"></div>
                                </div>
                                <div style="display: flex; justify-content: space-between; font-size: 0.8rem; color: var(--text-secondary);">
                                    <span><strong>${currentData.usage.ai.used}</strong> used</span>
                                    <span><strong>${currentData.usage.ai.remaining}</strong> remaining / <strong>${currentData.usage.ai.limit}</strong> total</span>
                                </div>
                            </div>
                            ` : ''}
                                                ${currentData.usage.articles ? `
                            <div class="usage-category">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <i class="ri-article-line" style="color: var(--success); font-size: 1.1rem;"></i>
                                        <span style="font-weight: 600; color: var(--text);">Articles</span>
                                    </div>
                                    <span style="font-size: 0.875rem; font-weight: 600;">${currentData.usage.articles.percentage}%</span>
                                </div>
                                <div class="progress-bar" style="height: 6px; background: var(--bg-tertiary); border-radius: 3px; overflow: hidden; margin-bottom: 0.5rem;">
                                    <div class="progress-fill" style="height: 100%; width: ${currentData.usage.articles.percentage}%; transition: width 0.3s ease, background-color 0.3s ease; background: ${currentData.usage.articles.percentage >= 100 ? '#8b5cf6' : currentData.usage.articles.percentage >= 10 ? '#10b981' : '#ef4444'};"></div>
                                </div>
                                <div style="display: flex; justify-content: space-between; font-size: 0.8rem; color: var(--text-secondary);">
                                    <span><strong>${currentData.usage.articles.used}</strong> used</span>
                                    <span><strong>${currentData.usage.articles.remaining}</strong> remaining / <strong>${currentData.usage.articles.limit}</strong> total</span>
                                </div>
                            </div>
                            ` : ''}
                                                ${currentData.usage.images ? `
                            <div class="usage-category">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <i class="ri-image-line" style="color: var(--warning); font-size: 1.1rem;"></i>
                                        <span style="font-weight: 600; color: var(--text);">Images</span>
                                    </div>
                                    <span style="font-size: 0.875rem; font-weight: 600;">${currentData.usage.images.percentage}%</span>
                                </div>
                                <div style="width: 100%; height: 6px; background: var(--border); border-radius: 3px; overflow: hidden; margin-bottom: 0.5rem;">
                                    <div style="height: 100%; width: ${currentData.usage.images.percentage}%; transition: width 0.3s ease, background-color 0.3s ease; background: ${currentData.usage.images.percentage >= 100 ? '#8b5cf6' : currentData.usage.images.percentage >= 10 ? '#10b981' : '#ef4444'};"></div>
                                </div>
                                <div style="display: flex; justify-content: space-between; font-size: 0.8rem; color: var(--text-secondary);">
                                    <span><strong>${currentData.usage.images.used}</strong> used</span>
                                    <span><strong>${currentData.usage.images.remaining}</strong> remaining / <strong>${currentData.usage.images.limit}</strong> total</span>
                                </div>
                            </div>
                            ` : ''}
                        ` : `
                            <div style="text-align: center; padding: 1.5rem; color: var(--text-secondary);">
                                <i class="ri-information-line" style="font-size: 2rem; opacity: 0.5; margin-bottom: 0.5rem;"></i>
                                <p>No usage data available</p>
                            </div>
                        `}
                    </div>
                </div>
            </div>
        </div>
                <div class="card">
            <div class="card-header">
                <h3 class="card-title">Published Articles</h3>
                <span class="badge badge-primary">${paginationState.articles.total} articles</span>
            </div>
            <div class="card-body">
                            <div class="table-container desktop-only">
                    <table>
                        <thead>
                            <tr>
                                <th>Title</th>
                                <th>Domain</th>
                                <th>Published</th>
                                <th>Views</th>
                                <th>Images</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${currentData.articles.map(article => `
                                <tr>
                                    <td>
                                        <div style="font-weight: 600; margin-bottom: 0.25rem;">${article.subject}</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">ID: ${article.article_id}</div>
                                    </td>
                                    <td>
                                        <a href="https://${article.url}" target="_blank" class="badge badge-primary" style="text-decoration: none;">
                                            ${article.url}
                                        </a>
                                    </td>
                                    <td style="font-size: 0.875rem; color: var(--text-secondary);">
                                        ${new Date(article.creation_date).toLocaleDateString('en-US', {
                                            year: 'numeric',
                                            month: 'short',
                                            day: 'numeric'
                                        })}
                                    </td>
                                    <td>
                                        <span class="badge badge-success">${article.total_views || 0}</span>
                                    </td>
                                    <td>
                                        <span class="badge badge-warning">${(article.images || []).length}</span>
                                    </td>
                                    <td>
                                        <div style="display: flex; gap: 0.25rem;">
                                            <button class="btn btn-sm btn-view-article" data-article-id="${article.article_id}" title="View Details">
                                                <i class="ri-eye-line"></i>
                                            </button>
                                            <button class="btn btn-sm btn-edit-article" data-article-id="${article.article_id}" title="Edit">
                                                <i class="ri-edit-line"></i>
                                            </button>
                                            <button class="btn btn-sm btn-view-live" data-url="${article.url}" title="View Live">
                                                <i class="ri-external-link-line"></i>
                                            </button>
                                            <button class="btn btn-sm btn-danger btn-delete-article" data-article-id="${article.article_id}" title="Delete">
                                                <i class="ri-delete-bin-line"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
                                <div class="mobile-only">
                    ${currentData.articles.length > 0 ? currentData.articles.map(article => {
                        const publishedDate = new Date(article.creation_date).toLocaleDateString('en-US', {
                            month: 'short',
                            day: 'numeric',
                            year: new Date(article.creation_date).getFullYear() !== new Date().getFullYear() ? 'numeric' : undefined
                        });
                        return `
                        <div class="mobile-article-card" data-article-id="${article.article_id}" style="background: var(--bg-secondary); border: 1px solid var(--border); border-radius: var(--radius); padding: 1rem; margin-bottom: 1rem; cursor: pointer; transition: var(--transition);">
                                                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 0.75rem;">
                                <div style="flex: 1; min-width: 0;">
                                    <h4 style="margin: 0 0 0.5rem 0; font-size: 1rem; font-weight: 600; line-height: 1.3; color: var(--text); display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">${article.subject}</h4>
                                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.25rem;">
                                        <a href="https://${article.url}" target="_blank" style="color: var(--primary); text-decoration: none; font-size: 0.85rem; font-weight: 500;" onclick="event.stopPropagation()">
                                            <i class="ri-global-line" style="font-size: 0.8rem;"></i> ${article.url}
                                        </a>
                                    </div>
                                    <div style="font-size: 0.75rem; color: var(--text-tertiary);">
                                        Published ${publishedDate}
                                    </div>
                                </div>
                            </div>
                                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem; padding: 0.75rem; background: var(--bg-tertiary); border-radius: var(--radius-sm);">
                                <div style="display: flex; align-items: center; gap: 0.5rem;">
                                    <span style="font-size: 0.75rem; color: var(--text-secondary);">Views:</span>
                                    <span class="badge badge-success" style="font-size: 0.7rem; padding: 0.2rem 0.4rem;">${formatNumber(article.total_views || 0)}</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 0.5rem;">
                                    <span style="font-size: 0.75rem; color: var(--text-secondary);">Images:</span>
                                    <span class="badge badge-warning" style="font-size: 0.7rem; padding: 0.2rem 0.4rem;">${(article.images || []).length}</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 0.5rem;">
                                    <span style="font-size: 0.75rem; color: var(--text-secondary);">ID:</span>
                                    <code style="font-size: 0.65rem; background: var(--bg); padding: 0.2rem 0.4rem; border-radius: 3px;">${article.article_id.substring(0, 8)}...</code>
                                </div>
                            </div>
                                                        <div style="display: flex; gap: 0.5rem;">
                                <button class="btn btn-sm btn-view-article-mobile" data-article-id="${article.article_id}" style="flex: 1; font-size: 0.75rem; padding: 0.4rem 0.8rem; display: flex; align-items: center; justify-content: center; gap: 0.25rem;">
                                    <i class="ri-eye-line"></i> Details
                                </button>
                                <button class="btn btn-sm btn-edit-article-mobile" data-article-id="${article.article_id}" style="flex: 1; font-size: 0.75rem; padding: 0.4rem 0.8rem; display: flex; align-items: center; justify-content: center; gap: 0.25rem;">
                                    <i class="ri-edit-line"></i> Edit
                                </button>
                                <button class="btn btn-sm btn-view-live-mobile" data-url="${article.url}" style="flex: 1; font-size: 0.75rem; padding: 0.4rem 0.8rem; display: flex; align-items: center; justify-content: center; gap: 0.25rem;">
                                    <i class="ri-external-link-line"></i> Live
                                </button>
                                <button class="btn btn-sm btn-danger btn-delete-article-mobile" data-article-id="${article.article_id}" style="padding: 0.4rem 0.6rem; font-size: 0.75rem;">
                                    <i class="ri-delete-bin-line"></i>
                                </button>
                            </div>
                        </div>
                        `;
                    }).join('') : `
                        <div style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                            <i class="ri-article-line" style="font-size: 2.5rem; margin-bottom: 0.5rem; opacity: 0.5;"></i>
                            <p style="margin: 0; font-weight: 500;">No articles published</p>
                            <p style="margin: 0.25rem 0 0 0; font-size: 0.8rem;">Create your first article to start publishing content</p>
                        </div>
                    `}
                </div>
                ${currentData.articles.length === 0 ? `
                <div class="empty-state">
                        <div class="empty-state-icon">
                            <i class="ri-article-line"></i>
                        </div>
                        <div class="empty-state-title">No Articles Published</div>
                        <div class="empty-state-description">Create your first article to start publishing content</div>
                        <button class="btn btn-primary" id="emptyStateCreateBtn">Create First Article</button>
                    </div>
                ` : generatePagination('articles', loadArticles)}
            </div>
        </div>
        `;
        // Add event listeners after DOM is updated
        document.getElementById('addDomainBtn')?.addEventListener('click', showDomainModal);
        document.getElementById('createArticleBtn')?.addEventListener('click', () => showArticleModal());
        document.getElementById('emptyStateCreateBtn')?.addEventListener('click', () => showArticleModal());
        // Domain action buttons
        document.querySelectorAll('.btn-verify-instructions').forEach(btn => {
            btn.addEventListener('click', () => {
                showVerificationInstructions(btn.dataset.domain, btn.dataset.txt);
            });
        });
        document.querySelectorAll('.btn-install-instructions').forEach(btn => {
            btn.addEventListener('click', () => {
                showInstallInstructions(btn.dataset.domain);
            });
        });
        document.querySelectorAll('.btn-verify-domain').forEach(btn => {
            btn.addEventListener('click', () => verifyDomain(btn.dataset.domain));
        });
        document.querySelectorAll('.btn-delete-domain').forEach(btn => {
            btn.addEventListener('click', () => confirmDeleteDomain(btn.dataset.domain));
        });
        // Article action buttons - Desktop
        document.querySelectorAll('.btn-view-article').forEach(btn => {
            btn.addEventListener('click', () => viewArticle(btn.dataset.articleId));
        });
        document.querySelectorAll('.btn-edit-article').forEach(btn => {
            btn.addEventListener('click', () => showArticleModal(btn.dataset.articleId));
        });
        document.querySelectorAll('.btn-view-live').forEach(btn => {
            btn.addEventListener('click', () => window.open(`https://${btn.dataset.url}`, '_blank'));
        });
        document.querySelectorAll('.btn-delete-article').forEach(btn => {
            btn.addEventListener('click', () => {
                if (confirm('Are you sure you want to delete this article? This action cannot be undone.')) {
                    deleteArticle(btn.dataset.articleId);
                }
            });
        });
        // Article action buttons - Mobile
        document.querySelectorAll('.mobile-article-card').forEach(card => {
            card.addEventListener('click', (e) => {
                if (!e.target.closest('button') && !e.target.closest('a')) {
                    viewArticle(card.dataset.articleId);
                }
            });
        });
        document.querySelectorAll('.btn-view-article-mobile').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.stopPropagation();
                viewArticle(btn.dataset.articleId);
            });
        });
        document.querySelectorAll('.btn-edit-article-mobile').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.stopPropagation();
                showArticleModal(btn.dataset.articleId);
            });
        });
        document.querySelectorAll('.btn-view-live-mobile').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.stopPropagation();
                window.open(`https://${btn.dataset.url}`, '_blank');
            });
        });
        document.querySelectorAll('.btn-delete-article-mobile').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.stopPropagation();
                if (confirm('Are you sure you want to delete this article? This action cannot be undone.')) {
                    deleteArticle(btn.dataset.articleId);
                }
            });
        });
    } catch (error) {
        console.error('Articles error:', error);
        showErrorState('Failed to load articles and domains');
    }
}
// Package Purchase Modal State
const packagePurchaseState = {
    selectedPackage: 'professional',
    paymentType: 'subscription',
    paymentProvider: 'stripe',
    duration: '3month'
};

// Hosting Packages Configuration
const hostingPackages = {
    basic: {
        name: 'Basic',
        icon: 'ri-seedling-line',
        color: '#10b981',
        gradient: 'linear-gradient(135deg, #10b981 0%, #059669 100%)',
        price: { '3month': 10, '6month': 18, '12month': 32 },
        limits: { articles: 200, images: 1000 },
        features: ['1,000 Image Uploads', '200 Article Uploads', 'Email Support', 'Basic Analytics']
    },
    professional: {
        name: 'Professional',
        icon: 'ri-rocket-line',
        color: '#6366f1',
        gradient: 'linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)',
        popular: true,
        price: { '3month': 25, '6month': 45, '12month': 80 },
        limits: { articles: 600, images: 4000 },
        features: ['4,000 Image Uploads', '600 Article Uploads', 'Priority Support', 'Advanced Analytics', 'API Access']
    },
    enterprise: {
        name: 'Enterprise',
        icon: 'ri-building-line',
        color: '#f59e0b',
        gradient: 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',
        price: { '3month': 50, '6month': 90, '12month': 160 },
        limits: { articles: 2000, images: 20000 },
        features: ['20,000 Image Uploads', '2,000 Article Uploads', 'Dedicated Support', 'White-label Options', 'Custom Integrations', 'SLA Guarantee']
    }
};

// Duration Labels
const durationLabels = {
    '3month': { label: '3 Months', months: 3, discount: 0 },
    '6month': { label: '6 Months', months: 6, discount: 10 },
    '12month': { label: '12 Months', months: 12, discount: 20 }
};

// Open Package Purchase Modal
function openPackagePurchaseModal() {
    const modal = document.getElementById('packagePurchaseModal');
    if (modal) {
        modal.classList.add('active');
        document.body.style.overflow = 'hidden';
        updatePackagePurchaseUI();
    }
}

// Close Package Purchase Modal
function closePackagePurchaseModal() {
    const modal = document.getElementById('packagePurchaseModal');
    if (modal) {
        modal.classList.remove('active');
        document.body.style.overflow = '';
    }
}

// Select Package in Purchase Modal
function selectPackageOption(packageName) {
    packagePurchaseState.selectedPackage = packageName;
    document.querySelectorAll('.pkg-option-card').forEach(card => {
        card.classList.toggle('selected', card.dataset.package === packageName);
    });
    updatePackagePurchaseUI();
}

// Select Payment Type
function selectPackagePaymentType(type) {
    packagePurchaseState.paymentType = type;
    document.querySelectorAll('.pkg-payment-type-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.type === type);
    });
    
    // Show/hide provider options based on type
    const stripeOption = document.querySelector('.pkg-provider-option[data-provider="stripe"]');
    const oxapayOption = document.querySelector('.pkg-provider-option[data-provider="oxapay"]');
    
    if (type === 'subscription') {
        // Subscription only supports Stripe
        if (oxapayOption) oxapayOption.style.display = 'none';
        if (stripeOption) stripeOption.style.display = 'flex';
        packagePurchaseState.paymentProvider = 'stripe';
        document.querySelectorAll('.pkg-provider-option').forEach(opt => {
            opt.classList.toggle('selected', opt.dataset.provider === 'stripe');
        });
    } else {
        // One-time supports both
        if (oxapayOption) oxapayOption.style.display = 'flex';
        if (stripeOption) stripeOption.style.display = 'flex';
    }
    
    updatePackagePurchaseUI();
}

// Select Payment Provider
function selectPackageProvider(provider) {
    packagePurchaseState.paymentProvider = provider;
    document.querySelectorAll('.pkg-provider-option').forEach(opt => {
        opt.classList.toggle('selected', opt.dataset.provider === provider);
    });
    updatePackagePurchaseUI();
}

// Select Duration
function selectPackageDuration(duration) {
    packagePurchaseState.duration = duration;
    document.querySelectorAll('.pkg-duration-option').forEach(opt => {
        opt.classList.toggle('selected', opt.dataset.duration === duration);
    });
    updatePackagePurchaseUI();
}

// Update Package Purchase UI
function updatePackagePurchaseUI() {
    const pkg = hostingPackages[packagePurchaseState.selectedPackage];
    const duration = durationLabels[packagePurchaseState.duration];
    const basePrice = pkg.price[packagePurchaseState.duration];
    
    // Calculate per month price
    const perMonth = (basePrice / duration.months).toFixed(2);
    
    // Update summary
    const summaryEl = document.getElementById('pkgPurchaseSummary');
    if (summaryEl) {
        summaryEl.innerHTML = `
            <div class="pkg-summary-row">
                <span>Package</span>
                <span class="pkg-summary-value">${pkg.name}</span>
            </div>
            <div class="pkg-summary-row">
                <span>Duration</span>
                <span class="pkg-summary-value">${duration.label}</span>
            </div>
            <div class="pkg-summary-row">
                <span>Payment Type</span>
                <span class="pkg-summary-value">${packagePurchaseState.paymentType === 'subscription' ? 'Subscription' : 'One-time'}</span>
            </div>
            <div class="pkg-summary-row">
                <span>Provider</span>
                <span class="pkg-summary-value">${packagePurchaseState.paymentProvider === 'stripe' ? 'Card (Stripe)' : 'Crypto (OxaPay)'}</span>
            </div>
            ${duration.discount > 0 ? `
            <div class="pkg-summary-row pkg-discount">
                <span>Discount</span>
                <span class="pkg-summary-value">-${duration.discount}%</span>
            </div>
            ` : ''}
            <div class="pkg-summary-divider"></div>
            <div class="pkg-summary-row pkg-total">
                <span>Total</span>
                <span class="pkg-summary-value">$${basePrice.toFixed(2)}</span>
            </div>
            <div class="pkg-summary-row pkg-permonth">
                <span></span>
                <span>$${perMonth}/month</span>
            </div>
        `;
    }
    
    // Update purchase button
    const purchaseBtn = document.getElementById('pkgPurchaseBtn');
    if (purchaseBtn) {
        purchaseBtn.innerHTML = `<i class="ri-shopping-cart-2-line"></i> Purchase ${pkg.name} - $${basePrice.toFixed(2)}`;
    }
}

// Process Package Purchase
async function processPackagePurchase() {
    const pkg = hostingPackages[packagePurchaseState.selectedPackage];
    const currentPlan = window.currentPlanData;
    
    // Check if user has active plan
    if (currentPlan && currentPlan.current_plan && currentPlan.current_plan !== 'free') {
        const result = await Swal.fire({
            title: 'Active Plan Detected',
            html: `
                <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                    You currently have an active <strong>${hostingPackages[currentPlan.current_plan]?.name || currentPlan.current_plan}</strong> plan.
                </p>
                <p style="color: var(--text-secondary); font-size: 0.875rem;">
                    Would you like to cancel your current plan and purchase the new one?
                </p>
            `,
            icon: 'question',
            showCancelButton: true,
            confirmButtonColor: 'var(--primary)',
            cancelButtonColor: 'var(--bg-tertiary)',
            confirmButtonText: 'Yes, Replace Plan',
            cancelButtonText: 'Keep Current Plan',
            customClass: { popup: 'swal2-toast' }
        });
        
        if (!result.isConfirmed) return;
    }
    
    // Show loading
    Swal.fire({
        title: 'Processing...',
        html: 'Preparing your payment...',
        didOpen: () => Swal.showLoading(),
        allowOutsideClick: false,
        customClass: { popup: 'swal2-toast' }
    });
    
    try {
        const response = await api('/hosting/buy-package', 'POST', {
            package: packagePurchaseState.selectedPackage,
            provider: packagePurchaseState.paymentProvider,
            duration: packagePurchaseState.duration,
            subscription: packagePurchaseState.paymentType === 'subscription',
            cancel_previous: true,
            cancel_current_plan: true
        });
        
        Swal.close();
        
        if (response.data?.payment_url) {
            closePackagePurchaseModal();
            window.open(response.data.payment_url, '_blank');
            
            Swal.fire({
                icon: 'info',
                title: 'Payment Page Opened',
                html: 'Complete your payment in the new tab. This page will refresh when you return.',
                confirmButtonText: 'I\'ve Completed Payment',
                customClass: { popup: 'swal2-toast' }
            }).then(() => {
                loadBilling();
            });
        }
    } catch (error) {
        console.error('Purchase error:', error);
        Swal.fire({
            icon: 'error',
            title: 'Purchase Failed',
            text: error.message || 'Failed to process purchase. Please try again.',
            customClass: { popup: 'swal2-toast' }
        });
    }
}

// Upgraded Billing Function with Modern Design
async function loadBilling(page = 1, type = 'all') {
    try {
        showSpinner();
        // We now need two API calls: one for subscription status and one for billing history.
        const [planResponse, historyResponse] = await Promise.all([
            api('/hosting/subscription-status'),
            api(`/dashboard/billings?page=${page}&limit=10&type=${type}`)
        ]);
        const planData = planResponse.data;
        const historyData = historyResponse.data;
        
        // Store for global access
        window.currentPlanData = planData;
        
        // --- 1. Current Plan Data ---
        const planName = planData.current_plan || 'free';
        const isSubscribed = planData.is_subscription;
        const isFree = !planName || planName === 'free';
        
        // Calculate days left and expiry info
        let daysLeft = 0;
        let expiryDate = null;
        if (planData.expiry_date) {
            expiryDate = new Date(planData.expiry_date);
            const now = new Date();
            daysLeft = Math.ceil((expiryDate - now) / (1000 * 60 * 60 * 24));
            if (daysLeft < 0) daysLeft = 0;
        }
        
        // Usage percentages
        const imagesUsed = planData.images_uploads || 0;
        const imagesLimit = planData.images_limit || 0;
        const articlesUsed = planData.article_uploads || 0;
        const articlesLimit = planData.articles_limit || 0;
        const imagesUsedPercent = imagesLimit > 0 ? Math.min((imagesUsed / imagesLimit) * 100, 100) : 0;
        const articlesUsedPercent = articlesLimit > 0 ? Math.min((articlesUsed / articlesLimit) * 100, 100) : 0;
        
        // Subscription period info
        const subscriptionStart = planData.subscription_period_start ? new Date(planData.subscription_period_start) : null;
        const subscriptionEnd = planData.subscription_period_end ? new Date(planData.subscription_period_end) : null;
        
        // --- 2. Transaction History Data ---
        const taskPayments = historyData.tasks || [];
        const hostingPayments = historyData.hosting || [];
        const allPayments = [...hostingPayments, ...taskPayments].sort((a, b) => 
            new Date(b.dates?.created || 0) - new Date(a.dates?.created || 0)
        );
        
        paginationState.billing = {
            page: historyData.pagination.page,
            pageSize: historyData.pagination.limit,
            total: historyData.pagination.total,
            hasNext: historyData.pagination.page < historyData.pagination.pages
        };
        
        // Calculate billing stats
        const totalSpent = allPayments.filter(p => p.status === 'paid').reduce((sum, p) => sum + (p.total_payment || 0), 0);
        const pendingPayments = allPayments.filter(p => p.status === 'pending').length;
        const completedPayments = allPayments.filter(p => p.status === 'paid').length;
        const lastPayment = planData.billing?.last_payment_amount || 0;
        
        // Get current package info
        const currentPkg = hostingPackages[planName] || null;
        
        // --- 3. Render everything together ---
        const content = document.getElementById('content');
        content.innerHTML = `
        <style>
            /* ========================================
               BILLING & PLANS PAGE STYLES
               ======================================== */
            
            /* Page Header */
            .billing-header {
                display: flex; justify-content: space-between; align-items: center;
                margin-bottom: 2rem; flex-wrap: wrap; gap: 1rem;
            }
            .billing-header-left h1 {
                font-size: 1.75rem; font-weight: 800; color: var(--text);
                display: flex; align-items: center; gap: 0.75rem; margin: 0 0 0.25rem 0;
            }
            .billing-header-left h1 i { color: var(--primary); }
            .billing-header-left p {
                color: var(--text-secondary); font-size: 0.9rem; margin: 0;
            }
            .billing-header-actions { display: flex; gap: 0.75rem; }
            
            /* Current Plan Card */
            .current-plan-card {
                background: var(--card); border-radius: var(--radius-xl);
                border: 1px solid var(--border); overflow: hidden; margin-bottom: 1.5rem;
            }
            .current-plan-gradient {
                padding: 2rem; position: relative; overflow: hidden;
            }
            .current-plan-gradient::before {
                content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
                background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
                opacity: 0.5;
            }
            .current-plan-content {
                position: relative; z-index: 1; display: flex; justify-content: space-between;
                align-items: flex-start; flex-wrap: wrap; gap: 1.5rem;
            }
            .current-plan-info { flex: 1; min-width: 280px; }
            .current-plan-badge {
                display: inline-flex; align-items: center; gap: 0.5rem;
                background: rgba(255,255,255,0.2); backdrop-filter: blur(10px);
                padding: 0.5rem 1rem; border-radius: 2rem; font-size: 0.75rem;
                font-weight: 600; color: white; margin-bottom: 1rem;
                text-transform: uppercase; letter-spacing: 0.5px;
            }
            .current-plan-name {
                font-size: 2rem; font-weight: 800; color: white; margin: 0 0 0.5rem 0;
                display: flex; align-items: center; gap: 0.75rem;
            }
            .current-plan-name i { font-size: 1.75rem; }
            .current-plan-meta {
                display: flex; flex-wrap: wrap; gap: 1.5rem; margin-top: 1rem;
            }
            .current-plan-meta-item {
                display: flex; align-items: center; gap: 0.5rem;
                color: rgba(255,255,255,0.9); font-size: 0.875rem;
            }
            .current-plan-meta-item i { font-size: 1.1rem; opacity: 0.8; }
            .current-plan-stats {
                display: flex; gap: 1rem; flex-wrap: wrap;
            }
            .current-plan-stat {
                background: rgba(255,255,255,0.15); backdrop-filter: blur(10px);
                border-radius: var(--radius-lg); padding: 1.25rem 1.5rem;
                min-width: 140px; text-align: center;
            }
            .current-plan-stat-value {
                font-size: 1.5rem; font-weight: 800; color: white; margin-bottom: 0.25rem;
            }
            .current-plan-stat-label {
                font-size: 0.75rem; color: rgba(255,255,255,0.8);
                text-transform: uppercase; letter-spacing: 0.5px;
            }
            
            /* Plan Details Grid */
            .plan-details-grid {
                display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 1rem; padding: 1.5rem; background: var(--bg-secondary);
            }
            .plan-detail-item {
                display: flex; align-items: center; gap: 1rem;
                padding: 1rem; background: var(--card); border-radius: var(--radius);
                border: 1px solid var(--border);
            }
            .plan-detail-icon {
                width: 42px; height: 42px; border-radius: var(--radius);
                display: flex; align-items: center; justify-content: center;
                font-size: 1.25rem;
            }
            .plan-detail-content { flex: 1; }
            .plan-detail-label {
                font-size: 0.75rem; color: var(--text-secondary);
                text-transform: uppercase; letter-spacing: 0.5px;
            }
            .plan-detail-value { font-size: 0.95rem; font-weight: 600; color: var(--text); }
            
            /* Usage Cards */
            .usage-section { margin-bottom: 1.5rem; }
            .usage-section-title {
                font-size: 1.1rem; font-weight: 700; color: var(--text);
                margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;
            }
            .usage-grid {
                display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1rem;
            }
            .usage-card {
                background: var(--card); border-radius: var(--radius-lg);
                border: 1px solid var(--border); padding: 1.25rem; position: relative;
                overflow: hidden;
            }
            .usage-card-header {
                display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;
            }
            .usage-card-icon {
                width: 40px; height: 40px; border-radius: var(--radius);
                display: flex; align-items: center; justify-content: center; font-size: 1.25rem;
            }
            .usage-card-title { font-weight: 600; color: var(--text); }
            .usage-card-subtitle { font-size: 0.75rem; color: var(--text-secondary); }
            .usage-progress-container { margin-bottom: 0.75rem; }
            .usage-progress-bar {
                height: 8px; background: var(--bg-tertiary); border-radius: 4px; overflow: hidden;
            }
            .usage-progress-fill {
                height: 100%; border-radius: 4px; transition: width 0.5s ease;
            }
            .usage-stats {
                display: flex; justify-content: space-between; align-items: center;
            }
            .usage-stat-used { font-weight: 700; color: var(--text); }
            .usage-stat-limit { font-size: 0.875rem; color: var(--text-secondary); }
            
            /* Stats Cards */
            .stats-grid {
                display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 1rem; margin-bottom: 1.5rem;
            }
            .stat-card {
                background: var(--card); border-radius: var(--radius-lg);
                border: 1px solid var(--border); padding: 1.25rem;
                display: flex; align-items: center; gap: 1rem;
            }
            .stat-card-icon {
                width: 48px; height: 48px; border-radius: var(--radius);
                display: flex; align-items: center; justify-content: center; font-size: 1.5rem;
            }
            .stat-card-content { flex: 1; }
            .stat-card-value { font-size: 1.5rem; font-weight: 800; color: var(--text); }
            .stat-card-label { font-size: 0.8rem; color: var(--text-secondary); }
            
            /* Upgrade Section */
            .upgrade-section {
                background: var(--card); border-radius: var(--radius-xl);
                border: 1px solid var(--border); padding: 1.5rem; margin-bottom: 1.5rem;
            }
            .upgrade-header {
                display: flex; justify-content: space-between; align-items: center;
                margin-bottom: 1.5rem; flex-wrap: wrap; gap: 1rem;
            }
            .upgrade-title {
                font-size: 1.25rem; font-weight: 700; color: var(--text);
                display: flex; align-items: center; gap: 0.5rem;
            }
            .upgrade-title i { color: var(--primary); }
            .upgrade-subtitle { font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.25rem; }
            .upgrade-plans-grid {
                display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1rem;
            }
            .upgrade-plan-card {
                background: var(--bg-secondary); border-radius: var(--radius-lg);
                border: 2px solid var(--border); padding: 1.5rem; position: relative;
                transition: all 0.3s ease; cursor: pointer;
            }
            .upgrade-plan-card:hover {
                border-color: var(--primary); transform: translateY(-2px);
                box-shadow: 0 8px 24px rgba(99, 102, 241, 0.15);
            }
            .upgrade-plan-card.popular {
                border-color: var(--primary);
            }
            .upgrade-plan-card.popular::before {
                content: 'POPULAR'; position: absolute; top: -12px; left: 50%;
                transform: translateX(-50%); background: var(--primary);
                color: white; padding: 0.25rem 0.75rem; border-radius: 1rem;
                font-size: 0.65rem; font-weight: 700; letter-spacing: 0.5px;
            }
            .upgrade-plan-card.current {
                border-color: var(--success); background: rgba(16, 185, 129, 0.05);
            }
            .upgrade-plan-card.current::before {
                content: 'CURRENT'; background: var(--success);
            }
            .upgrade-plan-icon {
                width: 48px; height: 48px; border-radius: var(--radius);
                display: flex; align-items: center; justify-content: center;
                font-size: 1.5rem; margin-bottom: 1rem;
            }
            .upgrade-plan-name { font-size: 1.25rem; font-weight: 700; color: var(--text); margin-bottom: 0.25rem; }
            .upgrade-plan-price { font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem; }
            .upgrade-plan-price strong { font-size: 1.5rem; color: var(--text); }
            .upgrade-plan-features { list-style: none; padding: 0; margin: 0 0 1rem 0; }
            .upgrade-plan-features li {
                display: flex; align-items: center; gap: 0.5rem;
                font-size: 0.85rem; color: var(--text-secondary); padding: 0.35rem 0;
            }
            .upgrade-plan-features li i { color: var(--success); font-size: 1rem; }
            
            /* Transaction History */
            .transactions-section {
                background: var(--card); border-radius: var(--radius-xl);
                border: 1px solid var(--border); overflow: hidden;
            }
            .transactions-header {
                display: flex; justify-content: space-between; align-items: center;
                padding: 1.25rem 1.5rem; border-bottom: 1px solid var(--border);
                flex-wrap: wrap; gap: 1rem;
            }
            .transactions-title {
                font-size: 1.1rem; font-weight: 700; color: var(--text);
                display: flex; align-items: center; gap: 0.5rem;
            }
            .transactions-filter select {
                padding: 0.5rem 1rem; border-radius: var(--radius);
                border: 1px solid var(--border); background: var(--bg-secondary);
                color: var(--text); font-size: 0.875rem; cursor: pointer;
            }
            .transactions-table {
                width: 100%; border-collapse: collapse;
            }
            .transactions-table th {
                text-align: left; padding: 0.875rem 1rem; font-size: 0.75rem;
                font-weight: 600; color: var(--text-secondary);
                text-transform: uppercase; letter-spacing: 0.5px;
                background: var(--bg-secondary); border-bottom: 1px solid var(--border);
            }
            .transactions-table td {
                padding: 1rem; border-bottom: 1px solid var(--border);
                font-size: 0.875rem; color: var(--text);
            }
            .transactions-table tr:last-child td { border-bottom: none; }
            .transactions-table tr:hover { background: var(--bg-secondary); }
            .transaction-type-cell {
                display: flex; align-items: center; gap: 0.75rem;
            }
            .transaction-type-icon {
                width: 36px; height: 36px; border-radius: var(--radius);
                display: flex; align-items: center; justify-content: center; font-size: 1rem;
            }
            .transaction-type-info { display: flex; flex-direction: column; }
            .transaction-type-name { font-weight: 600; }
            .transaction-type-desc { font-size: 0.75rem; color: var(--text-secondary); }
            
            /* Mobile Transaction Cards */
            .mobile-transactions { display: none; }
            .mobile-transaction-card {
                background: var(--bg-secondary); border-radius: var(--radius);
                padding: 1rem; margin: 0.5rem 1rem;
            }
            .mobile-transaction-header {
                display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 0.75rem;
            }
            .mobile-transaction-type {
                display: flex; align-items: center; gap: 0.75rem;
            }
            .mobile-transaction-body {
                display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;
                font-size: 0.8rem;
            }
            .mobile-transaction-item label {
                display: block; color: var(--text-secondary); font-size: 0.7rem;
                text-transform: uppercase; margin-bottom: 0.15rem;
            }
            .mobile-transaction-actions {
                display: flex; gap: 0.5rem; margin-top: 0.75rem; padding-top: 0.75rem;
                border-top: 1px solid var(--border);
            }
            
            /* Package Purchase Modal */
            .package-purchase-modal {
                position: fixed; top: 0; left: 0; right: 0; bottom: 0;
                background: rgba(0, 0, 0, 0.75); backdrop-filter: blur(10px);
                z-index: 9998; display: none; animation: fadeIn 0.3s ease;
            }
            .package-purchase-modal.active {
                display: flex; align-items: center; justify-content: center;
            }
            .pkg-modal-container {
                background: var(--bg-secondary); border-radius: 1.5rem;
                width: 95vw; max-width: 1100px; max-height: 90vh;
                overflow: hidden; display: flex; flex-direction: column;
                box-shadow: 0 30px 60px -15px rgba(0, 0, 0, 0.3);
                animation: slideUpDesktop 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            }
            .pkg-modal-header {
                padding: 1.5rem 2rem; border-bottom: 1px solid var(--border);
                display: flex; justify-content: space-between; align-items: center;
            }
            .pkg-modal-title {
                font-size: 1.5rem; font-weight: 700; color: var(--text);
                display: flex; align-items: center; gap: 0.75rem;
            }
            .pkg-modal-title i { color: var(--primary); }
            .pkg-modal-close {
                width: 2.5rem; height: 2.5rem; border-radius: 50%;
                background: var(--bg-tertiary); border: 1px solid var(--border);
                color: var(--text-secondary); font-size: 1.25rem; cursor: pointer;
                display: flex; align-items: center; justify-content: center;
                transition: all 0.3s ease;
            }
            .pkg-modal-close:hover {
                background: var(--error); color: white; transform: rotate(90deg);
            }
            .pkg-modal-body {
                flex: 1; padding: 2rem; overflow-y: auto;
                display: grid; grid-template-columns: 1fr 340px; gap: 2rem;
            }
            .pkg-options-section { }
            .pkg-summary-section {
                background: var(--bg-tertiary); border-radius: var(--radius-lg);
                padding: 1.5rem; height: fit-content; position: sticky; top: 0;
            }
            
            /* Package Options */
            .pkg-section-title {
                font-size: 1rem; font-weight: 600; color: var(--text);
                margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;
            }
            .pkg-section-title i { color: var(--primary); }
            .pkg-options-grid {
                display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-bottom: 2rem;
            }
            .pkg-option-card {
                background: var(--card); border: 2px solid var(--border);
                border-radius: var(--radius-lg); padding: 1.25rem; cursor: pointer;
                transition: all 0.3s ease; position: relative;
            }
            .pkg-option-card:hover { border-color: var(--primary); transform: translateY(-2px); }
            .pkg-option-card.selected {
                border-color: var(--primary); background: rgba(99, 102, 241, 0.05);
            }
            .pkg-option-card.selected::after {
                content: '✓'; position: absolute; top: 0.75rem; right: 0.75rem;
                width: 1.25rem; height: 1.25rem; background: var(--primary);
                color: white; border-radius: 50%; display: flex;
                align-items: center; justify-content: center; font-size: 0.7rem;
            }
            .pkg-option-card.popular::before {
                content: 'POPULAR'; position: absolute; top: -10px; left: 50%;
                transform: translateX(-50%); background: var(--primary);
                color: white; padding: 0.2rem 0.6rem; border-radius: 1rem;
                font-size: 0.6rem; font-weight: 700;
            }
            .pkg-option-icon {
                width: 40px; height: 40px; border-radius: var(--radius);
                display: flex; align-items: center; justify-content: center;
                font-size: 1.25rem; margin-bottom: 0.75rem;
            }
            .pkg-option-name { font-weight: 700; color: var(--text); margin-bottom: 0.25rem; }
            .pkg-option-price { font-size: 0.85rem; color: var(--text-secondary); }
            .pkg-option-price strong { color: var(--text); font-size: 1.1rem; }
            .pkg-option-features {
                list-style: none; padding: 0; margin: 0.75rem 0 0 0;
                font-size: 0.75rem; color: var(--text-secondary);
            }
            .pkg-option-features li {
                display: flex; align-items: center; gap: 0.35rem; padding: 0.2rem 0;
            }
            .pkg-option-features li i { color: var(--success); font-size: 0.85rem; }
            
            /* Payment Type Toggle */
            .pkg-payment-type-toggle {
                display: flex; gap: 0.5rem; margin-bottom: 1.5rem;
                background: var(--bg-tertiary); padding: 0.35rem; border-radius: var(--radius);
            }
            .pkg-payment-type-btn {
                flex: 1; padding: 0.75rem 1rem; border: none; border-radius: var(--radius);
                background: transparent; color: var(--text-secondary);
                font-weight: 600; cursor: pointer; transition: all 0.3s ease;
                display: flex; align-items: center; justify-content: center; gap: 0.5rem;
            }
            .pkg-payment-type-btn.active {
                background: var(--primary); color: white; box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
            }
            
            /* Duration Options */
            .pkg-duration-grid {
                display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.75rem; margin-bottom: 1.5rem;
            }
            .pkg-duration-option {
                padding: 1rem; border: 2px solid var(--border); border-radius: var(--radius);
                cursor: pointer; transition: all 0.3s ease; text-align: center; position: relative;
            }
            .pkg-duration-option:hover { border-color: var(--primary); }
            .pkg-duration-option.selected {
                border-color: var(--primary); background: rgba(99, 102, 241, 0.05);
            }
            .pkg-duration-option.best-value::before {
                content: 'BEST VALUE'; position: absolute; top: -10px; left: 50%;
                transform: translateX(-50%); background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                color: white; padding: 0.2rem 0.6rem; border-radius: 1rem;
                font-size: 0.55rem; font-weight: 700;
            }
            .pkg-duration-label { font-weight: 600; color: var(--text); }
            .pkg-duration-discount {
                font-size: 0.75rem; color: var(--success); margin-top: 0.25rem;
            }
            
            /* Payment Providers */
            .pkg-providers-grid {
                display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; margin-bottom: 1.5rem;
            }
            .pkg-provider-option {
                display: flex; align-items: center; gap: 0.75rem; padding: 1rem;
                border: 2px solid var(--border); border-radius: var(--radius);
                cursor: pointer; transition: all 0.3s ease;
            }
            .pkg-provider-option:hover { border-color: var(--primary); }
            .pkg-provider-option.selected {
                border-color: var(--primary); background: rgba(99, 102, 241, 0.05);
            }
            .pkg-provider-icon { font-size: 1.5rem; }
            .pkg-provider-name { font-weight: 600; color: var(--text); }
            .pkg-provider-desc { font-size: 0.75rem; color: var(--text-secondary); }
            
            /* Summary Section */
            .pkg-summary-title {
                font-size: 1.1rem; font-weight: 700; color: var(--text);
                margin-bottom: 1rem; padding-bottom: 0.75rem;
                border-bottom: 1px solid var(--border);
            }
            .pkg-summary-row {
                display: flex; justify-content: space-between; padding: 0.5rem 0;
                font-size: 0.875rem; color: var(--text-secondary);
            }
            .pkg-summary-value { color: var(--text); font-weight: 500; }
            .pkg-summary-row.pkg-discount { color: var(--success); }
            .pkg-summary-row.pkg-discount .pkg-summary-value { color: var(--success); }
            .pkg-summary-divider {
                height: 1px; background: var(--border); margin: 0.75rem 0;
            }
            .pkg-summary-row.pkg-total {
                font-size: 1rem; color: var(--text); font-weight: 600;
            }
            .pkg-summary-row.pkg-total .pkg-summary-value {
                font-size: 1.25rem; font-weight: 800; color: var(--primary);
            }
            .pkg-summary-row.pkg-permonth {
                font-size: 0.8rem; color: var(--text-secondary); font-style: italic;
            }
            #pkgPurchaseBtn {
                width: 100%; padding: 1rem; margin-top: 1.5rem;
                background: var(--primary); color: white; border: none;
                border-radius: var(--radius); font-weight: 600; font-size: 1rem;
                cursor: pointer; transition: all 0.3s ease;
                display: flex; align-items: center; justify-content: center; gap: 0.5rem;
            }
            #pkgPurchaseBtn:hover {
                background: var(--primary-dark); transform: translateY(-2px);
                box-shadow: 0 8px 20px rgba(99, 102, 241, 0.3);
            }
            
            /* Free Plan Card */
            .free-plan-card {
                background: linear-gradient(135deg, var(--bg-tertiary) 0%, var(--bg-secondary) 100%);
                border: 2px dashed var(--border); border-radius: var(--radius-xl);
                padding: 3rem 2rem; text-align: center; margin-bottom: 1.5rem;
            }
            .free-plan-icon {
                width: 80px; height: 80px; margin: 0 auto 1.5rem;
                background: var(--bg-secondary); border-radius: 50%;
                display: flex; align-items: center; justify-content: center;
                font-size: 2.5rem; color: var(--text-secondary);
            }
            .free-plan-title { font-size: 1.5rem; font-weight: 700; color: var(--text); margin-bottom: 0.5rem; }
            .free-plan-desc { color: var(--text-secondary); margin-bottom: 1.5rem; max-width: 400px; margin-left: auto; margin-right: auto; }
            
            /* Responsive */
            @media (max-width: 1024px) {
                .pkg-modal-body { grid-template-columns: 1fr; }
                .pkg-summary-section { position: static; }
                .pkg-options-grid { grid-template-columns: 1fr; }
            }
            @media (max-width: 768px) {
                .billing-header { flex-direction: column; align-items: flex-start; }
                .current-plan-content { flex-direction: column; }
                .current-plan-stats { width: 100%; justify-content: center; }
                .plan-details-grid { grid-template-columns: 1fr 1fr; }
                .stats-grid { grid-template-columns: 1fr 1fr; }
                .upgrade-plans-grid { grid-template-columns: 1fr; }
                .transactions-table { display: none; }
                .mobile-transactions { display: block; }
                .pkg-modal-container {
                    width: 100vw; max-width: 100vw; height: 100vh;
                    border-radius: 0; max-height: 100vh;
                }
                .pkg-modal-body { padding: 1rem; gap: 1rem; }
                .pkg-duration-grid { grid-template-columns: 1fr; }
                .pkg-providers-grid { grid-template-columns: 1fr; }
            }
            @media (max-width: 480px) {
                .plan-details-grid { grid-template-columns: 1fr; }
                .stats-grid { grid-template-columns: 1fr; }
                .current-plan-stat { min-width: 100px; padding: 1rem; }
                .current-plan-stat-value { font-size: 1.25rem; }
            }
        </style>
        
        <!-- Package Purchase Modal -->
        <div class="package-purchase-modal" id="packagePurchaseModal">
            <div class="pkg-modal-container">
                <div class="pkg-modal-header">
                    <h2 class="pkg-modal-title"><i class="ri-shopping-bag-3-line"></i> Purchase Package</h2>
                    <button class="pkg-modal-close" onclick="closePackagePurchaseModal()">
                        <i class="ri-close-line"></i>
                    </button>
                </div>
                <div class="pkg-modal-body">
                    <div class="pkg-options-section">
                        <!-- Select Package -->
                        <h3 class="pkg-section-title"><i class="ri-stack-line"></i> Select Package</h3>
                        <div class="pkg-options-grid">
                            ${Object.entries(hostingPackages).map(([key, pkg]) => `
                                <div class="pkg-option-card ${pkg.popular ? 'popular' : ''} ${key === 'professional' ? 'selected' : ''}" 
                                     data-package="${key}" onclick="selectPackageOption('${key}')">
                                    <div class="pkg-option-icon" style="background: ${pkg.gradient}; color: white;">
                                        <i class="${pkg.icon}"></i>
                                    </div>
                                    <div class="pkg-option-name">${pkg.name}</div>
                                    <div class="pkg-option-price">From <strong>$${pkg.price['3month']}</strong>/3mo</div>
                                    <ul class="pkg-option-features">
                                        ${pkg.features.slice(0, 3).map(f => `<li><i class="ri-check-line"></i> ${f}</li>`).join('')}
                                    </ul>
                                </div>
                            `).join('')}
                        </div>
                        
                        <!-- Payment Type -->
                        <h3 class="pkg-section-title"><i class="ri-repeat-line"></i> Payment Type</h3>
                        <div class="pkg-payment-type-toggle">
                            <button class="pkg-payment-type-btn active" data-type="subscription" onclick="selectPackagePaymentType('subscription')">
                                <i class="ri-refresh-line"></i> Subscription
                            </button>
                            <button class="pkg-payment-type-btn" data-type="one-time" onclick="selectPackagePaymentType('one-time')">
                                <i class="ri-bank-card-line"></i> One-time
                            </button>
                        </div>
                        
                        <!-- Duration -->
                        <h3 class="pkg-section-title"><i class="ri-calendar-line"></i> Duration</h3>
                        <div class="pkg-duration-grid">
                            <div class="pkg-duration-option selected" data-duration="3month" onclick="selectPackageDuration('3month')">
                                <div class="pkg-duration-label">3 Months</div>
                            </div>
                            <div class="pkg-duration-option" data-duration="6month" onclick="selectPackageDuration('6month')">
                                <div class="pkg-duration-label">6 Months</div>
                                <div class="pkg-duration-discount">Save 10%</div>
                            </div>
                            <div class="pkg-duration-option best-value" data-duration="12month" onclick="selectPackageDuration('12month')">
                                <div class="pkg-duration-label">12 Months</div>
                                <div class="pkg-duration-discount">Save 20%</div>
                            </div>
                        </div>
                        
                        <!-- Payment Provider -->
                        <h3 class="pkg-section-title"><i class="ri-secure-payment-line"></i> Payment Method</h3>
                        <div class="pkg-providers-grid">
                            <div class="pkg-provider-option selected" data-provider="stripe" onclick="selectPackageProvider('stripe')">
                                <div class="pkg-provider-icon">💳</div>
                                <div>
                                    <div class="pkg-provider-name">Card (Stripe)</div>
                                    <div class="pkg-provider-desc">Credit/Debit cards</div>
                                </div>
                            </div>
                            <div class="pkg-provider-option" data-provider="oxapay" onclick="selectPackageProvider('oxapay')" style="display: none;">
                                <div class="pkg-provider-icon">🪙</div>
                                <div>
                                    <div class="pkg-provider-name">Crypto (OxaPay)</div>
                                    <div class="pkg-provider-desc">Bitcoin, ETH, USDT...</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="pkg-summary-section">
                        <h3 class="pkg-summary-title">Order Summary</h3>
                        <div id="pkgPurchaseSummary">
                            <!-- Dynamically updated -->
                        </div>
                        <button id="pkgPurchaseBtn" onclick="processPackagePurchase()">
                            <i class="ri-shopping-cart-2-line"></i> Purchase - $25.00
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Page Header -->
        <div class="billing-header">
            <div class="billing-header-left">
                <h1><i class="ri-bank-card-line"></i> Billing & Plans</h1>
                <p>Manage your subscription, view usage, and payment history</p>
            </div>
            <div class="billing-header-actions">
                <button class="btn btn-primary" onclick="openPackagePurchaseModal()">
                    <i class="ri-shopping-bag-3-line"></i> ${isFree ? 'Get Started' : 'Upgrade Plan'}
                </button>
                ${!isFree && isSubscribed ? `
                    <button class="btn btn-secondary" onclick="showSubscriptionModal()">
                        <i class="ri-settings-3-line"></i> Manage
                    </button>
                ` : ''}
            </div>
        </div>
        
        ${isFree ? `
        <!-- Free Plan Card -->
        <div class="free-plan-card">
            <div class="free-plan-icon">
                <i class="ri-gift-line"></i>
            </div>
            <h2 class="free-plan-title">You're on the Free Plan</h2>
            <p class="free-plan-desc">Upgrade to unlock more features, higher limits, and priority support for your SEO needs.</p>
            <button class="btn btn-primary btn-lg" onclick="openPackagePurchaseModal()">
                <i class="ri-rocket-line"></i> Upgrade Now
            </button>
        </div>
        ` : `
        <!-- Current Plan Card -->
        <div class="current-plan-card">
            <div class="current-plan-gradient" style="background: ${currentPkg?.gradient || 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)'};">
                <div class="current-plan-content">
                    <div class="current-plan-info">
                        <div class="current-plan-badge">
                            <i class="${isSubscribed ? 'ri-refresh-line' : 'ri-time-line'}"></i>
                            ${isSubscribed ? 'Active Subscription' : 'One-time Purchase'}
                        </div>
                        <h2 class="current-plan-name">
                            <i class="${currentPkg?.icon || 'ri-vip-crown-line'}"></i>
                            ${currentPkg?.name || planName} Plan
                        </h2>
                        <div class="current-plan-meta">
                            ${expiryDate ? `
                                <div class="current-plan-meta-item">
                                    <i class="ri-calendar-check-line"></i>
                                    ${daysLeft > 0 ? `Expires ${expiryDate.toLocaleDateString()}` : 'Expired'}
                                </div>
                            ` : ''}
                            ${subscriptionEnd ? `
                                <div class="current-plan-meta-item">
                                    <i class="ri-repeat-line"></i>
                                    Next billing: ${subscriptionEnd.toLocaleDateString()}
                                </div>
                            ` : ''}
                            ${planData.billing?.provider ? `
                                <div class="current-plan-meta-item">
                                    <i class="ri-bank-card-line"></i>
                                    ${planData.billing.provider.charAt(0).toUpperCase() + planData.billing.provider.slice(1)}
                                </div>
                            ` : ''}
                        </div>
                    </div>
                    <div class="current-plan-stats">
                        <div class="current-plan-stat">
                            <div class="current-plan-stat-value">${daysLeft}</div>
                            <div class="current-plan-stat-label">Days Left</div>
                        </div>
                        ${lastPayment > 0 ? `
                            <div class="current-plan-stat">
                                <div class="current-plan-stat-value">$${lastPayment.toFixed(0)}</div>
                                <div class="current-plan-stat-label">Last Payment</div>
                            </div>
                        ` : ''}
                    </div>
                </div>
            </div>
            <div class="plan-details-grid">
                <div class="plan-detail-item">
                    <div class="plan-detail-icon" style="background: rgba(99, 102, 241, 0.1); color: var(--primary);">
                        <i class="ri-image-line"></i>
                    </div>
                    <div class="plan-detail-content">
                        <div class="plan-detail-label">Images</div>
                        <div class="plan-detail-value">${imagesUsed.toLocaleString()} / ${imagesLimit.toLocaleString()}</div>
                    </div>
                </div>
                <div class="plan-detail-item">
                    <div class="plan-detail-icon" style="background: rgba(16, 185, 129, 0.1); color: var(--success);">
                        <i class="ri-article-line"></i>
                    </div>
                    <div class="plan-detail-content">
                        <div class="plan-detail-label">Articles</div>
                        <div class="plan-detail-value">${articlesUsed.toLocaleString()} / ${articlesLimit.toLocaleString()}</div>
                    </div>
                </div>
                <div class="plan-detail-item">
                    <div class="plan-detail-icon" style="background: rgba(245, 158, 11, 0.1); color: #f59e0b;">
                        <i class="ri-calendar-line"></i>
                    </div>
                    <div class="plan-detail-content">
                        <div class="plan-detail-label">Status</div>
                        <div class="plan-detail-value">${daysLeft > 0 ? 'Active' : 'Expired'}</div>
                    </div>
                </div>
                <div class="plan-detail-item">
                    <div class="plan-detail-icon" style="background: rgba(139, 92, 246, 0.1); color: #8b5cf6;">
                        <i class="ri-shield-check-line"></i>
                    </div>
                    <div class="plan-detail-content">
                        <div class="plan-detail-label">Type</div>
                        <div class="plan-detail-value">${isSubscribed ? 'Subscription' : 'One-time'}</div>
                    </div>
                </div>
            </div>
        </div>
        `}
        
        <!-- Usage Section -->
        ${!isFree ? `
        <div class="usage-section">
            <h3 class="usage-section-title"><i class="ri-pie-chart-line"></i> Usage Overview</h3>
            <div class="usage-grid">
                <div class="usage-card">
                    <div class="usage-card-header">
                        <div class="usage-card-icon" style="background: rgba(99, 102, 241, 0.1); color: var(--primary);">
                            <i class="ri-image-line"></i>
                        </div>
                        <div>
                            <div class="usage-card-title">Image Uploads</div>
                            <div class="usage-card-subtitle">Monthly usage</div>
                        </div>
                    </div>
                    <div class="usage-progress-container">
                        <div class="usage-progress-bar">
                            <div class="usage-progress-fill" style="width: ${imagesUsedPercent}%; background: ${imagesUsedPercent > 90 ? 'var(--error)' : imagesUsedPercent > 70 ? 'var(--warning)' : 'var(--primary)'};"></div>
                        </div>
                    </div>
                    <div class="usage-stats">
                        <span class="usage-stat-used">${imagesUsed.toLocaleString()} used</span>
                        <span class="usage-stat-limit">of ${imagesLimit.toLocaleString()}</span>
                    </div>
                </div>
                <div class="usage-card">
                    <div class="usage-card-header">
                        <div class="usage-card-icon" style="background: rgba(16, 185, 129, 0.1); color: var(--success);">
                            <i class="ri-article-line"></i>
                        </div>
                        <div>
                            <div class="usage-card-title">Article Uploads</div>
                            <div class="usage-card-subtitle">Monthly usage</div>
                        </div>
                    </div>
                    <div class="usage-progress-container">
                        <div class="usage-progress-bar">
                            <div class="usage-progress-fill" style="width: ${articlesUsedPercent}%; background: ${articlesUsedPercent > 90 ? 'var(--error)' : articlesUsedPercent > 70 ? 'var(--warning)' : 'var(--success)'};"></div>
                        </div>
                    </div>
                    <div class="usage-stats">
                        <span class="usage-stat-used">${articlesUsed.toLocaleString()} used</span>
                        <span class="usage-stat-limit">of ${articlesLimit.toLocaleString()}</span>
                    </div>
                </div>
            </div>
        </div>
        ` : ''}
        
        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-card-icon" style="background: rgba(99, 102, 241, 0.1); color: var(--primary);">
                    <i class="ri-money-dollar-circle-line"></i>
                </div>
                <div class="stat-card-content">
                    <div class="stat-card-value">$${totalSpent.toFixed(2)}</div>
                    <div class="stat-card-label">Total Spent</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-card-icon" style="background: rgba(16, 185, 129, 0.1); color: var(--success);">
                    <i class="ri-checkbox-circle-line"></i>
                </div>
                <div class="stat-card-content">
                    <div class="stat-card-value">${completedPayments}</div>
                    <div class="stat-card-label">Completed</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-card-icon" style="background: rgba(245, 158, 11, 0.1); color: #f59e0b;">
                    <i class="ri-time-line"></i>
                </div>
                <div class="stat-card-content">
                    <div class="stat-card-value">${pendingPayments}</div>
                    <div class="stat-card-label">Pending</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-card-icon" style="background: rgba(139, 92, 246, 0.1); color: #8b5cf6;">
                    <i class="ri-file-list-3-line"></i>
                </div>
                <div class="stat-card-content">
                    <div class="stat-card-value">${allPayments.length}</div>
                    <div class="stat-card-label">Total Transactions</div>
                </div>
            </div>
        </div>
        
        <!-- Available Plans Section -->
        <div class="upgrade-section">
            <div class="upgrade-header">
                <div>
                    <h3 class="upgrade-title"><i class="ri-rocket-line"></i> Available Plans</h3>
                    <p class="upgrade-subtitle">Choose the plan that fits your needs</p>
                </div>
                <button class="btn btn-primary" onclick="openPackagePurchaseModal()">
                    <i class="ri-shopping-bag-3-line"></i> Purchase
                </button>
            </div>
            <div class="upgrade-plans-grid">
                ${Object.entries(hostingPackages).map(([key, pkg]) => `
                    <div class="upgrade-plan-card ${pkg.popular ? 'popular' : ''} ${planName === key ? 'current' : ''}">
                        <div class="upgrade-plan-icon" style="background: ${pkg.gradient}; color: white;">
                            <i class="${pkg.icon}"></i>
                        </div>
                        <div class="upgrade-plan-name">${pkg.name}</div>
                        <div class="upgrade-plan-price">From <strong>$${pkg.price['3month']}</strong> /3 months</div>
                        <ul class="upgrade-plan-features">
                            ${pkg.features.map(f => `<li><i class="ri-check-line"></i> ${f}</li>`).join('')}
                        </ul>
                        <button class="btn ${planName === key ? 'btn-secondary' : 'btn-primary'} btn-sm" style="width: 100%;" 
                                onclick="${planName === key ? 'showSubscriptionModal()' : 'openPackagePurchaseModal()'}">
                            ${planName === key ? 'Manage' : 'Select'}
                        </button>
                    </div>
                `).join('')}
            </div>
        </div>
        
        <!-- Transaction History -->
        <div class="transactions-section">
            <div class="transactions-header">
                <h3 class="transactions-title"><i class="ri-exchange-funds-line"></i> Transaction History</h3>
                <div class="transactions-filter">
                    <select onchange="loadBilling(1, this.value)">
                        <option value="all" ${type === 'all' ? 'selected' : ''}>All Transactions</option>
                        <option value="hosting" ${type === 'hosting' ? 'selected' : ''}>Hosting Only</option>
                        <option value="tasks" ${type === 'tasks' ? 'selected' : ''}>Tasks Only</option>
                    </select>
                </div>
            </div>
            
            <!-- Desktop Table -->
            <table class="transactions-table">
                <thead>
                    <tr>
                        <th>Type</th>
                        <th>Date</th>
                        <th>Amount</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    ${allPayments.length > 0 ? allPayments.map(payment => {
                        let paymentType = '', description = '', badgeClass = '', icon = '', iconBg = '';
                        if (payment.method === 'create_task') {
                            paymentType = 'SEO Task'; badgeClass = 'primary'; 
                            description = payment.details?.url || 'Task Creation';
                            icon = 'ri-rocket-line'; iconBg = 'rgba(99, 102, 241, 0.1)';
                        } else if (payment.method === 'recharge') {
                            paymentType = 'Recharge'; badgeClass = 'success'; 
                            description = 'Task Recharge';
                            icon = 'ri-battery-charge-line'; iconBg = 'rgba(16, 185, 129, 0.1)';
                        } else if (payment.method === 'buy_package') {
                            paymentType = 'Hosting'; badgeClass = 'warning'; 
                            description = (payment.details?.package || 'Hosting') + ' Package';
                            icon = 'ri-cloud-line'; iconBg = 'rgba(245, 158, 11, 0.1)';
                        } else {
                            paymentType = payment.method || 'Payment'; badgeClass = 'primary'; 
                            description = 'Payment';
                            icon = 'ri-bank-card-line'; iconBg = 'rgba(99, 102, 241, 0.1)';
                        }
                        let statusClass = 'warning'; let statusText = payment.status || 'Unknown';
                        switch (payment.status?.toLowerCase()) {
                            case 'paid': statusClass = 'success'; statusText = 'Paid'; break;
                            case 'pending': statusClass = 'warning'; statusText = 'Pending'; break;
                            case 'cancelled': statusClass = 'danger'; statusText = 'Cancelled'; break;
                            case 'expired': statusClass = 'danger'; statusText = 'Expired'; break;
                        }
                        return `
                            <tr>
                                <td>
                                    <div class="transaction-type-cell">
                                        <div class="transaction-type-icon" style="background: ${iconBg}; color: var(--${badgeClass});">
                                            <i class="${icon}"></i>
                                        </div>
                                        <div class="transaction-type-info">
                                            <span class="transaction-type-name">${paymentType}</span>
                                            <span class="transaction-type-desc">${description.length > 30 ? description.substring(0, 30) + '...' : description}</span>
                                        </div>
                                    </div>
                                </td>
                                <td>${new Date(payment.dates?.created || Date.now()).toLocaleDateString()}</td>
                                <td style="font-weight: 600;">$${(payment.total_payment || 0).toFixed(2)}</td>
                                <td><span class="badge badge-${statusClass}">${statusText}</span></td>
                                <td>
                                    ${payment.status?.toLowerCase() === 'paid' ? `<button class="btn btn-sm" onclick="viewPaymentDetails('${payment.billing_id}')"><i class="ri-eye-line"></i></button>` : ''}
                                    ${payment.status?.toLowerCase() === 'pending' && payment.payment_url ? `<button class="btn btn-sm btn-primary" onclick="window.open('${payment.payment_url}', '_blank')"><i class="ri-external-link-line"></i> Pay</button>` : ''}
                                </td>
                            </tr>
                        `;
                    }).join('') : `
                        <tr>
                            <td colspan="5" style="text-align: center; padding: 3rem;">
                                <div style="color: var(--text-secondary);">
                                    <i class="ri-file-list-3-line" style="font-size: 2.5rem; opacity: 0.4; margin-bottom: 0.5rem; display: block;"></i>
                                    <p style="font-weight: 600; margin: 0;">No transactions yet</p>
                                    <p style="font-size: 0.85rem; margin: 0.25rem 0 0 0;">Your payment history will appear here</p>
                                </div>
                            </td>
                        </tr>
                    `}
                </tbody>
            </table>
            
            <!-- Mobile Cards -->
            <div class="mobile-transactions">
                ${allPayments.length > 0 ? allPayments.map(payment => {
                    let paymentType = '', description = '', badgeClass = '', icon = '', iconBg = '';
                    if (payment.method === 'create_task') {
                        paymentType = 'SEO Task'; badgeClass = 'primary'; 
                        description = payment.details?.url || 'Task Creation';
                        icon = 'ri-rocket-line'; iconBg = 'rgba(99, 102, 241, 0.1)';
                    } else if (payment.method === 'recharge') {
                        paymentType = 'Recharge'; badgeClass = 'success'; 
                        description = 'Task Recharge';
                        icon = 'ri-battery-charge-line'; iconBg = 'rgba(16, 185, 129, 0.1)';
                    } else if (payment.method === 'buy_package') {
                        paymentType = 'Hosting'; badgeClass = 'warning'; 
                        description = (payment.details?.package || 'Hosting') + ' Package';
                        icon = 'ri-cloud-line'; iconBg = 'rgba(245, 158, 11, 0.1)';
                    } else {
                        paymentType = payment.method || 'Payment'; badgeClass = 'primary'; 
                        description = 'Payment';
                        icon = 'ri-bank-card-line'; iconBg = 'rgba(99, 102, 241, 0.1)';
                    }
                    let statusClass = 'warning'; let statusText = payment.status || 'Unknown';
                    switch (payment.status?.toLowerCase()) {
                        case 'paid': statusClass = 'success'; statusText = 'Paid'; break;
                        case 'pending': statusClass = 'warning'; statusText = 'Pending'; break;
                        case 'cancelled': statusClass = 'danger'; statusText = 'Cancelled'; break;
                        case 'expired': statusClass = 'danger'; statusText = 'Expired'; break;
                    }
                    return `
                        <div class="mobile-transaction-card">
                            <div class="mobile-transaction-header">
                                <div class="mobile-transaction-type">
                                    <div class="transaction-type-icon" style="background: ${iconBg}; color: var(--${badgeClass});">
                                        <i class="${icon}"></i>
                                    </div>
                                    <div>
                                        <div style="font-weight: 600;">${paymentType}</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">${description.length > 25 ? description.substring(0, 25) + '...' : description}</div>
                                    </div>
                                </div>
                                <span class="badge badge-${statusClass}">${statusText}</span>
                            </div>
                            <div class="mobile-transaction-body">
                                <div class="mobile-transaction-item">
                                    <label>Date</label>
                                    <div>${new Date(payment.dates?.created || Date.now()).toLocaleDateString()}</div>
                                </div>
                                <div class="mobile-transaction-item">
                                    <label>Amount</label>
                                    <div style="font-weight: 600;">$${(payment.total_payment || 0).toFixed(2)}</div>
                                </div>
                            </div>
                            ${payment.status?.toLowerCase() === 'paid' || (payment.status?.toLowerCase() === 'pending' && payment.payment_url) ? `
                                <div class="mobile-transaction-actions">
                                    ${payment.status?.toLowerCase() === 'paid' ? `<button class="btn btn-sm" style="flex: 1;" onclick="viewPaymentDetails('${payment.billing_id}')"><i class="ri-eye-line"></i> Details</button>` : ''}
                                    ${payment.status?.toLowerCase() === 'pending' && payment.payment_url ? `<button class="btn btn-sm btn-primary" style="flex: 1;" onclick="window.open('${payment.payment_url}', '_blank')"><i class="ri-external-link-line"></i> Pay Now</button>` : ''}
                                </div>
                            ` : ''}
                        </div>
                    `;
                }).join('') : `
                    <div style="text-align: center; padding: 3rem; color: var(--text-secondary);">
                        <i class="ri-file-list-3-line" style="font-size: 2.5rem; opacity: 0.4; margin-bottom: 0.5rem; display: block;"></i>
                        <p style="font-weight: 600; margin: 0;">No transactions yet</p>
                        <p style="font-size: 0.85rem; margin: 0.25rem 0 0 0;">Your payment history will appear here</p>
                    </div>
                `}
            </div>
        </div>
        
        ${paginationState.billing.total > paginationState.billing.pageSize ? generatePagination('billing', (page) => loadBilling(page, type)) : ''}
        `;
        
        // Initialize purchase modal UI
        updatePackagePurchaseUI();
        
    } catch (error) {
        console.error('Billing error:', error);
        showErrorState('Failed to load billing data. Please check your connection and try again.');
    }
}

// Old unused content removed

